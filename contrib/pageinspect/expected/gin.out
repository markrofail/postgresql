CREATE TABLE test1 (x int, y int[]);
INSERT INTO test1 VALUES (1, ARRAY[11, 111]);
CREATE INDEX test1_y_idx ON test1 USING gin (y) WITH (fastupdate = off);
\x
SELECT * FROM gin_metapage_info(get_raw_page('test1_y_idx', 0));
-[ RECORD 1 ]----+-----------
pending_head     | 4294967295
pending_tail     | 4294967295
tail_free_size   | 0
n_pending_pages  | 0
n_pending_tuples | 0
n_total_pages    | 2
n_entry_pages    | 1
n_data_pages     | 0
n_entries        | 2
version          | 2

SELECT * FROM gin_metapage_info(get_raw_page('test1_y_idx', 1));
ERROR:  input page is not a GIN metapage
DETAIL:  Flags 0002, expected 0008
SELECT * FROM gin_page_opaque_info(get_raw_page('test1_y_idx', 1));
-[ RECORD 1 ]---------
rightlink | 4294967295
maxoff    | 0
flags     | {leaf}

SELECT * FROM gin_leafpage_items(get_raw_page('test1_y_idx', 1));
ERROR:  input page is not a compressed GIN data leaf page
DETAIL:  Flags 0002, expected 0083
INSERT INTO test1 SELECT x, ARRAY[1,10] FROM generate_series(2,10000) x;
SELECT COUNT(*) > 0
FROM gin_leafpage_items(get_raw_page('test1_y_idx',
                        (pg_relation_size('test1_y_idx') /
                         current_setting('block_size')::bigint)::int - 1));
-[ RECORD 1 ]
?column? | t

\x
CREATE TABLE test__int(a int[]);
\copy test__int from 'data/test__int.data'
CREATE INDEX gin_idx ON test__int USING gin ( a );
INSERT INTO test__int ( SELECT ARRAY[t] || '{1000}'::_int4 FROM generate_series (1,300) as t );
INSERT INTO test__int ( SELECT ARRAY[t] || '{1001}'::_int4 FROM generate_series (1,300) as t, generate_series(1,12) );
VACUUM ANALYZE test__int;
SELECT * FROM gin_value_count('gin_idx') as t(value int, nrow int);
 value | nrow 
-------+------
     0 |   38
     1 |  257
     2 |  244
     3 |  222
     4 |  228
     5 |  227
     6 |  243
     7 |  238
     8 |  236
     9 |  224
    10 |  236
    11 |  248
    12 |  224
    13 |  235
    14 |  237
    15 |  253
    16 |  234
    17 |  245
    18 |  246
    19 |  234
    20 |  236
    21 |  213
    22 |  235
    23 |  222
    24 |  197
    25 |  253
    26 |  218
    27 |  239
    28 |  198
    29 |  244
    30 |  247
    31 |  267
    32 |  234
    33 |  209
    34 |  231
    35 |  218
    36 |  242
    37 |  232
    38 |  221
    39 |  232
    40 |  241
    41 |  239
    42 |  221
    43 |  211
    44 |  231
    45 |  213
    46 |  236
    47 |  264
    48 |  221
    49 |  235
    50 |  219
    51 |  250
    52 |  270
    53 |  222
    54 |  242
    55 |  237
    56 |  237
    57 |  251
    58 |  231
    59 |  272
    60 |  219
    61 |  233
    62 |  235
    63 |  260
    64 |  252
    65 |  221
    66 |  228
    67 |  253
    68 |  196
    69 |  232
    70 |  232
    71 |  223
    72 |  247
    73 |  214
    74 |  232
    75 |  229
    76 |  233
    77 |  221
    78 |  227
    79 |  233
    80 |  216
    81 |  244
    82 |  223
    83 |  254
    84 |  227
    85 |  247
    86 |  255
    87 |  239
    88 |  258
    89 |  249
    90 |  244
    91 |  226
    92 |  225
    93 |  230
    94 |  218
    95 |  232
    96 |  239
    97 |  226
    98 |  209
    99 |  211
   100 |  216
   101 |   49
   102 |   47
   103 |   59
   104 |   55
   105 |   48
   106 |   49
   107 |   49
   108 |   51
   109 |   47
   110 |   51
   111 |   45
   112 |   46
   113 |   48
   114 |   38
   115 |   39
   116 |   43
   117 |   44
   118 |   46
   119 |   45
   120 |   52
   121 |   41
   122 |   64
   123 |   50
   124 |   41
   125 |   55
   126 |   41
   127 |   50
   128 |   54
   129 |   43
   130 |   44
   131 |   50
   132 |   57
   133 |   40
   134 |   41
   135 |   44
   136 |   58
   137 |   48
   138 |   44
   139 |   50
   140 |   49
   141 |   48
   142 |   43
   143 |   36
   144 |   43
   145 |   49
   146 |   46
   147 |   40
   148 |   52
   149 |   46
   150 |   49
   151 |   42
   152 |   58
   153 |   49
   154 |   51
   155 |   49
   156 |   45
   157 |   53
   158 |   59
   159 |   38
   160 |   53
   161 |   48
   162 |   41
   163 |   40
   164 |   52
   165 |   50
   166 |   40
   167 |   48
   168 |   45
   169 |   49
   170 |   50
   171 |   45
   172 |   46
   173 |   47
   174 |   41
   175 |   51
   176 |   50
   177 |   41
   178 |   42
   179 |   48
   180 |   47
   181 |   49
   182 |   40
   183 |   46
   184 |   52
   185 |   36
   186 |   45
   187 |   41
   188 |   47
   189 |   49
   190 |   46
   191 |   45
   192 |   39
   193 |   50
   194 |   39
   195 |   54
   196 |   43
   197 |   50
   198 |   46
   199 |   42
   200 |   31
   201 |   28
   202 |   28
   203 |   28
   204 |   30
   205 |   22
   206 |   25
   207 |   27
   208 |   32
   209 |   22
   210 |   21
   211 |   31
   212 |   22
   213 |   37
   214 |   19
   215 |   25
   216 |   27
   217 |   26
   218 |   24
   219 |   25
   220 |   26
   221 |   21
   222 |   23
   223 |   20
   224 |   26
   225 |   25
   226 |   25
   227 |   23
   228 |   30
   229 |   30
   230 |   24
   231 |   22
   232 |   27
   233 |   27
   234 |   21
   235 |   27
   236 |   24
   237 |   24
   238 |   29
   239 |   32
   240 |   31
   241 |   24
   242 |   36
   243 |   21
   244 |   29
   245 |   22
   246 |   23
   247 |   21
   248 |   26
   249 |   29
   250 |   24
   251 |   29
   252 |   25
   253 |   28
   254 |   25
   255 |   19
   256 |   23
   257 |   20
   258 |   24
   259 |   31
   260 |   29
   261 |   20
   262 |   25
   263 |   23
   264 |   25
   265 |   23
   266 |   31
   267 |   22
   268 |   26
   269 |   33
   270 |   25
   271 |   27
   272 |   29
   273 |   29
   274 |   26
   275 |   28
   276 |   30
   277 |   28
   278 |   29
   279 |   22
   280 |   29
   281 |   23
   282 |   30
   283 |   29
   284 |   23
   285 |   37
   286 |   27
   287 |   31
   288 |   28
   289 |   26
   290 |   25
   291 |   29
   292 |   22
   293 |   26
   294 |   29
   295 |   24
   296 |   27
   297 |   30
   298 |   29
   299 |   26
   300 |   13
  1000 |  300
  1001 | 3600
       |    9
       |  244
(305 rows)

