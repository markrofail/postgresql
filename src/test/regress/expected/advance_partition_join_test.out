--
-- Test advance partition-wise join between partitioned tables
--
SET enable_partitionwise_join to true;
--SET client_min_messages to debug3;
--cleanup of existing partition tables
DROP TABLE prt1;
DROP TABLE prt2;
DROP TABLE prt1_m;
DROP TABLE prt2_m;
DROP TABLE prt1_e;
DROP TABLE plt1;
DROP TABLE plt2;
DROP TABLE plt1_e;
--=============================================================================================================================
--
-- partitioned by a single column
--
--=============================================================================================================================
-- prt1 and prt2 both have default partition with excat bound matches.
-- pwj is possible for all cases.
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (MAXVALUE);
CREATE TABLE prt1_p4 PARTITION OF prt1 DEFAULT;
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 2 = 0;
INSERT INTO prt1 SELECT NULL, i % 25, to_char(i, 'FM0000') FROM generate_series(599, 699) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (MAXVALUE);
CREATE TABLE prt2_p4 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 3 = 0;
INSERT INTO prt2 SELECT i % 25, NULL, to_char(i, 'FM0000') FROM generate_series(599, 699) i WHERE i % 3 = 0;
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p0 t2
               ->  Hash
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_1.b = t1_1.a)
               ->  Seq Scan on prt2_p1 t2_1
               ->  Hash
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_2.b = t1_2.a)
               ->  Seq Scan on prt2_p2 t2_2
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_3.b = t1_3.a)
               ->  Seq Scan on prt2_p3 t2_3
               ->  Hash
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_4.b = t1_4.a)
               ->  Seq Scan on prt2_p4 t2_4
               ->  Hash
                     ->  Seq Scan on prt1_p4 t1_4
                           Filter: (b = 0)
(33 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t1.b, t1.c, t2.a, t2.b, t2.c;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.a, t2.b, t2.c
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Seq Scan on prt2_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_p0 t1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_1.b = t1_1.a)
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_p1 t1_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_2.b = t1_2.a)
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_p2 t1_2
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_3.b = t1_3.a)
                     ->  Seq Scan on prt2_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_p3 t1_3
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_4.b = t1_4.a)
                     ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Seq Scan on prt1_p4 t1_4
                                 Filter: (b = 0)
(34 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t1.b, t1.c, t2.a, t2.b, t2.c;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (200,0,0200)   | 
 (250,0,0250)   | 
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
 (500,0,0500)   | 
 (550,0,0550)   | 
 (,0,0600)      | 
 (,0,0650)      | 
(19 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY 1,2,3,4;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t1.a = t2.b)
                     ->  Seq Scan on prt1_p0 t1
                     ->  Hash
                           ->  Seq Scan on prt2_p0 t2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t1_1
                     ->  Hash
                           ->  Seq Scan on prt2_p1 t2_1
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t1_2
                     ->  Hash
                           ->  Seq Scan on prt2_p2 t2_2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t1_3
                     ->  Hash
                           ->  Seq Scan on prt2_p3 t2_3
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t1_4
                     ->  Hash
                           ->  Seq Scan on prt2_p4 t2_4
                                 Filter: (a = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY 1,2,3,4;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  375 | 0375
      |       |  525 | 0525
      |       |      | 0600
      |       |      | 0675
(13 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Append
         ->  Hash Full Join
               Hash Cond: (prt1_p0.a = prt2_p0.b)
               Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
               ->  Seq Scan on prt1_p0
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p0
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p1.a = prt2_p1.b)
               Filter: (((50) = prt1_p1.a) OR ((75) = prt2_p1.b))
               ->  Seq Scan on prt1_p1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p1
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p2.a = prt2_p2.b)
               Filter: (((50) = prt1_p2.a) OR ((75) = prt2_p2.b))
               ->  Seq Scan on prt1_p2
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p2
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p3.a = prt2_p3.b)
               Filter: (((50) = prt1_p3.a) OR ((75) = prt2_p3.b))
               ->  Seq Scan on prt1_p3
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p3
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p4.a = prt2_p4.b)
               Filter: (((50) = prt1_p4.a) OR ((75) = prt2_p4.b))
               ->  Seq Scan on prt1_p4
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p4
                           Filter: (a = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  |  c   | b  |  c   
----+------+----+------
 50 | 0050 |    | 
    |      | 75 | 0075
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p2 t2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1
                           Filter: ((a < 450) AND (b = 0))
         ->  Nested Loop
               Join Filter: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p4 t1_1
                     Filter: ((a < 450) AND (b = 0))
               ->  Seq Scan on prt2_p4 t2_1
                     Filter: (b > 250)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
  a  |  c   |  b  |  c   
-----+------+-----+------
 300 | 0300 | 300 | 0300
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
         ->  Nested Loop Left Join
               Join Filter: (prt1_p4.a = prt2_p4.b)
               ->  Seq Scan on prt1_p4
                     Filter: ((a < 450) AND (b = 0))
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
(30 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b  |  c   
------+-------+-----+------
 -250 | -0250 |     | 
 -200 | -0200 |     | 
 -150 | -0150 |     | 
 -100 | -0100 |     | 
  -50 | -0050 |     | 
    0 | 0000  |     | 
   50 | 0050  |     | 
  100 | 0100  |     | 
  150 | 0150  |     | 
  200 | 0200  |     | 
  250 | 0250  |     | 
  300 | 0300  | 300 | 0300
  350 | 0350  |     | 
  400 | 0400  |     | 
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
         ->  Nested Loop Semi Join
               Join Filter: (t1_3.a = t2_3.b)
               ->  Seq Scan on prt1_p3 t1_3
                     Filter: (b = 0)
               ->  Materialize
                     ->  Seq Scan on prt2_p3 t2_3
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_4.a = t2_4.b)
               ->  Seq Scan on prt1_p4 t1_4
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p4 t2_4
                           Filter: (a = 0)
(38 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.b = t2.a)
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.b = t2_1.a)
               ->  Seq Scan on prt2_p1 t1_1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p1 t2_1
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.b = t2_2.a)
               ->  Seq Scan on prt2_p2 t1_2
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t2_2
                           Filter: (b = 0)
         ->  Nested Loop Semi Join
               Join Filter: (t1_3.b = t2_3.a)
               ->  Seq Scan on prt2_p3 t1_3
                     Filter: (a = 0)
               ->  Seq Scan on prt1_p3 t2_3
                     Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_4.b = t2_4.a)
               ->  Seq Scan on prt2_p4 t1_4
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p4 t2_4
                           Filter: (b = 0)
(37 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a |  b   |   c   
---+------+-------
 0 | -150 | -0150
 0 |    0 | 0000
 0 |  150 | 0150
 0 |  300 | 0300
 0 |  450 | 0450
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Append
         ->  Hash Anti Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
         ->  Hash Anti Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
         ->  Hash Anti Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
         ->  Hash Anti Join
               Hash Cond: (t1_3.a = t2_3.b)
               ->  Seq Scan on prt1_p3 t1_3
               ->  Hash
                     ->  Seq Scan on prt2_p3 t2_3
         ->  Hash Anti Join
               Hash Cond: (t1_4.a = t2_4.b)
               ->  Seq Scan on prt1_p4 t1_4
               ->  Hash
                     ->  Seq Scan on prt2_p4 t2_4
(27 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum  |         avg          | sum  |        avg         
-------+----------------------+------+--------------------
 49416 | 174.0000000000000000 | 2016 | 6.0359281437125749
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3.b = t2.a)
                           ->  Seq Scan on prt2_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t2
                                       Filter: (t1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.b = t2_1.a)
                           ->  Seq Scan on prt2_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t2_1
                                       Filter: (t1_1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.b = t2_2.a)
                           ->  Seq Scan on prt2_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t2_2
                                       Filter: (t1_2.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_3.b = t2_3.a)
                           ->  Seq Scan on prt2_p3 t3_3
                           ->  Hash
                                 ->  Seq Scan on prt1_p3 t2_3
                                       Filter: (t1_3.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p4 t1_4
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_4.b = t2_4.a)
                           ->  Seq Scan on prt2_p4 t3_4
                           ->  Hash
                                 ->  Seq Scan on prt1_p4 t2_4
                                       Filter: (t1_4.a = a)
(49 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a  | t3a | least 
------+---+-------+------+-----+-------
 -250 | 0 | -0250 |      |     |      
 -200 | 0 | -0200 |      |     |      
 -150 | 0 | -0150 | -150 |   0 |  -150
 -100 | 0 | -0100 |      |     |      
  -50 | 0 | -0050 |      |     |      
    0 | 0 | 0000  |    0 |   0 |     0
   50 | 0 | 0050  |      |     |      
  100 | 0 | 0100  |      |     |      
  150 | 0 | 0150  |  150 |   0 |   150
  200 | 0 | 0200  |      |     |      
  250 | 0 | 0250  |      |     |      
  300 | 0 | 0300  |  300 |   0 |   300
  350 | 0 | 0350  |      |     |      
  400 | 0 | 0400  |      |     |      
  450 | 0 | 0450  |  450 |   0 |   450
  500 | 0 | 0500  |      |     |      
  550 | 0 | 0550  |      |     |      
      | 0 | 0600  |      |     |      
      | 0 | 0650  |      |     |      
(19 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
         ->  Nested Loop Left Join
               Join Filter: (prt1_p4.a = prt2_p4.b)
               ->  Seq Scan on prt1_p4
                     Filter: ((a < 450) AND (b = 0))
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
(30 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t1_5.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_5.b = t1_10.a)
                           ->  Seq Scan on prt2_p0 t1_5
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1_10
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t1_6.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_6.b = t1_11.a)
                           ->  Seq Scan on prt2_p1 t1_6
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_11
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t1_7.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_7.b = t1_12.a)
                           ->  Seq Scan on prt2_p2 t1_7
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_12
                                       Filter: (b = 0)
         ->  Merge Semi Join
               Merge Cond: (t1_3.a = t1_8.b)
               ->  Sort
                     Sort Key: t1_3.a
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
               ->  Sort
                     Sort Key: t1_8.b
                     ->  Hash Semi Join
                           Hash Cond: (t1_8.b = t1_13.a)
                           ->  Seq Scan on prt2_p3 t1_8
                           ->  Hash
                                 ->  Seq Scan on prt1_p3 t1_13
                                       Filter: (b = 0)
         ->  Nested Loop Semi Join
               Join Filter: (t1_4.a = t1_9.b)
               ->  Seq Scan on prt1_p4 t1_4
                     Filter: (b = 0)
               ->  Materialize
                     ->  Hash Semi Join
                           Hash Cond: (t1_9.b = t1_14.a)
                           ->  Seq Scan on prt2_p4 t1_9
                           ->  Hash
                                 ->  Seq Scan on prt1_p4 t1_14
                                       Filter: (b = 0)
(61 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
      | 0600  |      |       |      | 0600
      | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
      | 0600  |      |       |      | 0600
      | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
      | 0600  |      |       |      | 0600
      | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_4.b = t1_4.a)
                                 ->  Seq Scan on prt2_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_p4 t1_4
                                             Filter: (b = 0)
(54 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
      | 0600  |      |       |      | 0600
      | 0650  |      |       |      | 0650
(19 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t5_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_4.a = t1_4.a)
                                 ->  Seq Scan on prt1_p4 t3_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_4.b = t1_4.a)
                                             ->  Seq Scan on prt2_p4 t4_4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_4.b = t1_4.a)
                                                         ->  Seq Scan on prt2_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p4 t1_4
                                                                     Filter: (b = 0)
(94 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t5_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_4.a = t1_4.a)
                                 ->  Seq Scan on prt1_p4 t3_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_4.b = t1_4.a)
                                             ->  Seq Scan on prt2_p4 t4_4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_4.b = t1_4.a)
                                                         ->  Seq Scan on prt2_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p4 t1_4
                                                                     Filter: (b = 0)
(94 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t5_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_4.a = t1_4.a)
                                 ->  Seq Scan on prt1_p4 t3_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_4.b = t1_4.a)
                                             ->  Seq Scan on prt2_p4 t4_4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_4.b = t1_4.a)
                                                         ->  Seq Scan on prt2_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p4 t1_4
                                                                     Filter: (b = 0)
(94 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t5.a = t4.b)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_1.a = t4_1.b)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_2.a = t4_2.b)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_3.a = t4_3.b)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_4.a = t4_4.b)
                     ->  Seq Scan on prt1_p4 t5_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_4.a = t1_4.a)
                                 ->  Seq Scan on prt1_p4 t3_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_4.b = t1_4.a)
                                             ->  Seq Scan on prt2_p4 t4_4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_4.b = t1_4.a)
                                                         ->  Seq Scan on prt2_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p4 t1_4
                                                                     Filter: (b = 0)
(94 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_4.a = t1_4.a)
                     ->  Seq Scan on prt1_p4 t5_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_4.a = t1_4.a)
                                 ->  Seq Scan on prt1_p4 t3_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_4.b = t1_4.a)
                                             ->  Seq Scan on prt2_p4 t4_4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_4.b = t1_4.a)
                                                         ->  Seq Scan on prt2_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p4 t1_4
                                                                     Filter: (b = 0)
(94 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
-- prt2 have extra partition which is default partition
-- pwj is possible when default partition is outer side of relation.
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 499) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 3 = 0;
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p0 t2
               ->  Hash
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_1.b = t1_1.a)
               ->  Seq Scan on prt2_p1 t2_1
               ->  Hash
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_2.b = t1_2.a)
               ->  Seq Scan on prt2_p2 t2_2
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Seq Scan on prt2_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_p0 t1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_1.b = t1_1.a)
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_p1 t1_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_2.b = t1_2.a)
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_p2 t1_2
                                 Filter: (b = 0)
(22 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (200,0,0200)   | 
 (250,0,0250)   | 
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
(15 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p1 t1_1
               ->  Seq Scan on prt1_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p3 t2_3
                           Filter: (a = 0)
(18 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  375 | 0375
      |       |  525 | 0525
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Full Join
         Hash Cond: (prt1_p0.a = prt2_p0.b)
         Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
         ->  Append
               ->  Seq Scan on prt1_p0
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p3
                           Filter: (a = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  |  c   | b  |  c   
----+------+----+------
 50 | 0050 |    | 
    |      | 75 | 0075
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p2 t2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1
                           Filter: ((a < 450) AND (b = 0))
(10 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
  a  |  c   |  b  |  c   
-----+------+-----+------
 300 | 0300 | 300 | 0300
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b  |  c   
------+-------+-----+------
 -250 | -0250 |     | 
 -200 | -0200 |     | 
 -150 | -0150 |     | 
 -100 | -0100 |     | 
  -50 | -0050 |     | 
    0 | 0000  |     | 
   50 | 0050  |     | 
  100 | 0100  |     | 
  150 | 0150  |     | 
  200 | 0200  |     | 
  250 | 0250  |     | 
  300 | 0300  | 300 | 0300
  350 | 0350  |     | 
  400 | 0400  |     | 
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
(24 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.b = t2.a)
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.b = t2_1.a)
               ->  Seq Scan on prt2_p1 t1_1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p1 t2_1
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.b = t2_2.a)
               ->  Seq Scan on prt2_p2 t1_2
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t2_2
                           Filter: (b = 0)
(24 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a |  b   |   c   
---+------+-------
 0 | -150 | -0150
 0 |    0 | 0000
 0 |  150 | 0150
 0 |  300 | 0300
 0 |  450 | 0450
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Append
         ->  Hash Anti Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
         ->  Hash Anti Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
         ->  Hash Anti Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
(17 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum  |         avg          | sum  |        avg         
-------+----------------------+------+--------------------
 30750 | 123.0000000000000000 | 1000 | 4.0000000000000000
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3.b = t2.a)
                           ->  Seq Scan on prt2_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t2
                                       Filter: (t1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.b = t2_1.a)
                           ->  Seq Scan on prt2_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t2_1
                                       Filter: (t1_1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.b = t2_2.a)
                           ->  Seq Scan on prt2_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t2_2
                                       Filter: (t1_2.a = a)
(31 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a  | t3a | least 
------+---+-------+------+-----+-------
 -250 | 0 | -0250 |      |     |      
 -200 | 0 | -0200 |      |     |      
 -150 | 0 | -0150 | -150 |   0 |  -150
 -100 | 0 | -0100 |      |     |      
  -50 | 0 | -0050 |      |     |      
    0 | 0 | 0000  |    0 |   0 |     0
   50 | 0 | 0050  |      |     |      
  100 | 0 | 0100  |      |     |      
  150 | 0 | 0150  |  150 |   0 |   150
  200 | 0 | 0200  |      |     |      
  250 | 0 | 0250  |      |     |      
  300 | 0 | 0300  |  300 |   0 |   300
  350 | 0 | 0350  |      |     |      
  400 | 0 | 0400  |      |     |      
  450 | 0 | 0450  |  450 |   0 |   450
(15 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(24 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t1_3.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_3.b = t1_6.a)
                           ->  Seq Scan on prt2_p0 t1_3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1_6
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t1_4.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_4.b = t1_7.a)
                           ->  Seq Scan on prt2_p1 t1_4
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_7
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t1_5.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_5.b = t1_8.a)
                           ->  Seq Scan on prt2_p2 t1_5
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_8
                                       Filter: (b = 0)
(36 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t5.a = t4.b)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_1.a = t4_1.b)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_2.a = t4_2.b)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
-- prt2 default partition and prt1 have 500-600 extra range
-- pwj is possible when default partition is outer side of relation. - ??
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 3 = 0;
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p0 t2
               ->  Hash
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_1.b = t1_1.a)
               ->  Seq Scan on prt2_p1 t2_1
               ->  Hash
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_2.b = t1_2.a)
               ->  Seq Scan on prt2_p2 t2_2
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t2_3.b = t1_3.a)
               ->  Seq Scan on prt2_p3 t2_3
               ->  Hash
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Seq Scan on prt2_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_p0 t1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_1.b = t1_1.a)
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_p1 t1_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_2.b = t1_2.a)
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_p2 t1_2
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_3.b = t1_3.a)
                     ->  Seq Scan on prt2_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_p3 t1_3
                                 Filter: (b = 0)
(28 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (200,0,0200)   | 
 (250,0,0250)   | 
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
 (500,0,0500)   | 
 (550,0,0550)   | 
(17 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t1.a = t2.b)
                     ->  Seq Scan on prt1_p0 t1
                     ->  Hash
                           ->  Seq Scan on prt2_p0 t2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t1_1
                     ->  Hash
                           ->  Seq Scan on prt2_p1 t2_1
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t1_2
                     ->  Hash
                           ->  Seq Scan on prt2_p2 t2_2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t1_3
                     ->  Hash
                           ->  Seq Scan on prt2_p3 t2_3
                                 Filter: (a = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  375 | 0375
      |       |  525 | 0525
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Append
         ->  Hash Full Join
               Hash Cond: (prt1_p0.a = prt2_p0.b)
               Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
               ->  Seq Scan on prt1_p0
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p0
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p1.a = prt2_p1.b)
               Filter: (((50) = prt1_p1.a) OR ((75) = prt2_p1.b))
               ->  Seq Scan on prt1_p1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p1
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p2.a = prt2_p2.b)
               Filter: (((50) = prt1_p2.a) OR ((75) = prt2_p2.b))
               ->  Seq Scan on prt1_p2
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p2
                           Filter: (a = 0)
         ->  Hash Full Join
               Hash Cond: (prt1_p3.a = prt2_p3.b)
               Filter: (((50) = prt1_p3.a) OR ((75) = prt2_p3.b))
               ->  Seq Scan on prt1_p3
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p3
                           Filter: (a = 0)
(35 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  |  c   | b  |  c   
----+------+----+------
 50 | 0050 |    | 
    |      | 75 | 0075
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: (t2.b = t1.a)
               ->  Seq Scan on prt2_p2 t2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t1
                           Filter: ((a < 450) AND (b = 0))
(10 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
  a  |  c   |  b  |  c   
-----+------+-----+------
 300 | 0300 | 300 | 0300
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b  |  c   
------+-------+-----+------
 -250 | -0250 |     | 
 -200 | -0200 |     | 
 -150 | -0150 |     | 
 -100 | -0100 |     | 
  -50 | -0050 |     | 
    0 | 0000  |     | 
   50 | 0050  |     | 
  100 | 0100  |     | 
  150 | 0150  |     | 
  200 | 0200  |     | 
  250 | 0250  |     | 
  300 | 0300  | 300 | 0300
  350 | 0350  |     | 
  400 | 0400  |     | 
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
         ->  Nested Loop Semi Join
               Join Filter: (t1_3.a = t2_3.b)
               ->  Seq Scan on prt1_p3 t1_3
                     Filter: (b = 0)
               ->  Materialize
                     ->  Seq Scan on prt2_p3 t2_3
                           Filter: (a = 0)
(31 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.b = t2.a)
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.b = t2_1.a)
               ->  Seq Scan on prt2_p1 t1_1
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p1 t2_1
                           Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.b = t2_2.a)
               ->  Seq Scan on prt2_p2 t1_2
                     Filter: (a = 0)
               ->  Hash
                     ->  Seq Scan on prt1_p2 t2_2
                           Filter: (b = 0)
         ->  Nested Loop Semi Join
               Join Filter: (t1_3.b = t2_3.a)
               ->  Seq Scan on prt2_p3 t1_3
                     Filter: (a = 0)
               ->  Seq Scan on prt1_p3 t2_3
                     Filter: (b = 0)
(30 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a |  b   |   c   
---+------+-------
 0 | -150 | -0150
 0 |    0 | 0000
 0 |  150 | 0150
 0 |  300 | 0300
 0 |  450 | 0450
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Append
         ->  Hash Anti Join
               Hash Cond: (t1.a = t2.b)
               ->  Seq Scan on prt1_p0 t1
               ->  Hash
                     ->  Seq Scan on prt2_p0 t2
         ->  Hash Anti Join
               Hash Cond: (t1_1.a = t2_1.b)
               ->  Seq Scan on prt1_p1 t1_1
               ->  Hash
                     ->  Seq Scan on prt2_p1 t2_1
         ->  Hash Anti Join
               Hash Cond: (t1_2.a = t2_2.b)
               ->  Seq Scan on prt1_p2 t1_2
               ->  Hash
                     ->  Seq Scan on prt2_p2 t2_2
         ->  Hash Anti Join
               Hash Cond: (t1_3.a = t2_3.b)
               ->  Seq Scan on prt1_p3 t1_3
               ->  Hash
                     ->  Seq Scan on prt2_p3 t2_3
(22 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum  |         avg          | sum  |        avg         
-------+----------------------+------+--------------------
 49416 | 174.0000000000000000 | 1416 | 4.9859154929577465
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3.b = t2.a)
                           ->  Seq Scan on prt2_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t2
                                       Filter: (t1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.b = t2_1.a)
                           ->  Seq Scan on prt2_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t2_1
                                       Filter: (t1_1.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.b = t2_2.a)
                           ->  Seq Scan on prt2_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t2_2
                                       Filter: (t1_2.a = a)
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_3.b = t2_3.a)
                           ->  Seq Scan on prt2_p3 t3_3
                           ->  Hash
                                 ->  Seq Scan on prt1_p3 t2_3
                                       Filter: (t1_3.a = a)
(40 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a  | t3a | least 
------+---+-------+------+-----+-------
 -250 | 0 | -0250 |      |     |      
 -200 | 0 | -0200 |      |     |      
 -150 | 0 | -0150 | -150 |   0 |  -150
 -100 | 0 | -0100 |      |     |      
  -50 | 0 | -0050 |      |     |      
    0 | 0 | 0000  |    0 |   0 |     0
   50 | 0 | 0050  |      |     |      
  100 | 0 | 0100  |      |     |      
  150 | 0 | 0150  |  150 |   0 |   150
  200 | 0 | 0200  |      |     |      
  250 | 0 | 0250  |      |     |      
  300 | 0 | 0300  |  300 |   0 |   300
  350 | 0 | 0350  |      |     |      
  400 | 0 | 0400  |      |     |      
  450 | 0 | 0450  |  450 |   0 |   450
  500 | 0 | 0500  |      |     |      
  550 | 0 | 0550  |      |     |      
(17 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: (prt1_p0.a = b)
               ->  Seq Scan on prt1_p0
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: (prt1_p1.a = b)
               ->  Seq Scan on prt1_p1
                     Filter: ((a < 450) AND (b = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: (prt2_p2.b = prt1_p2.a)
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(24 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: (t1.a = t1_4.b)
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_4.b = t1_8.a)
                           ->  Seq Scan on prt2_p0 t1_4
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1_8
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_1.a = t1_5.b)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_5.b = t1_9.a)
                           ->  Seq Scan on prt2_p1 t1_5
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_9
                                       Filter: (b = 0)
         ->  Hash Semi Join
               Hash Cond: (t1_2.a = t1_6.b)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: (t1_6.b = t1_10.a)
                           ->  Seq Scan on prt2_p2 t1_6
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_10
                                       Filter: (b = 0)
         ->  Merge Semi Join
               Merge Cond: (t1_3.a = t1_7.b)
               ->  Sort
                     Sort Key: t1_3.a
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
               ->  Sort
                     Sort Key: t1_7.b
                     ->  Hash Semi Join
                           Hash Cond: (t1_7.b = t1_11.a)
                           ->  Seq Scan on prt2_p3 t1_7
                           ->  Hash
                                 ->  Seq Scan on prt1_p3 t1_11
                                       Filter: (b = 0)
(50 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t3_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t3.a = t2.b)
                     ->  Seq Scan on prt1_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p0 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_2
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t3_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_3.b = t1_3.a)
                                 ->  Seq Scan on prt2_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_3
                                             Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
(17 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
(76 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
(76 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
(76 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t5.a = t4.b)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_1.a = t4_1.b)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_2.a = t4_2.b)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t5_3.a = t4_3.b)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
(76 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Join
                     Hash Cond: (t5.a = t1.a)
                     ->  Seq Scan on prt1_p0 t5
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t1.a)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4.b = t1.a)
                                             ->  Seq Scan on prt2_p0 t4
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2.b = t1.a)
                                                         ->  Seq Scan on prt2_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p0 t1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_1.a = t1_1.a)
                     ->  Seq Scan on prt1_p1 t5_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t1_1.a)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_1.b = t1_1.a)
                                             ->  Seq Scan on prt2_p1 t4_1
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_1.b = t1_1.a)
                                                         ->  Seq Scan on prt2_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p1 t1_1
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_2.a = t1_2.a)
                     ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t1_2.a)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_2.b = t1_2.a)
                                             ->  Seq Scan on prt2_p2 t4_2
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_2.b = t1_2.a)
                                                         ->  Seq Scan on prt2_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p2 t1_2
                                                                     Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: (t5_3.a = t1_3.a)
                     ->  Seq Scan on prt1_p3 t5_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_3.a = t1_3.a)
                                 ->  Seq Scan on prt1_p3 t3_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t4_3.b = t1_3.a)
                                             ->  Seq Scan on prt2_p3 t4_3
                                             ->  Hash
                                                   ->  Hash Join
                                                         Hash Cond: (t2_3.b = t1_3.a)
                                                         ->  Seq Scan on prt2_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_p3 t1_3
                                                                     Filter: (b = 0)
(76 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
-- prt2 default partition and have gaps in range 
-- pwj is not possible as one partition need to join with more than one partition.
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (-250) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 499) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (-250) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (50) TO (200);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p4 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 799) i WHERE i % 3 = 0 AND (i NOT BETWEEN 0 AND 50 OR i NOT BETWEEN 200 AND 250);
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
(17 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (200,0,0200)   | 
 (250,0,0250)   | 
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
(15 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p1 t1_1
               ->  Seq Scan on prt1_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p4 t2_3
                           Filter: (a = 0)
(18 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  375 | 0375
      |       |  525 | 0525
      |       |  600 | 0600
      |       |  675 | 0675
      |       |  750 | 0750
(14 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Full Join
         Hash Cond: (prt2_p0.b = prt1_p0.a)
         Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
         ->  Append
               ->  Seq Scan on prt2_p0
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p2
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p4
                     Filter: (a = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2
                           Filter: (b = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  |  c   | b  |  c   
----+------+----+------
 50 | 0050 |    | 
    |      | 75 | 0075
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p2 t2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4 t2_1
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: ((a < 450) AND (b = 0))
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
  a  |  c   |  b  |  c   
-----+------+-----+------
 300 | 0300 | 300 | 0300
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p2.b
   ->  Hash Right Join
         Hash Cond: (prt2_p2.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b  |  c   
------+-------+-----+------
 -250 | -0250 |     | 
 -200 | -0200 |     | 
 -150 | -0150 |     | 
 -100 | -0100 |     | 
  -50 | -0050 |     | 
    0 | 0000  |     | 
   50 | 0050  |     | 
  100 | 0100  |     | 
  150 | 0150  |     | 
  200 | 0200  |     | 
  250 | 0250  |     | 
  300 | 0300  | 300 | 0300
  350 | 0350  |     | 
  400 | 0400  |     | 
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p4 t2_3
                           Filter: (a = 0)
(21 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Hash Semi Join
         Hash Cond: (t1.b = t2.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p1 t1_1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p2 t1_2
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p4 t1_3
                     Filter: (a = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t2_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t2_2
                           Filter: (b = 0)
(21 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a |  b   |   c   
---+------+-------
 0 | -150 | -0150
 0 |    0 | 0000
 0 |  150 | 0150
 0 |  300 | 0300
 0 |  450 | 0450
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p1 t1_1
               ->  Seq Scan on prt1_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Seq Scan on prt2_p4 t2_3
(13 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum  |         avg          | sum  |        avg         
-------+----------------------+------+--------------------
 30750 | 123.0000000000000000 | 1000 | 4.0000000000000000
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_p0 t3
                     ->  Seq Scan on prt2_p1 t3_1
                     ->  Seq Scan on prt2_p2 t3_2
                     ->  Seq Scan on prt2_p4 t3_3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p2 t2_2
                                 Filter: (t1.a = a)
(25 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a  | t3a | least 
------+---+-------+------+-----+-------
 -250 | 0 | -0250 |      |     |      
 -200 | 0 | -0200 |      |     |      
 -150 | 0 | -0150 | -150 |   0 |  -150
 -100 | 0 | -0100 |      |     |      
  -50 | 0 | -0050 |      |     |      
    0 | 0 | 0000  |    0 |   0 |     0
   50 | 0 | 0050  |      |     |      
  100 | 0 | 0100  |      |     |      
  150 | 0 | 0150  |  150 |   0 |   150
  200 | 0 | 0200  |      |     |      
  250 | 0 | 0250  |      |     |      
  300 | 0 | 0300  |  300 |   0 |   300
  350 | 0 | 0350  |      |     |      
  400 | 0 | 0400  |      |     |      
  450 | 0 | 0450  |  450 |   0 |   450
(15 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p2.b
   ->  Hash Right Join
         Hash Cond: (prt2_p2.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(17 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: (t1.a = t1_3.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Hash Semi Join
                     Hash Cond: (t1_3.b = t1_7.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t1_3
                           ->  Seq Scan on prt2_p1 t1_4
                           ->  Seq Scan on prt2_p2 t1_5
                           ->  Seq Scan on prt2_p4 t1_6
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1_7
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_8
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_9
                                       Filter: (b = 0)
(27 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t3.a = t1.a)
                           ->  Seq Scan on prt1_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_1.a = t1_1.a)
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: (t3_2.a = t1_2.a)
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
(15 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t4.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t4
               ->  Seq Scan on prt2_p1 t4_1
               ->  Seq Scan on prt2_p2 t4_2
               ->  Seq Scan on prt2_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: (t5.a = t1.a)
                                       ->  Seq Scan on prt1_p0 t5
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3.a = t1.a)
                                                   ->  Seq Scan on prt1_p0 t3
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_1.a = t1_1.a)
                                       ->  Seq Scan on prt1_p1 t5_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_1.a = t1_1.a)
                                                   ->  Seq Scan on prt1_p1 t3_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_2.a = t1_2.a)
                                       ->  Seq Scan on prt1_p2 t5_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_2.a = t1_2.a)
                                                   ->  Seq Scan on prt1_p2 t3_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t4.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t4
               ->  Seq Scan on prt2_p1 t4_1
               ->  Seq Scan on prt2_p2 t4_2
               ->  Seq Scan on prt2_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: (t5.a = t1.a)
                                       ->  Seq Scan on prt1_p0 t5
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3.a = t1.a)
                                                   ->  Seq Scan on prt1_p0 t3
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_1.a = t1_1.a)
                                       ->  Seq Scan on prt1_p1 t5_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_1.a = t1_1.a)
                                                   ->  Seq Scan on prt1_p1 t3_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_2.a = t1_2.a)
                                       ->  Seq Scan on prt1_p2 t5_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_2.a = t1_2.a)
                                                   ->  Seq Scan on prt1_p2 t3_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t4.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t4
               ->  Seq Scan on prt2_p1 t4_1
               ->  Seq Scan on prt2_p2 t4_2
               ->  Seq Scan on prt2_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: (t5.a = t1.a)
                                       ->  Seq Scan on prt1_p0 t5
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3.a = t1.a)
                                                   ->  Seq Scan on prt1_p0 t3
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_1.a = t1_1.a)
                                       ->  Seq Scan on prt1_p1 t5_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_1.a = t1_1.a)
                                                   ->  Seq Scan on prt1_p1 t3_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_2.a = t1_2.a)
                                       ->  Seq Scan on prt1_p2 t5_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_2.a = t1_2.a)
                                                   ->  Seq Scan on prt1_p2 t3_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p4 t2_3
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t5.a = t4.b)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t5
                           ->  Seq Scan on prt1_p1 t5_1
                           ->  Seq Scan on prt1_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p4 t4_3
                                 ->  Hash
                                       ->  Append
                                             ->  Hash Join
                                                   Hash Cond: (t3.a = t1.a)
                                                   ->  Seq Scan on prt1_p0 t3
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                             ->  Hash Join
                                                   Hash Cond: (t3_1.a = t1_1.a)
                                                   ->  Seq Scan on prt1_p1 t3_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                             ->  Hash Join
                                                   Hash Cond: (t3_2.a = t1_2.a)
                                                   ->  Seq Scan on prt1_p2 t3_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t4.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t4
               ->  Seq Scan on prt2_p1 t4_1
               ->  Seq Scan on prt2_p2 t4_2
               ->  Seq Scan on prt2_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: (t5.a = t1.a)
                                       ->  Seq Scan on prt1_p0 t5
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3.a = t1.a)
                                                   ->  Seq Scan on prt1_p0 t3
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_1.a = t1_1.a)
                                       ->  Seq Scan on prt1_p1 t5_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_1.a = t1_1.a)
                                                   ->  Seq Scan on prt1_p1 t3_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                 ->  Hash Join
                                       Hash Cond: (t5_2.a = t1_2.a)
                                       ->  Seq Scan on prt1_p2 t5_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: (t3_2.a = t1_2.a)
                                                   ->  Seq Scan on prt1_p2 t3_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
(5 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
-- both partitions have gaps in range which filled by default partition of each other
-- Partition-wise join is not possible when one table need to join
-- with more than one table.
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (300) TO (450);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt1_p4 PARTITION OF prt1 DEFAULT;
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 699) i WHERE i % 2 = 0 AND (i NOT BETWEEN 250 AND 300 OR i NOT BETWEEN 450 AND 500);
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (50) TO (200);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (550) TO (600);
CREATE TABLE prt2_p4 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 699) i WHERE i % 3 = 0 AND (i NOT BETWEEN 0 AND 50 OR i NOT BETWEEN 200 AND 250 OR i NOT BETWEEN 500 AND 550);
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p3 t2_3
               ->  Seq Scan on prt2_p4 t2_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p4 t1_4
                           Filter: (b = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600
(6 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p1 t2_1
               ->  Seq Scan on prt2_p2 t2_2
               ->  Seq Scan on prt2_p3 t2_3
               ->  Seq Scan on prt2_p4 t2_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p3 t1_3
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p4 t1_4
                           Filter: (b = 0)
(22 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (200,0,0200)   | 
 (250,0,0250)   | 
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
 (500,0,0500)   | 
 (550,0,0550)   | 
 (600,0,0600)   | (0,600,0600)
 (650,0,0650)   | 
(19 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p1 t1_1
               ->  Seq Scan on prt1_p2 t1_2
               ->  Seq Scan on prt1_p3 t1_3
               ->  Seq Scan on prt1_p4 t1_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p3 t2_3
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p4 t2_4
                           Filter: (a = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  375 | 0375
      |       |  525 | 0525
      |       |  675 | 0675
(13 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Full Join
         Hash Cond: (prt1_p0.a = prt2_p0.b)
         Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
         ->  Append
               ->  Seq Scan on prt1_p0
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p3
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p4
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p3
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p4
                           Filter: (a = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  |  c   | b  |  c   
----+------+----+------
 50 | 0050 |    | 
    |      | 75 | 0075
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p2 t2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p3 t2_1
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4 t2_2
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1 t1_1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2 t1_2
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p4 t1_3
                           Filter: ((a < 450) AND (b = 0))
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
  a  |  c   |  b  |  c   
-----+------+-----+------
 300 | 0300 | 300 | 0300
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p2.b
   ->  Hash Right Join
         Hash Cond: (prt2_p2.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p3
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p4
                           Filter: ((a < 450) AND (b = 0))
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b  |  c   
------+-------+-----+------
 -250 | -0250 |     | 
 -200 | -0200 |     | 
 -150 | -0150 |     | 
 -100 | -0100 |     | 
  -50 | -0050 |     | 
    0 | 0000  |     | 
   50 | 0050  |     | 
  100 | 0100  |     | 
  150 | 0150  |     | 
  200 | 0200  |     | 
  250 | 0250  |     | 
  300 | 0300  | 300 | 0300
  350 | 0350  |     | 
  400 | 0400  |     | 
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p3 t1_3
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p4 t1_4
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p1 t2_1
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p3 t2_3
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p4 t2_4
                           Filter: (a = 0)
(27 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
  600 | 0 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Hash Semi Join
         Hash Cond: (t1.b = t2.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p1 t1_1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p2 t1_2
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p3 t1_3
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p4 t1_4
                     Filter: (a = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p1 t2_1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t2_2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p3 t2_3
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p4 t2_4
                           Filter: (b = 0)
(27 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a |  b   |   c   
---+------+-------
 0 | -150 | -0150
 0 |    0 | 0000
 0 |  150 | 0150
 0 |  300 | 0300
 0 |  450 | 0450
 0 |  600 | 0600
(6 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p1 t1_1
               ->  Seq Scan on prt1_p2 t1_2
               ->  Seq Scan on prt1_p3 t1_3
               ->  Seq Scan on prt1_p4 t1_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Seq Scan on prt2_p3 t2_3
                     ->  Seq Scan on prt2_p4 t2_4
(16 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum  |         avg          | sum  |        avg         
-------+----------------------+------+--------------------
 70850 | 223.5015772870662461 | 1800 | 5.6782334384858044
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p3 t1_3
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p4 t1_4
                     Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_p0 t3
                     ->  Seq Scan on prt2_p1 t3_1
                     ->  Seq Scan on prt2_p2 t3_2
                     ->  Seq Scan on prt2_p3 t3_3
                     ->  Seq Scan on prt2_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p2 t2_2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p3 t2_3
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p4 t2_4
                                 Filter: (t1.a = a)
(34 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a  | t3a | least 
------+---+-------+------+-----+-------
 -250 | 0 | -0250 |      |     |      
 -200 | 0 | -0200 |      |     |      
 -150 | 0 | -0150 | -150 |   0 |  -150
 -100 | 0 | -0100 |      |     |      
  -50 | 0 | -0050 |      |     |      
    0 | 0 | 0000  |    0 |   0 |     0
   50 | 0 | 0050  |      |     |      
  100 | 0 | 0100  |      |     |      
  150 | 0 | 0150  |  150 |   0 |   150
  200 | 0 | 0200  |      |     |      
  250 | 0 | 0250  |      |     |      
  300 | 0 | 0300  |  300 |   0 |   300
  350 | 0 | 0350  |      |     |      
  400 | 0 | 0400  |      |     |      
  450 | 0 | 0450  |  450 |   0 |   450
  500 | 0 | 0500  |      |     |      
  550 | 0 | 0550  |      |     |      
  600 | 0 | 0600  |  600 |   0 |   600
  650 | 0 | 0650  |      |     |      
(19 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p2.b
   ->  Hash Right Join
         Hash Cond: (prt2_p2.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p3
                     Filter: (b > 250)
               ->  Seq Scan on prt2_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p4
                           Filter: ((a < 450) AND (b = 0))
(21 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: (t1.a = t1_5.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p1 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p3 t1_3
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p4 t1_4
                     Filter: (b = 0)
         ->  Hash
               ->  Hash Semi Join
                     Hash Cond: (t1_5.b = t1_10.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t1_5
                           ->  Seq Scan on prt2_p1 t1_6
                           ->  Seq Scan on prt2_p2 t1_7
                           ->  Seq Scan on prt2_p3 t1_8
                           ->  Seq Scan on prt2_p4 t1_9
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1_10
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_11
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_12
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_13
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_14
                                       Filter: (b = 0)
(36 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
  a   | b |   c   
------+---+-------
 -150 | 0 | -0150
    0 | 0 | 0000
  150 | 0 | 0150
  300 | 0 | 0300
  450 | 0 | 0450
  600 | 0 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
  600 | 0600  |  600 | 0600  |  600 | 0600
  650 | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
  600 | 0600  |  600 | 0600  |  600 | 0600
  650 | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
  600 | 0600  |  600 | 0600  |  600 | 0600
  650 | 0650  |      |       |      | 0650
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p1 t3_1
               ->  Seq Scan on prt1_p2 t3_2
               ->  Seq Scan on prt1_p3 t3_3
               ->  Seq Scan on prt1_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p1 t2_1
                           ->  Seq Scan on prt2_p2 t2_2
                           ->  Seq Scan on prt2_p3 t2_3
                           ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p1 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_2
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p3 t1_3
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p4 t1_4
                                       Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -250 | -0250 |      |       |      | -0250
 -200 | -0200 |      |       |      | -0200
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -100 | -0100 |      |       |      | -0100
  -50 | -0050 |      |       |      | -0050
    0 | 0000  |    0 | 0000  |    0 | 0000
   50 | 0050  |      |       |      | 0050
  100 | 0100  |      |       |      | 0100
  150 | 0150  |  150 | 0150  |  150 | 0150
  200 | 0200  |      |       |      | 0200
  250 | 0250  |      |       |      | 0250
  300 | 0300  |  300 | 0300  |  300 | 0300
  350 | 0350  |      |       |      | 0350
  400 | 0400  |      |       |      | 0400
  450 | 0450  |  450 | 0450  |  450 | 0450
  500 | 0500  |      |       |      | 0500
  550 | 0550  |      |       |      | 0550
  600 | 0600  |  600 | 0600  |  600 | 0600
  650 | 0650  |      |       |      | 0650
(19 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p1 t5_1
               ->  Seq Scan on prt1_p2 t5_2
               ->  Seq Scan on prt1_p3 t5_3
               ->  Seq Scan on prt1_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Seq Scan on prt1_p3 t3_3
                           ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p3 t4_3
                                       ->  Seq Scan on prt2_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p1 t2_1
                                                   ->  Seq Scan on prt2_p2 t2_2
                                                   ->  Seq Scan on prt2_p3 t2_3
                                                   ->  Seq Scan on prt2_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p3 t1_3
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p4 t1_4
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p1 t5_1
               ->  Seq Scan on prt1_p2 t5_2
               ->  Seq Scan on prt1_p3 t5_3
               ->  Seq Scan on prt1_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Seq Scan on prt1_p3 t3_3
                           ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p3 t4_3
                                       ->  Seq Scan on prt2_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p1 t2_1
                                                   ->  Seq Scan on prt2_p2 t2_2
                                                   ->  Seq Scan on prt2_p3 t2_3
                                                   ->  Seq Scan on prt2_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p3 t1_3
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p4 t1_4
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p1 t5_1
               ->  Seq Scan on prt1_p2 t5_2
               ->  Seq Scan on prt1_p3 t5_3
               ->  Seq Scan on prt1_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Seq Scan on prt1_p3 t3_3
                           ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p3 t4_3
                                       ->  Seq Scan on prt2_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p1 t2_1
                                                   ->  Seq Scan on prt2_p2 t2_2
                                                   ->  Seq Scan on prt2_p3 t2_3
                                                   ->  Seq Scan on prt2_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p3 t1_3
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p4 t1_4
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t5.a = t4.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p1 t5_1
               ->  Seq Scan on prt1_p2 t5_2
               ->  Seq Scan on prt1_p3 t5_3
               ->  Seq Scan on prt1_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Seq Scan on prt1_p3 t3_3
                           ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p3 t4_3
                                       ->  Seq Scan on prt2_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p1 t2_1
                                                   ->  Seq Scan on prt2_p2 t2_2
                                                   ->  Seq Scan on prt2_p3 t2_3
                                                   ->  Seq Scan on prt2_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p3 t1_3
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p4 t1_4
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p1 t5_1
               ->  Seq Scan on prt1_p2 t5_2
               ->  Seq Scan on prt1_p3 t5_3
               ->  Seq Scan on prt1_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p1 t3_1
                           ->  Seq Scan on prt1_p2 t3_2
                           ->  Seq Scan on prt1_p3 t3_3
                           ->  Seq Scan on prt1_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p1 t4_1
                                       ->  Seq Scan on prt2_p2 t4_2
                                       ->  Seq Scan on prt2_p3 t4_3
                                       ->  Seq Scan on prt2_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p1 t2_1
                                                   ->  Seq Scan on prt2_p2 t2_2
                                                   ->  Seq Scan on prt2_p3 t2_3
                                                   ->  Seq Scan on prt2_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p1 t1_1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_2
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p3 t1_3
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p4 t1_4
                                                               Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -150 | -0150 | -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150  |  150 | 0150
  300 | 0300  |  300 | 0300  |  300 | 0300
  450 | 0450  |  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600  |  600 | 0600
(6 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
-- only default is common bounds in both relation
-- partition-wise-join not possible as default range is different
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (-9);
CREATE TABLE prt1_p2 PARTITION OF prt1 DEFAULT;
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-500, 10) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (10) TO (MAXVALUE);
CREATE TABLE prt2_p2 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-10, 500) i WHERE i % 3 = 0;
ANALYZE prt2;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p2 t2_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_1
                           Filter: (b = 0)
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   
---+------+---+------
 0 | 0000 | 0 | 0000
(1 row)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
               ->  Seq Scan on prt2_p2 t2_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t1_1
                           Filter: (b = 0)
(13 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |     t2     
----------------+------------
 (-500,0,-0500) | 
 (-450,0,-0450) | 
 (-400,0,-0400) | 
 (-350,0,-0350) | 
 (-300,0,-0300) | 
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | 
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
(11 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_1
                           Filter: (a = 0)
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
 a |  c   |  b  |  c   
---+------+-----+------
 0 | 0000 |   0 | 0000
   |      |  75 | 0075
   |      | 150 | 0150
   |      | 225 | 0225
   |      | 300 | 0300
   |      | 375 | 0375
   |      | 450 | 0450
(7 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Full Join
         Hash Cond: (prt1_p0.a = prt2_p0.b)
         Filter: (((50) = prt1_p0.a) OR ((75) = prt2_p0.b))
         ->  Append
               ->  Seq Scan on prt1_p0
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2
                           Filter: (a = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a | c | b  |  c   
---+---+----+------
   |   | 75 | 0075
(1 row)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t2.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t2
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t1
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2 t1_1
                           Filter: ((a < 450) AND (b = 0))
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1, prt2 t2 WHERE t1.a = t2.b AND t1.a < 450 AND t2.b > 250 AND t1.b = 0 ORDER BY t1.a, t2.b;
 a | c | b | c 
---+---+---+---
(0 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Right Join
         Hash Cond: (prt2_p0.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p0
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   | b | c 
------+-------+---+---
 -500 | -0500 |   | 
 -450 | -0450 |   | 
 -400 | -0400 |   | 
 -350 | -0350 |   | 
 -300 | -0300 |   | 
 -250 | -0250 |   | 
 -200 | -0200 |   | 
 -150 | -0150 |   | 
 -100 | -0100 |   | 
  -50 | -0050 |   | 
    0 | 0000  |   | 
(11 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_1
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                           Filter: (a = 0)
                     ->  Seq Scan on prt2_p2 t2_1
                           Filter: (a = 0)
(15 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t2.b FROM prt2 t2 WHERE t2.a = 0) AND t1.b = 0 ORDER BY t1.a;
 a | b |  c   
---+---+------
 0 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Hash Semi Join
         Hash Cond: (t1.b = t2.a)
         ->  Append
               ->  Seq Scan on prt2_p0 t1
                     Filter: (a = 0)
               ->  Seq Scan on prt2_p2 t1_1
                     Filter: (a = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0 t2
                           Filter: (b = 0)
                     ->  Seq Scan on prt1_p2 t2_1
                           Filter: (b = 0)
(15 rows)

SELECT t1.* FROM prt2 t1 WHERE t1.b IN (SELECT t2.a FROM prt1 t2 WHERE t2.b = 0) AND t1.a = 0 ORDER BY t1.b;
 a | b |  c   
---+---+------
 0 | 0 | 0000
(1 row)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
                    QUERY PLAN                    
--------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: (t1.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t1
               ->  Seq Scan on prt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_p0 t2
                     ->  Seq Scan on prt2_p2 t2_1
(10 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1 t1 WHERE NOT EXISTS (SELECT 1 FROM prt2 t2 WHERE t1.a = t2.b);
  sum   |          avg          |  sum  |         avg          
--------+-----------------------+-------+----------------------
 -62720 | -247.9051383399209486 | -2970 | -11.7391304347826087
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_1
                     Filter: (b = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_p0 t3
                     ->  Seq Scan on prt2_p2 t3_1
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_p2 t2_1
                                 Filter: (t1.a = a)
(19 rows)

SELECT * FROM prt1 t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1 t2 JOIN prt2 t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.b = 0 ORDER BY t1.a;
  a   | b |   c   | t2a | t3a | least 
------+---+-------+-----+-----+-------
 -500 | 0 | -0500 |     |     |      
 -450 | 0 | -0450 |     |     |      
 -400 | 0 | -0400 |     |     |      
 -350 | 0 | -0350 |     |     |      
 -300 | 0 | -0300 |     |     |      
 -250 | 0 | -0250 |     |     |      
 -200 | 0 | -0200 |     |     |      
 -150 | 0 | -0150 |     |     |      
 -100 | 0 | -0100 |     |     |      
  -50 | 0 | -0050 |     |     |      
    0 | 0 | 0000  |   0 |   0 |     0
(11 rows)

-- nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: prt1_p0.a, prt2_p0.b
   ->  Hash Right Join
         Hash Cond: (prt2_p0.b = prt1_p0.a)
         ->  Append
               ->  Seq Scan on prt2_p0
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_p0
                           Filter: ((a < 450) AND (b = 0))
                     ->  Seq Scan on prt1_p2
                           Filter: ((a < 450) AND (b = 0))
(13 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1 WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2 WHERE b > 250) t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   | b 
------+---
 -500 |  
 -450 |  
 -400 |  
 -350 |  
 -300 |  
 -250 |  
 -200 |  
 -150 |  
 -100 |  
  -50 |  
    0 |  
(11 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
                       QUERY PLAN                       
--------------------------------------------------------
 Merge Semi Join
   Merge Cond: (t1.a = t1_2.b)
   ->  Sort
         Sort Key: t1.a
         ->  Append
               ->  Seq Scan on prt1_p0 t1
                     Filter: (b = 0)
               ->  Seq Scan on prt1_p2 t1_1
                     Filter: (b = 0)
   ->  Sort
         Sort Key: t1_2.b
         ->  Hash Semi Join
               Hash Cond: (t1_2.b = t1_4.a)
               ->  Append
                     ->  Seq Scan on prt2_p0 t1_2
                     ->  Seq Scan on prt2_p2 t1_3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_p0 t1_4
                                 Filter: (b = 0)
                           ->  Seq Scan on prt1_p2 t1_5
                                 Filter: (b = 0)
(22 rows)

SELECT t1.* FROM prt1 t1 WHERE t1.a IN (SELECT t1.b FROM prt2 t1 WHERE t1.b IN (SELECT t1.a FROM prt1 t1 WHERE t1.b = 0)) AND t1.b = 0 ORDER BY t1.a;
 a | b |  c   
---+---+------
 0 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   | b |  c   | a |   c   
------+-------+---+------+---+-------
 -500 | -0500 |   |      |   | -0500
 -450 | -0450 |   |      |   | -0450
 -400 | -0400 |   |      |   | -0400
 -350 | -0350 |   |      |   | -0350
 -300 | -0300 |   |      |   | -0300
 -250 | -0250 |   |      |   | -0250
 -200 | -0200 |   |      |   | -0200
 -150 | -0150 |   |      |   | -0150
 -100 | -0100 |   |      |   | -0100
  -50 | -0050 |   |      |   | -0050
    0 | 0000  | 0 | 0000 | 0 | 0000
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   | b |  c   | a |   c   
------+-------+---+------+---+-------
 -500 | -0500 |   |      |   | -0500
 -450 | -0450 |   |      |   | -0450
 -400 | -0400 |   |      |   | -0400
 -350 | -0350 |   |      |   | -0350
 -300 | -0300 |   |      |   | -0300
 -250 | -0250 |   |      |   | -0250
 -200 | -0200 |   |      |   | -0200
 -150 | -0150 |   |      |   | -0150
 -100 | -0100 |   |      |   | -0100
  -50 | -0050 |   |      |   | -0050
    0 | 0000  | 0 | 0000 | 0 | 0000
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   | b |  c   | a |   c   
------+-------+---+------+---+-------
 -500 | -0500 |   |      |   | -0500
 -450 | -0450 |   |      |   | -0450
 -400 | -0400 |   |      |   | -0400
 -350 | -0350 |   |      |   | -0350
 -300 | -0300 |   |      |   | -0300
 -250 | -0250 |   |      |   | -0250
 -200 | -0200 |   |      |   | -0200
 -150 | -0150 |   |      |   | -0150
 -100 | -0100 |   |      |   | -0100
  -50 | -0050 |   |      |   | -0050
    0 | 0000  | 0 | 0000 | 0 | 0000
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) RIGHT JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: (t3.a = t2.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t3
               ->  Seq Scan on prt1_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p0 t2
                           ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p0 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: (b = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 FULL JOIN prt2 t2 ON (t1.a = t2.b) FULL JOIN prt1 t3 ON (t2.b = t3.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
  a   |   c   | b |  c   | a |   c   
------+-------+---+------+---+-------
 -500 | -0500 |   |      |   | -0500
 -450 | -0450 |   |      |   | -0450
 -400 | -0400 |   |      |   | -0400
 -350 | -0350 |   |      |   | -0350
 -300 | -0300 |   |      |   | -0300
 -250 | -0250 |   |      |   | -0250
 -200 | -0200 |   |      |   | -0200
 -150 | -0150 |   |      |   | -0150
 -100 | -0100 |   |      |   | -0100
  -50 | -0050 |   |      |   | -0050
    0 | 0000  | 0 | 0000 | 0 | 0000
(11 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_1
                                                               Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_1
                                                               Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) INNER JOIN prt2 t4 ON (t3.a = t4.b) RIGHT JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_1
                                                               Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 LEFT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t5.a = t4.b)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_1
                                                               Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 INNER JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) RIGHT JOIN prt2 t4 ON (t3.a = t4.b) FULL JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t5.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p0 t5
               ->  Seq Scan on prt1_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t3.a = t1.a)
                     ->  Append
                           ->  Seq Scan on prt1_p0 t3
                           ->  Seq Scan on prt1_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t4.b = t1.a)
                                 ->  Append
                                       ->  Seq Scan on prt2_p0 t4
                                       ->  Seq Scan on prt2_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: (t2.b = t1.a)
                                             ->  Append
                                                   ->  Seq Scan on prt2_p0 t2
                                                   ->  Seq Scan on prt2_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_p0 t1
                                                               Filter: (b = 0)
                                                         ->  Seq Scan on prt1_p2 t1_1
                                                               Filter: (b = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) LEFT JOIN prt1 t3 ON (t2.b = t3.a) FULL JOIN prt2 t4 ON (t3.a = t4.b) INNER JOIN prt1 t5 ON (t4.b = t5.a) WHERE t1.b = 0 ORDER BY t1.a, t2.b;
 a |  c   | b |  c   | a |  c   
---+------+---+------+---+------
 0 | 0000 | 0 | 0000 | 0 | 0000
(1 row)

DROP TABLE prt1;
DROP TABLE prt2;
--=============================================================================================================================
--
-- partitioned by a multiple column
--
--=============================================================================================================================
-- prt1_m and prt2_m both have default partition with excat bound matches.
-- pwj is possible for all cases.
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt1_m_p1 PARTITION OF prt1_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt1_m_p3 PARTITION OF prt1_m FOR VALUES FROM (500,500) TO (MAXVALUE,MAXVALUE);
CREATE TABLE prt1_m_p4 PARTITION OF prt1_m DEFAULT;
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-250, 599) i WHERE i % 2 = 0;
INSERT INTO prt1_m SELECT i, i, i % 35  FROM generate_series(-250, 599) i WHERE i % 2 = 0;
INSERT INTO prt1_m SELECT NULL, i, i % 25  FROM generate_series(599, 699) i WHERE i % 2 = 0;
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt2_m_p1 PARTITION OF prt2_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt2_m_p3 PARTITION OF prt2_m FOR VALUES FROM (500,500) TO (MAXVALUE,MAXVALUE);
CREATE TABLE prt2_m_p4 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-250, 599) i WHERE i % 3 = 0;
INSERT INTO prt2_m SELECT i, i, i % 35  FROM generate_series(-250, 599) i WHERE i % 3 = 0;
INSERT INTO prt2_m SELECT i, NULL, i % 25  FROM generate_series(599, 699) i WHERE i % 3 = 0;
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Append
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p0 t1
                                 Filter: (c = 0)
               ->  Hash Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_m_p1 t1_1
                                 Filter: (c = 0)
               ->  Hash Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t1_2
                                 Filter: (c = 0)
               ->  Hash Join
                     Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                     ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_m_p3 t1_3
                                 Filter: (c = 0)
               ->  Hash Join
                     Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                     ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Seq Scan on prt1_m_p4 t1_4
                                 Filter: (c = 0)
(34 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   
------+------+------+------
 -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150
    0 |    0 |    0 |    0
  150 |  150 |  150 |  150
  210 |  210 |  210 |  210
  300 |  300 |  300 |  300
  420 |  420 |  420 |  420
  450 |  450 |  450 |  450
(8 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1,t2;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: ((t1.*)::prt1_m), ((t2.*)::prt2_m)
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p0 t1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_m_p1 t1_1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t1_2
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                     ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_m_p3 t1_3
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                     ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Seq Scan on prt1_m_p4 t1_4
                                 Filter: (c = 0)
(34 rows)

SELECT DISTINCT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1,t2;
      t1       |       t2        
---------------+-----------------
 (-250,-250,0) | 
 (-210,-210,0) | (-210,-210,-10)
 (-210,-210,0) | (-210,-210,0)
 (-200,-200,0) | 
 (-150,-150,0) | (-150,-150,-10)
 (-150,-150,0) | (-150,-150,0)
 (-140,-140,0) | 
 (-100,-100,0) | 
 (-70,-70,0)   | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
 (50,50,0)     | 
 (70,70,0)     | 
 (100,100,0)   | 
 (140,140,0)   | 
 (150,150,0)   | (150,150,0)
 (150,150,0)   | (150,150,10)
 (200,200,0)   | 
 (210,210,0)   | (210,210,0)
 (210,210,0)   | (210,210,10)
 (250,250,0)   | 
 (280,280,0)   | 
 (300,300,0)   | (300,300,0)
 (300,300,0)   | (300,300,20)
 (350,350,0)   | 
 (400,400,0)   | 
 (420,420,0)   | (420,420,0)
 (420,420,0)   | (420,420,20)
 (450,450,0)   | (450,450,0)
 (450,450,0)   | (450,450,30)
 (490,490,0)   | 
 (500,500,0)   | 
 (550,550,0)   | 
 (560,560,0)   | 
 (,600,0)      | 
 (,650,0)      | 
(36 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, t1.b, t2.a
         ->  Result
               ->  Append
                     ->  Hash Right Join
                           Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
                           ->  Seq Scan on prt1_m_p0 t1
                           ->  Hash
                                 ->  Seq Scan on prt2_m_p0 t2
                                       Filter: (c = 0)
                     ->  Hash Right Join
                           Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
                           ->  Seq Scan on prt1_m_p1 t1_1
                           ->  Hash
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                       Filter: (c = 0)
                     ->  Hash Right Join
                           Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
                           ->  Seq Scan on prt1_m_p2 t1_2
                           ->  Hash
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                       Filter: (c = 0)
                     ->  Hash Right Join
                           Hash Cond: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
                           ->  Seq Scan on prt1_m_p3 t1_3
                           ->  Hash
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                       Filter: (c = 0)
                     ->  Hash Right Join
                           Hash Cond: ((t1_4.a = t2_4.b) AND (t1_4.b = t2_4.a))
                           ->  Seq Scan on prt1_m_p4 t1_4
                           ->  Hash
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                       Filter: (c = 0)
(35 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   
------+------+------+------
 -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150
    0 |    0 |    0 |    0
  150 |  150 |  150 |  150
  210 |  210 |  210 |  210
  300 |  300 |  300 |  300
  420 |  420 |  420 |  420
  450 |  450 |  450 |  450
      |      | -225 | -225
      |      | -105 | -105
      |      |  -75 |  -75
      |      |   75 |   75
      |      |  105 |  105
      |      |  225 |  225
      |      |  315 |  315
      |      |  375 |  375
      |      |  525 |  525
      |      |  600 |     
      |      |  675 |     
(19 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM (SELECT 50 phv, * FROM prt1_m) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: prt1_m_p0.a, prt1_m_p0.b, prt2_m_p0.a, prt2_m_p0.b
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((prt1_m_p0.a = prt2_m_p0.b) AND (prt1_m_p0.b = prt2_m_p0.a))
                     Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
                     ->  Seq Scan on prt1_m_p0
                     ->  Hash
                           ->  Seq Scan on prt2_m_p0
               ->  Hash Full Join
                     Hash Cond: ((prt1_m_p1.a = prt2_m_p1.b) AND (prt1_m_p1.b = prt2_m_p1.a))
                     Filter: (((50) = prt1_m_p1.a) OR ((75) = prt2_m_p1.b))
                     ->  Seq Scan on prt1_m_p1
                     ->  Hash
                           ->  Seq Scan on prt2_m_p1
               ->  Hash Full Join
                     Hash Cond: ((prt1_m_p2.a = prt2_m_p2.b) AND (prt1_m_p2.b = prt2_m_p2.a))
                     Filter: (((50) = prt1_m_p2.a) OR ((75) = prt2_m_p2.b))
                     ->  Seq Scan on prt1_m_p2
                     ->  Hash
                           ->  Seq Scan on prt2_m_p2
               ->  Hash Full Join
                     Hash Cond: ((prt1_m_p3.a = prt2_m_p3.b) AND (prt1_m_p3.b = prt2_m_p3.a))
                     Filter: (((50) = prt1_m_p3.a) OR ((75) = prt2_m_p3.b))
                     ->  Seq Scan on prt1_m_p3
                     ->  Hash
                           ->  Seq Scan on prt2_m_p3
               ->  Hash Full Join
                     Hash Cond: ((prt1_m_p4.a = prt2_m_p4.b) AND (prt1_m_p4.b = prt2_m_p4.a))
                     Filter: (((50) = prt1_m_p4.a) OR ((75) = prt2_m_p4.b))
                     ->  Seq Scan on prt1_m_p4
                     ->  Hash
                           ->  Seq Scan on prt2_m_p4
(34 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM (SELECT 50 phv, * FROM prt1_m) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b;
 a  | b  | a  | b  
----+----+----+----
 50 | 50 |    |   
    |    | 75 | 75
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Append
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Seq Scan on prt2_m_p2 t2
                           Filter: (b > 250)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t1
                                 Filter: ((a < 450) AND (c = 0))
               ->  Nested Loop
                     Join Filter: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p4 t1_1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt2_m_p4 t2_1
                           Filter: (b > 250)
(17 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
  a  |  b  |  a  |  b  
-----+-----+-----+-----
 300 | 300 | 300 | 300
 420 | 420 | 420 | 420
(2 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: prt1_m_p0.a, b, prt1_m_p0.b, a
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Hash
                           ->  Result
                                 One-Time Filter: false
               ->  Hash Left Join
                     Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Hash
                           ->  Result
                                 One-Time Filter: false
               ->  Hash Right Join
                     Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
                     ->  Seq Scan on prt2_m_p2
                           Filter: (b > 250)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2
                                 Filter: ((a < 450) AND (c = 0))
               ->  Nested Loop Left Join
                     Join Filter: ((prt1_m_p4.a = prt2_m_p4.b) AND (prt1_m_p4.b = prt2_m_p4.a))
                     ->  Seq Scan on prt1_m_p4
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt2_m_p4
                           Filter: (b > 250)
(31 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a  |  b  
------+------+-----+-----
 -250 | -250 |     |    
 -210 | -210 |     |    
 -200 | -200 |     |    
 -150 | -150 |     |    
 -140 | -140 |     |    
 -100 | -100 |     |    
  -70 |  -70 |     |    
  -50 |  -50 |     |    
    0 |    0 |     |    
   50 |   50 |     |    
   70 |   70 |     |    
  100 |  100 |     |    
  140 |  140 |     |    
  150 |  150 |     |    
  200 |  200 |     |    
  210 |  210 |     |    
  250 |  250 |     |    
  280 |  280 |     |    
  300 |  300 | 300 | 300
  350 |  350 |     |    
  400 |  400 |     |    
  420 |  420 | 420 | 420
(22 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Append
               ->  Hash Semi Join
                     Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt2_m_p0 t2
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt2_m_p1 t2_1
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt2_m_p2 t2_2
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt2_m_p3 t2_3
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.a = t2_4.b) AND (t1_4.b = t2_4.a))
                     ->  Seq Scan on prt1_m_p4 t1_4
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt2_m_p4 t2_4
                                 Filter: (c = 0)
(39 rows)

SELECT DISTINCT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -210 | -210 | 0
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  210 |  210 | 0
  300 |  300 | 0
  420 |  420 | 0
  450 |  450 | 0
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.b, t1.a
         ->  Append
               ->  Hash Semi Join
                     Hash Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
                     ->  Seq Scan on prt2_m_p0 t1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_1.b = t2_1.a) AND (t1_1.a = t2_1.b))
                     ->  Seq Scan on prt2_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p1 t2_1
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.b = t2_2.a) AND (t1_2.a = t2_2.b))
                     ->  Seq Scan on prt2_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t2_2
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.b = t2_3.a) AND (t1_3.a = t2_3.b))
                     ->  Seq Scan on prt2_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p3 t2_3
                                 Filter: (c = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.b = t2_4.a) AND (t1_4.a = t2_4.b))
                     ->  Seq Scan on prt2_m_p4 t1_4
                           Filter: (c = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p4 t2_4
                                 Filter: (c = 0)
(39 rows)

SELECT DISTINCT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
  a   |  b   | c 
------+------+---
 -210 | -210 | 0
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  210 |  210 | 0
  300 |  300 | 0
  420 |  420 | 0
  450 |  450 | 0
(8 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT t1.a, avg(t1.a) FROM prt2_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt1_m t2 WHERE t1.a = t2.b AND t1.b = t2.a) AND t1.a %25 =  0 GROUP BY t1.a ORDER BY t1.a;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 GroupAggregate
   Group Key: t1.a
   ->  Sort
         Sort Key: t1.a
         ->  Append
               ->  Nested Loop Anti Join
                     Join Filter: ((t1.a = t2.b) AND (t1.b = t2.a))
                     ->  Seq Scan on prt2_m_p0 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on prt1_m_p0 t2
               ->  Nested Loop Anti Join
                     Join Filter: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
                     ->  Seq Scan on prt2_m_p1 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on prt1_m_p1 t2_1
               ->  Nested Loop Anti Join
                     Join Filter: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
                     ->  Seq Scan on prt2_m_p2 t1_2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on prt1_m_p2 t2_2
               ->  Nested Loop Anti Join
                     Join Filter: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
                     ->  Seq Scan on prt2_m_p3 t1_3
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on prt1_m_p3 t2_3
               ->  Nested Loop Anti Join
                     Join Filter: ((t1_4.a = t2_4.b) AND (t1_4.b = t2_4.a))
                     ->  Seq Scan on prt2_m_p4 t1_4
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on prt1_m_p4 t2_4
(30 rows)

SELECT t1.a, avg(t1.a) FROM prt2_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt1_m t2 WHERE t1.a = t2.b AND t1.b = t2.a) AND t1.a %25 =  0 GROUP BY t1.a ORDER BY t1.a;
  a   |          avg          
------+-----------------------
 -225 | -225.0000000000000000
  -75 |  -75.0000000000000000
   75 |   75.0000000000000000
  225 |  225.0000000000000000
  375 |  375.0000000000000000
  525 |  525.0000000000000000
  600 |  600.0000000000000000
  675 |  675.0000000000000000
(8 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct t1.a, t2b,least_all FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t2.b AS t2b, t3.a AS t3a, t3.b AS t3b,least(t1.a,t1.b,t2.a,t2.b,t3.a,t3.b) AS least_all FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b AND t2.b = t3.a)) ss ON t1.a = ss.t2a AND t1.b = ss.t2b WHERE t1.c = 0 ORDER BY t1.a;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, (LEAST(t1.a, t1.b, t2.a, t2.b, t3.a, t3.b))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.b = t2.a) AND (t3.a = t2.b))
                           ->  Seq Scan on prt2_m_p0 t3
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t2
                                       Filter: ((t1.a = a) AND (t1.b = b))
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.b = t2_1.a) AND (t3_1.a = t2_1.b))
                           ->  Seq Scan on prt2_m_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t2_1
                                       Filter: ((t1_1.a = a) AND (t1_1.b = b))
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.b = t2_2.a) AND (t3_2.a = t2_2.b))
                           ->  Seq Scan on prt2_m_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t2_2
                                       Filter: ((t1_2.a = a) AND (t1_2.b = b))
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_3.b = t2_3.a) AND (t3_3.a = t2_3.b))
                           ->  Seq Scan on prt2_m_p3 t3_3
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p3 t2_3
                                       Filter: ((t1_3.a = a) AND (t1_3.b = b))
               ->  Nested Loop Left Join
                     ->  Seq Scan on prt1_m_p4 t1_4
                           Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_4.b = t2_4.a) AND (t3_4.a = t2_4.b))
                           ->  Seq Scan on prt2_m_p4 t3_4
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p4 t2_4
                                       Filter: ((t1_4.a = a) AND (t1_4.b = b))
(49 rows)

SELECT distinct t1.a, t2b,least_all FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t2.b AS t2b, t3.a AS t3a, t3.b AS t3b,least(t1.a,t1.b,t2.a,t2.b,t3.a,t3.b) AS least_all FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b AND t2.b = t3.a)) ss ON t1.a = ss.t2a AND t1.b = ss.t2b WHERE t1.c = 0 ORDER BY t1.a;
  a   | t2b  | least_all 
------+------+-----------
 -250 |      |          
 -210 | -210 |      -210
 -200 |      |          
 -150 | -150 |      -150
 -140 |      |          
 -100 |      |          
  -70 |      |          
  -50 |      |          
    0 |    0 |         0
   50 |      |          
   70 |      |          
  100 |      |          
  140 |      |          
  150 |  150 |       150
  200 |      |          
  210 |  210 |       210
  250 |      |          
  280 |      |          
  300 |  300 |       300
  350 |      |          
  400 |      |          
  420 |  420 |       420
  450 |  450 |       450
  490 |      |          
  500 |      |          
  550 |      |          
  560 |      |          
      |      |          
(28 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: prt1_m_p0.a, b
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Hash
                           ->  Result
                                 One-Time Filter: false
               ->  Hash Left Join
                     Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Hash
                           ->  Result
                                 One-Time Filter: false
               ->  Hash Right Join
                     Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
                     ->  Seq Scan on prt2_m_p2
                           Filter: (b > 250)
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2
                                 Filter: ((a < 450) AND (c = 0))
               ->  Nested Loop Left Join
                     Join Filter: ((prt1_m_p4.a = prt2_m_p4.b) AND (prt1_m_p4.b = prt2_m_p4.a))
                     ->  Seq Scan on prt1_m_p4
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt2_m_p4
                           Filter: (b > 250)
(31 rows)

SELECT DISTINCT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -210 |    
 -200 |    
 -150 |    
 -140 |    
 -100 |    
  -70 |    
  -50 |    
    0 |    
   50 |    
   70 |    
  100 |    
  140 |    
  150 |    
  200 |    
  210 |    
  250 |    
  280 |    
  300 | 300
  350 |    
  400 |    
  420 | 420
(22 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b, t3.a, t3.b
         ->  Hash Right Join
               Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b, t3.a, t3.b
         ->  Hash Right Join
               Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Append
               ->  Hash Semi Join
                     Hash Cond: ((t1.a = t1_5.b) AND (t1.b = t1_5.a))
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t1_5.b = t1_10.a) AND (t1_5.a = t1_10.b))
                                 ->  Seq Scan on prt2_m_p0 t1_5
                                 ->  Hash
                                       ->  HashAggregate
                                             Group Key: t1_10.a, t1_10.b
                                             ->  Seq Scan on prt1_m_p0 t1_10
               ->  Hash Semi Join
                     Hash Cond: ((t1_1.a = t1_6.b) AND (t1_1.b = t1_6.a))
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t1_6.b = t1_11.a) AND (t1_6.a = t1_11.b))
                                 ->  Seq Scan on prt2_m_p1 t1_6
                                 ->  Hash
                                       ->  HashAggregate
                                             Group Key: t1_11.a, t1_11.b
                                             ->  Seq Scan on prt1_m_p1 t1_11
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.a = t1_7.b) AND (t1_2.b = t1_7.a))
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t1_7.b = t1_12.a) AND (t1_7.a = t1_12.b))
                                 ->  Seq Scan on prt2_m_p2 t1_7
                                 ->  Hash
                                       ->  HashAggregate
                                             Group Key: t1_12.a, t1_12.b
                                             ->  Seq Scan on prt1_m_p2 t1_12
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.a = t1_8.b) AND (t1_3.b = t1_8.a))
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t1_8.b = t1_13.a) AND (t1_8.a = t1_13.b))
                                 ->  Seq Scan on prt2_m_p3 t1_8
                                 ->  Hash
                                       ->  HashAggregate
                                             Group Key: t1_13.a, t1_13.b
                                             ->  Seq Scan on prt1_m_p3 t1_13
               ->  Nested Loop Semi Join
                     Join Filter: ((t1_4.a = t1_9.b) AND (t1_4.b = t1_9.a))
                     ->  Seq Scan on prt1_m_p4 t1_4
                           Filter: (c = 0)
                     ->  Materialize
                           ->  Hash Semi Join
                                 Hash Cond: ((t1_9.b = t1_14.a) AND (t1_9.a = t1_14.b))
                                 ->  Seq Scan on prt2_m_p4 t1_9
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_14
(62 rows)

SELECT DISTINCT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -210 | -210 | 0
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  210 |  210 | 0
  300 |  300 | 0
  420 |  420 | 0
  450 |  450 | 0
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, t1.b, t2.a, t3.a, t3.b
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_4.a = t2_4.b) AND (t3_4.b = t2_4.a))
                     ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(54 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -250 | -250 |      |      |      |     
 -210 | -210 | -210 | -210 | -210 | -210
 -200 | -200 |      |      |      |     
 -150 | -150 | -150 | -150 | -150 | -150
 -140 | -140 |      |      |      |     
 -100 | -100 |      |      |      |     
  -70 |  -70 |      |      |      |     
  -50 |  -50 |      |      |      |     
    0 |    0 |    0 |    0 |    0 |    0
   50 |   50 |      |      |      |     
   70 |   70 |      |      |      |     
  100 |  100 |      |      |      |     
  140 |  140 |      |      |      |     
  150 |  150 |  150 |  150 |  150 |  150
  200 |  200 |      |      |      |     
  210 |  210 |  210 |  210 |  210 |  210
  250 |  250 |      |      |      |     
  280 |  280 |      |      |      |     
  300 |  300 |  300 |  300 |  300 |  300
  350 |  350 |      |      |      |     
  400 |  400 |      |      |      |     
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
  490 |  490 |      |      |      |     
  500 |  500 |      |      |      |     
  550 |  550 |      |      |      |     
  560 |  560 |      |      |      |     
      |  600 |      |      |      |     
      |  650 |      |      |      |     
(29 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, t1.b, t2.a, t3.a, t3.b
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_4.a = t2_4.b) AND (t3_4.b = t2_4.a))
                     ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(54 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -250 | -250 |      |      |      |     
 -210 | -210 | -210 | -210 | -210 | -210
 -200 | -200 |      |      |      |     
 -150 | -150 | -150 | -150 | -150 | -150
 -140 | -140 |      |      |      |     
 -100 | -100 |      |      |      |     
  -70 |  -70 |      |      |      |     
  -50 |  -50 |      |      |      |     
    0 |    0 |    0 |    0 |    0 |    0
   50 |   50 |      |      |      |     
   70 |   70 |      |      |      |     
  100 |  100 |      |      |      |     
  140 |  140 |      |      |      |     
  150 |  150 |  150 |  150 |  150 |  150
  200 |  200 |      |      |      |     
  210 |  210 |  210 |  210 |  210 |  210
  250 |  250 |      |      |      |     
  280 |  280 |      |      |      |     
  300 |  300 |  300 |  300 |  300 |  300
  350 |  350 |      |      |      |     
  400 |  400 |      |      |      |     
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
  490 |  490 |      |      |      |     
  500 |  500 |      |      |      |     
  550 |  550 |      |      |      |     
  560 |  560 |      |      |      |     
      |  600 |      |      |      |     
      |  650 |      |      |      |     
(29 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b, t3.a, t3.b
         ->  Hash Right Join
               Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b, t3.a, t3.b
         ->  Hash Right Join
               Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, t1.b, t2.a, t3.a, t3.b
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_4.a = t2_4.b) AND (t3_4.b = t2_4.a))
                     ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(54 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -250 | -250 |      |      |      |     
 -210 | -210 | -210 | -210 | -210 | -210
 -200 | -200 |      |      |      |     
 -150 | -150 | -150 | -150 | -150 | -150
 -140 | -140 |      |      |      |     
 -100 | -100 |      |      |      |     
  -70 |  -70 |      |      |      |     
  -50 |  -50 |      |      |      |     
    0 |    0 |    0 |    0 |    0 |    0
   50 |   50 |      |      |      |     
   70 |   70 |      |      |      |     
  100 |  100 |      |      |      |     
  140 |  140 |      |      |      |     
  150 |  150 |  150 |  150 |  150 |  150
  200 |  200 |      |      |      |     
  210 |  210 |  210 |  210 |  210 |  210
  250 |  250 |      |      |      |     
  280 |  280 |      |      |      |     
  300 |  300 |  300 |  300 |  300 |  300
  350 |  350 |      |      |      |     
  400 |  400 |      |      |      |     
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
  490 |  490 |      |      |      |     
  500 |  500 |      |      |      |     
  550 |  550 |      |      |      |     
  560 |  560 |      |      |      |     
      |  600 |      |      |      |     
      |  650 |      |      |      |     
(29 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t1.b
         ->  Hash Join
               Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Seq Scan on prt1_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(43 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -210 | -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t2.b, t1.b, t2.a, t3.a, t3.b
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_4.a = t2_4.b) AND (t3_4.b = t2_4.a))
                     ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                 ->  Seq Scan on prt2_m_p4 t2_4
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p4 t1_4
                                             Filter: (c = 0)
(54 rows)

SELECT DISTINCT t1.a, t1.b, t2.a, t2.b, t3.a, t3.b FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  a   |  b   |  a   |  b   
------+------+------+------+------+------
 -250 | -250 |      |      |      |     
 -210 | -210 | -210 | -210 | -210 | -210
 -200 | -200 |      |      |      |     
 -150 | -150 | -150 | -150 | -150 | -150
 -140 | -140 |      |      |      |     
 -100 | -100 |      |      |      |     
  -70 |  -70 |      |      |      |     
  -50 |  -50 |      |      |      |     
    0 |    0 |    0 |    0 |    0 |    0
   50 |   50 |      |      |      |     
   70 |   70 |      |      |      |     
  100 |  100 |      |      |      |     
  140 |  140 |      |      |      |     
  150 |  150 |  150 |  150 |  150 |  150
  200 |  200 |      |      |      |     
  210 |  210 |  210 |  210 |  210 |  210
  250 |  250 |      |      |      |     
  280 |  280 |      |      |      |     
  300 |  300 |  300 |  300 |  300 |  300
  350 |  350 |      |      |      |     
  400 |  400 |      |      |      |     
  420 |  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450 |  450
  490 |  490 |      |      |      |     
  500 |  500 |      |      |      |     
  550 |  550 |      |      |      |     
  560 |  560 |      |      |      |     
      |  600 |      |      |      |     
      |  650 |      |      |      |     
(29 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t3.b
         ->  Hash Join
               Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t5
                     ->  Seq Scan on prt1_m_p1 t5_1
                     ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Seq Scan on prt1_m_p3 t5_3
                     ->  Seq Scan on prt1_m_p4 t5_4
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t3
                                 ->  Seq Scan on prt1_m_p1 t3_1
                                 ->  Seq Scan on prt1_m_p2 t3_2
                                 ->  Seq Scan on prt1_m_p3 t3_3
                                 ->  Seq Scan on prt1_m_p4 t3_4
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Append
                                             ->  Seq Scan on prt2_m_p0 t4
                                             ->  Seq Scan on prt2_m_p1 t4_1
                                             ->  Seq Scan on prt2_m_p2 t4_2
                                             ->  Seq Scan on prt2_m_p3 t4_3
                                             ->  Seq Scan on prt2_m_p4 t4_4
                                       ->  Hash
                                             ->  Append
                                                   ->  Hash Join
                                                         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                         ->  Seq Scan on prt2_m_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p0 t1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                         ->  Seq Scan on prt2_m_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p1 t1_1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                         ->  Seq Scan on prt2_m_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p2 t1_2
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                                         ->  Seq Scan on prt2_m_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p3 t1_3
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                                         ->  Seq Scan on prt2_m_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p4 t1_4
                                                                     Filter: (c = 0)
(61 rows)

SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  b   |  a   |  a   
------+------+------+------+------
 -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t3.b
         ->  Hash Join
               Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t5
                     ->  Seq Scan on prt1_m_p1 t5_1
                     ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Seq Scan on prt1_m_p3 t5_3
                     ->  Seq Scan on prt1_m_p4 t5_4
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t3
                                 ->  Seq Scan on prt1_m_p1 t3_1
                                 ->  Seq Scan on prt1_m_p2 t3_2
                                 ->  Seq Scan on prt1_m_p3 t3_3
                                 ->  Seq Scan on prt1_m_p4 t3_4
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Append
                                             ->  Seq Scan on prt2_m_p0 t4
                                             ->  Seq Scan on prt2_m_p1 t4_1
                                             ->  Seq Scan on prt2_m_p2 t4_2
                                             ->  Seq Scan on prt2_m_p3 t4_3
                                             ->  Seq Scan on prt2_m_p4 t4_4
                                       ->  Hash
                                             ->  Append
                                                   ->  Hash Join
                                                         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                         ->  Seq Scan on prt2_m_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p0 t1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                         ->  Seq Scan on prt2_m_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p1 t1_1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                         ->  Seq Scan on prt2_m_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p2 t1_2
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                                         ->  Seq Scan on prt2_m_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p3 t1_3
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                                         ->  Seq Scan on prt2_m_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p4 t1_4
                                                                     Filter: (c = 0)
(61 rows)

SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  b   |  a   |  a   
------+------+------+------+------
 -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t3.b
         ->  Hash Join
               Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t5
                     ->  Seq Scan on prt1_m_p1 t5_1
                     ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Seq Scan on prt1_m_p3 t5_3
                     ->  Seq Scan on prt1_m_p4 t5_4
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t3
                                 ->  Seq Scan on prt1_m_p1 t3_1
                                 ->  Seq Scan on prt1_m_p2 t3_2
                                 ->  Seq Scan on prt1_m_p3 t3_3
                                 ->  Seq Scan on prt1_m_p4 t3_4
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Append
                                             ->  Seq Scan on prt2_m_p0 t4
                                             ->  Seq Scan on prt2_m_p1 t4_1
                                             ->  Seq Scan on prt2_m_p2 t4_2
                                             ->  Seq Scan on prt2_m_p3 t4_3
                                             ->  Seq Scan on prt2_m_p4 t4_4
                                       ->  Hash
                                             ->  Append
                                                   ->  Hash Join
                                                         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                         ->  Seq Scan on prt2_m_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p0 t1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                         ->  Seq Scan on prt2_m_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p1 t1_1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                         ->  Seq Scan on prt2_m_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p2 t1_2
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                                         ->  Seq Scan on prt2_m_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p3 t1_3
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                                         ->  Seq Scan on prt2_m_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p4 t1_4
                                                                     Filter: (c = 0)
(61 rows)

SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  b   |  a   |  a   
------+------+------+------+------
 -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t3.b, t5.a
         ->  Hash Right Join
               Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t5
                     ->  Seq Scan on prt1_m_p1 t5_1
                     ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Seq Scan on prt1_m_p3 t5_3
                     ->  Seq Scan on prt1_m_p4 t5_4
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t3
                                 ->  Seq Scan on prt1_m_p1 t3_1
                                 ->  Seq Scan on prt1_m_p2 t3_2
                                 ->  Seq Scan on prt1_m_p3 t3_3
                                 ->  Seq Scan on prt1_m_p4 t3_4
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Append
                                             ->  Seq Scan on prt2_m_p0 t4
                                             ->  Seq Scan on prt2_m_p1 t4_1
                                             ->  Seq Scan on prt2_m_p2 t4_2
                                             ->  Seq Scan on prt2_m_p3 t4_3
                                             ->  Seq Scan on prt2_m_p4 t4_4
                                       ->  Hash
                                             ->  Append
                                                   ->  Hash Join
                                                         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                         ->  Seq Scan on prt2_m_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p0 t1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                         ->  Seq Scan on prt2_m_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p1 t1_1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                         ->  Seq Scan on prt2_m_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p2 t1_2
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                                         ->  Seq Scan on prt2_m_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p3 t1_3
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                                         ->  Seq Scan on prt2_m_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p4 t1_4
                                                                     Filter: (c = 0)
(61 rows)

SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  b   |  a   |  a   
------+------+------+------+------
 -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450
(8 rows)

EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: t1.a, t3.b
         ->  Hash Join
               Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t5
                     ->  Seq Scan on prt1_m_p1 t5_1
                     ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Seq Scan on prt1_m_p3 t5_3
                     ->  Seq Scan on prt1_m_p4 t5_4
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t3
                                 ->  Seq Scan on prt1_m_p1 t3_1
                                 ->  Seq Scan on prt1_m_p2 t3_2
                                 ->  Seq Scan on prt1_m_p3 t3_3
                                 ->  Seq Scan on prt1_m_p4 t3_4
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Append
                                             ->  Seq Scan on prt2_m_p0 t4
                                             ->  Seq Scan on prt2_m_p1 t4_1
                                             ->  Seq Scan on prt2_m_p2 t4_2
                                             ->  Seq Scan on prt2_m_p3 t4_3
                                             ->  Seq Scan on prt2_m_p4 t4_4
                                       ->  Hash
                                             ->  Append
                                                   ->  Hash Join
                                                         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                         ->  Seq Scan on prt2_m_p0 t2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p0 t1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                         ->  Seq Scan on prt2_m_p1 t2_1
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p1 t1_1
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                         ->  Seq Scan on prt2_m_p2 t2_2
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p2 t1_2
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                                         ->  Seq Scan on prt2_m_p3 t2_3
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p3 t1_3
                                                                     Filter: (c = 0)
                                                   ->  Hash Join
                                                         Hash Cond: ((t2_4.b = t1_4.a) AND (t2_4.a = t1_4.b))
                                                         ->  Seq Scan on prt2_m_p4 t2_4
                                                         ->  Hash
                                                               ->  Seq Scan on prt1_m_p4 t1_4
                                                                     Filter: (c = 0)
(61 rows)

SELECT DISTINCT t1.a, t2.b, t3.b, t4.a, t5.a FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b   |  b   |  a   |  a   
------+------+------+------+------
 -210 | -210 | -210 | -210 | -210
 -150 | -150 | -150 | -150 | -150
    0 |    0 |    0 |    0 |    0
  150 |  150 |  150 |  150 |  150
  210 |  210 |  210 |  210 |  210
  300 |  300 |  300 |  300 |  300
  420 |  420 |  420 |  420 |  420
  450 |  450 |  450 |  450 |  450
(8 rows)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
-- prt2_m have extra partition which is default partition 
-- pwj is possible when default partition is outer side of relation.
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt1_m_p1 PARTITION OF prt1_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m FOR VALUES FROM (250,250) TO (500,500);
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-250, 499) i WHERE i % 2 = 0;
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt2_m_p1 PARTITION OF prt2_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt2_m_p3 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-250, 599) i WHERE i % 3 = 0;
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
               ->  Seq Scan on prt2_m_p0 t2
               ->  Hash
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
         ->  Hash Join
               Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Hash
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
         ->  Hash Join
               Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Hash
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p0 t1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_m_p1 t1_1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t1_2
                                 Filter: (c = 0)
(22 rows)

SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
      t1       |      t2       
---------------+---------------
 (-250,-250,0) | 
 (-200,-200,0) | 
 (-150,-150,0) | (-150,-150,0)
 (-100,-100,0) | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
 (50,50,0)     | 
 (100,100,0)   | 
 (150,150,0)   | (150,150,0)
 (200,200,0)   | 
 (250,250,0)   | 
 (300,300,0)   | (300,300,0)
 (350,350,0)   | 
 (400,400,0)   | 
 (450,450,0)   | (450,450,0)
(15 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Seq Scan on prt1_m_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3 t2_3
                           Filter: (c = 0)
(18 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
      |   | -225 | 0
      |   |  -75 | 0
      |   |   75 | 0
      |   |  225 | 0
      |   |  375 | 0
      |   |  525 | 0
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Full Join
         Hash Cond: ((prt1_m_p0.a = prt2_m_p0.b) AND (prt1_m_p0.b = prt2_m_p0.a))
         Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3
                           Filter: (c = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  | c | b  | c 
----+---+----+---
 50 | 0 |    |  
    |   | 75 | 0
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
               ->  Seq Scan on prt2_m_p2 t2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2 t1
                           Filter: ((a < 450) AND (c = 0))
(10 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
  a  | c |  b  | c 
-----+---+-----+---
 300 | 0 | 300 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
               ->  Seq Scan on prt1_m_p0
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
               ->  Seq Scan on prt1_m_p1
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b  | c 
------+---+-----+---
 -250 | 0 |     |  
 -200 | 0 |     |  
 -150 | 0 |     |  
 -100 | 0 |     |  
  -50 | 0 |     |  
    0 | 0 |     |  
   50 | 0 |     |  
  100 | 0 |     |  
  150 | 0 |     |  
  200 | 0 |     |  
  250 | 0 |     |  
  300 | 0 | 300 | 0
  350 | 0 |     |  
  400 | 0 |     |  
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
(24 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
               ->  Seq Scan on prt2_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p0 t2
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_1.b = t2_1.a) AND (t1_1.a = t2_1.b))
               ->  Seq Scan on prt2_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p1 t2_1
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_2.b = t2_2.a) AND (t1_2.a = t2_2.b))
               ->  Seq Scan on prt2_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2 t2_2
                           Filter: (c = 0)
(24 rows)

SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
                             QUERY PLAN                             
--------------------------------------------------------------------
 Aggregate
   ->  Append
         ->  Hash Anti Join
               Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
               ->  Seq Scan on prt1_m_p0 t1
               ->  Hash
                     ->  Seq Scan on prt2_m_p0 t2
         ->  Hash Anti Join
               Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Hash
                     ->  Seq Scan on prt2_m_p1 t2_1
         ->  Hash Anti Join
               Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
               ->  Seq Scan on prt1_m_p2 t1_2
               ->  Hash
                     ->  Seq Scan on prt2_m_p2 t2_2
(17 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
  sum  |         avg          |  sum  |         avg          
-------+----------------------+-------+----------------------
 30750 | 123.0000000000000000 | 30750 | 123.0000000000000000
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
                        QUERY PLAN                        
----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t3
                     ->  Seq Scan on prt2_m_p1 t3_1
                     ->  Seq Scan on prt2_m_p2 t3_2
                     ->  Seq Scan on prt2_m_p3 t3_3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p2 t2_2
                                 Filter: (t1.a = a)
(25 rows)

SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
  a   |  b   | c | t2a  | t3a  | least 
------+------+---+------+------+-------
 -250 | -250 | 0 |      |      |      
 -200 | -200 | 0 |      |      |      
 -150 | -150 | 0 | -150 | -150 |  -150
 -100 | -100 | 0 |      |      |      
  -50 |  -50 | 0 |      |      |      
    0 |    0 | 0 |    0 |    0 |     0
   50 |   50 | 0 |      |      |      
  100 |  100 | 0 |      |      |      
  150 |  150 | 0 |  150 |  150 |   150
  200 |  200 | 0 |      |      |      
  250 |  250 | 0 |      |      |      
  300 |  300 | 0 |  300 |  300 |   300
  350 |  350 | 0 |      |      |      
  400 |  400 | 0 |      |      |      
  450 |  450 | 0 |  450 |  450 |   450
(15 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
               ->  Seq Scan on prt1_m_p0
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
               ->  Seq Scan on prt1_m_p1
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(24 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.a = t1_3.b) AND (t1.b = t1_3.a))
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_3.b = t1_6.a) AND (t1_3.a = t1_6.b))
                           ->  Seq Scan on prt2_m_p0 t1_3
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1_6
         ->  Hash Semi Join
               Hash Cond: ((t1_1.a = t1_4.b) AND (t1_1.b = t1_4.a))
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_4.b = t1_7.a) AND (t1_4.a = t1_7.b))
                           ->  Seq Scan on prt2_m_p1 t1_4
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_7
         ->  Hash Semi Join
               Hash Cond: ((t1_2.a = t1_5.b) AND (t1_2.b = t1_5.a))
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_5.b = t1_8.a) AND (t1_5.a = t1_8.b))
                           ->  Seq Scan on prt2_m_p2 t1_5
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_8
(33 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_1.b = t1_1.a) AND (t4_1.a = t1_1.b))
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_2.b = t1_2.a) AND (t4_2.a = t1_2.b))
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(47 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_1.b = t1_1.a) AND (t4_1.a = t1_1.b))
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_2.b = t1_2.a) AND (t4_2.a = t1_2.b))
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(47 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_1.b = t1_1.a) AND (t4_1.a = t1_1.b))
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_2.b = t1_2.a) AND (t4_2.a = t1_2.b))
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(47 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_1.b = t1_1.a) AND (t4_1.a = t1_1.b))
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_2.b = t1_2.a) AND (t4_2.a = t1_2.b))
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(47 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Hash Join
                                       Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_1.b = t1_1.a) AND (t4_1.a = t1_1.b))
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                 ->  Hash Join
                                       Hash Cond: ((t4_2.b = t1_2.a) AND (t4_2.a = t1_2.b))
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Hash
                                             ->  Hash Join
                                                   Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Hash
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(47 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
-- prt2_m default partition and prt1_m have 500-600 extra range 
-- pwj is possible when default partition is outer side of relation. - ??
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt1_m_p1 PARTITION OF prt1_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt1_m_p3 PARTITION OF prt1_m FOR VALUES FROM (500,500) TO (600,600);
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-250, 599) i WHERE i % 2 = 0;
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt2_m_p1 PARTITION OF prt2_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt2_m_p3 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-250, 599) i WHERE i % 3 = 0;
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p3 t2_3
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p0 t1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_m_p1 t1_1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_m_p2 t1_2
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                     ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_m_p3 t1_3
                                 Filter: (c = 0)
(28 rows)

SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
      t1       |      t2       
---------------+---------------
 (-250,-250,0) | 
 (-200,-200,0) | 
 (-150,-150,0) | (-150,-150,0)
 (-100,-100,0) | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
 (50,50,0)     | 
 (100,100,0)   | 
 (150,150,0)   | (150,150,0)
 (200,200,0)   | 
 (250,250,0)   | 
 (300,300,0)   | (300,300,0)
 (350,350,0)   | 
 (400,400,0)   | 
 (450,450,0)   | (450,450,0)
 (500,500,0)   | 
 (550,550,0)   | 
(17 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t1
                     ->  Hash
                           ->  Seq Scan on prt2_m_p0 t2
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t1_1
                     ->  Hash
                           ->  Seq Scan on prt2_m_p1 t2_1
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t1_2
                     ->  Hash
                           ->  Seq Scan on prt2_m_p2 t2_2
                                 Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t1_3
                     ->  Hash
                           ->  Seq Scan on prt2_m_p3 t2_3
                                 Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
      |   | -225 | 0
      |   |  -75 | 0
      |   |   75 | 0
      |   |  225 | 0
      |   |  375 | 0
      |   |  525 | 0
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Full Join
         Hash Cond: ((prt1_m_p0.a = prt2_m_p0.b) AND (prt1_m_p0.b = prt2_m_p0.a))
         Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3
                           Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  | c | b  | c 
----+---+----+---
 50 | 0 |    |  
    |   | 75 | 0
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
               ->  Seq Scan on prt2_m_p2 t2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2 t1
                           Filter: ((a < 450) AND (c = 0))
(10 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
  a  | c |  b  | c 
-----+---+-----+---
 300 | 0 | 300 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
               ->  Seq Scan on prt1_m_p0
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
               ->  Seq Scan on prt1_m_p1
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b  | c 
------+---+-----+---
 -250 | 0 |     |  
 -200 | 0 |     |  
 -150 | 0 |     |  
 -100 | 0 |     |  
  -50 | 0 |     |  
    0 | 0 |     |  
   50 | 0 |     |  
  100 | 0 |     |  
  150 | 0 |     |  
  200 | 0 |     |  
  250 | 0 |     |  
  300 | 0 | 300 | 0
  350 | 0 |     |  
  400 | 0 |     |  
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                              QUERY PLAN                              
----------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
               ->  Materialize
                     ->  Seq Scan on prt2_m_p3 t2_3
                           Filter: (c = 0)
(31 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                              QUERY PLAN                              
----------------------------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
               ->  Seq Scan on prt2_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p0 t2
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_1.b = t2_1.a) AND (t1_1.a = t2_1.b))
               ->  Seq Scan on prt2_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p1 t2_1
                           Filter: (c = 0)
         ->  Hash Semi Join
               Hash Cond: ((t1_2.b = t2_2.a) AND (t1_2.a = t2_2.b))
               ->  Seq Scan on prt2_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2 t2_2
                           Filter: (c = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_3.b = t2_3.a) AND (t1_3.a = t2_3.b))
               ->  Seq Scan on prt2_m_p3 t1_3
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3 t2_3
                     Filter: (c = 0)
(30 rows)

SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
                             QUERY PLAN                             
--------------------------------------------------------------------
 Aggregate
   ->  Append
         ->  Hash Anti Join
               Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
               ->  Seq Scan on prt1_m_p0 t1
               ->  Hash
                     ->  Seq Scan on prt2_m_p0 t2
         ->  Hash Anti Join
               Hash Cond: ((t1_1.a = t2_1.b) AND (t1_1.b = t2_1.a))
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Hash
                     ->  Seq Scan on prt2_m_p1 t2_1
         ->  Hash Anti Join
               Hash Cond: ((t1_2.a = t2_2.b) AND (t1_2.b = t2_2.a))
               ->  Seq Scan on prt1_m_p2 t1_2
               ->  Hash
                     ->  Seq Scan on prt2_m_p2 t2_2
         ->  Hash Anti Join
               Hash Cond: ((t1_3.a = t2_3.b) AND (t1_3.b = t2_3.a))
               ->  Seq Scan on prt1_m_p3 t1_3
               ->  Hash
                     ->  Seq Scan on prt2_m_p3 t2_3
(22 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
  sum  |         avg          |  sum  |         avg          
-------+----------------------+-------+----------------------
 49416 | 174.0000000000000000 | 49416 | 174.0000000000000000
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
                        QUERY PLAN                        
----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t3
                     ->  Seq Scan on prt2_m_p1 t3_1
                     ->  Seq Scan on prt2_m_p2 t3_2
                     ->  Seq Scan on prt2_m_p3 t3_3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p2 t2_2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p3 t2_3
                                 Filter: (t1.a = a)
(29 rows)

SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
  a   |  b   | c | t2a  | t3a  | least 
------+------+---+------+------+-------
 -250 | -250 | 0 |      |      |      
 -200 | -200 | 0 |      |      |      
 -150 | -150 | 0 | -150 | -150 |  -150
 -100 | -100 | 0 |      |      |      
  -50 |  -50 | 0 |      |      |      
    0 |    0 | 0 |    0 |    0 |     0
   50 |   50 | 0 |      |      |      
  100 |  100 | 0 |      |      |      
  150 |  150 | 0 |  150 |  150 |   150
  200 |  200 | 0 |      |      |      
  250 |  250 | 0 |      |      |      
  300 |  300 | 0 |  300 |  300 |   300
  350 |  350 | 0 |      |      |      
  400 |  400 | 0 |      |      |      
  450 |  450 | 0 |  450 |  450 |   450
  500 |  500 | 0 |      |      |      
  550 |  550 | 0 |      |      |      
(17 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, b
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p0.a = b) AND (prt1_m_p0.b = a))
               ->  Seq Scan on prt1_m_p0
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Left Join
               Hash Cond: ((prt1_m_p1.a = b) AND (prt1_m_p1.b = a))
               ->  Seq Scan on prt1_m_p1
                     Filter: ((a < 450) AND (c = 0))
               ->  Hash
                     ->  Result
                           One-Time Filter: false
         ->  Hash Right Join
               Hash Cond: ((prt2_m_p2.b = prt1_m_p2.a) AND (prt2_m_p2.a = prt1_m_p2.b))
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Hash
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(24 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Semi Join
               Hash Cond: ((t1.a = t1_4.b) AND (t1.b = t1_4.a))
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_4.b = t1_8.a) AND (t1_4.a = t1_8.b))
                           ->  Seq Scan on prt2_m_p0 t1_4
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p0 t1_8
         ->  Hash Semi Join
               Hash Cond: ((t1_1.a = t1_5.b) AND (t1_1.b = t1_5.a))
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_5.b = t1_9.a) AND (t1_5.a = t1_9.b))
                           ->  Seq Scan on prt2_m_p1 t1_5
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p1 t1_9
         ->  Hash Semi Join
               Hash Cond: ((t1_2.a = t1_6.b) AND (t1_2.b = t1_6.a))
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_6.b = t1_10.a) AND (t1_6.a = t1_10.b))
                           ->  Seq Scan on prt2_m_p2 t1_6
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p2 t1_10
         ->  Hash Semi Join
               Hash Cond: ((t1_3.a = t1_7.b) AND (t1_3.b = t1_7.a))
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
               ->  Hash
                     ->  Hash Semi Join
                           Hash Cond: ((t1_7.b = t1_11.a) AND (t1_7.a = t1_11.b))
                           ->  Seq Scan on prt2_m_p3 t1_7
                           ->  Hash
                                 ->  Seq Scan on prt1_m_p3 t1_11
(43 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
(27 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
                     ->  Seq Scan on prt1_m_p0 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                 ->  Seq Scan on prt2_m_p0 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p0 t1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (t3_1.b = t2_1.a))
                     ->  Seq Scan on prt1_m_p1 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND (t2_1.a = t1_1.b))
                                 ->  Seq Scan on prt2_m_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p1 t1_1
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (t3_2.b = t2_2.a))
                     ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND (t2_2.a = t1_2.b))
                                 ->  Seq Scan on prt2_m_p2 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p2 t1_2
                                             Filter: (c = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_3.a = t2_3.b) AND (t3_3.b = t2_3.a))
                     ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_3.b = t1_3.a) AND (t2_3.a = t1_3.b))
                                 ->  Seq Scan on prt2_m_p3 t2_3
                                 ->  Hash
                                       ->  Seq Scan on prt1_m_p3 t1_3
                                             Filter: (c = 0)
(44 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
(17 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
-- prt2_m default partition and have gaps in range 
-- pwj is not possible as one partition need to join with more than one partition.
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (-250,-250) TO (0,0);
CREATE TABLE prt1_m_p1 PARTITION OF prt1_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m FOR VALUES FROM (250,250) TO (500,500);
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-250, 499) i WHERE i % 2 = 0;
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (-250,-250) TO (0,0);
CREATE TABLE prt2_m_p1 PARTITION OF prt2_m FOR VALUES FROM (50,50) TO (200,200);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt2_m_p4 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-250, 799) i WHERE i % 3 = 0 AND (i NOT BETWEEN 0 AND 50 OR i NOT BETWEEN 200 AND 250);
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
(5 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
(17 rows)

SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
      t1       |      t2       
---------------+---------------
 (-250,-250,0) | 
 (-200,-200,0) | 
 (-150,-150,0) | (-150,-150,0)
 (-100,-100,0) | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
 (50,50,0)     | 
 (100,100,0)   | 
 (150,150,0)   | (150,150,0)
 (200,200,0)   | 
 (250,250,0)   | 
 (300,300,0)   | (300,300,0)
 (350,350,0)   | 
 (400,400,0)   | 
 (450,450,0)   | (450,450,0)
(15 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Seq Scan on prt1_m_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p4 t2_3
                           Filter: (c = 0)
(18 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
      |   | -225 | 0
      |   |  -75 | 0
      |   |   75 | 0
      |   |  225 | 0
      |   |  375 | 0
      |   |  525 | 0
      |   |  600 | 0
      |   |  675 | 0
      |   |  750 | 0
(14 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Full Join
         Hash Cond: ((prt2_m_p0.b = prt1_m_p0.a) AND (prt2_m_p0.a = prt1_m_p0.b))
         Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p2
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p4
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2
                           Filter: (c = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  | c | b  | c 
----+---+----+---
 50 | 0 |    |  
    |   | 75 | 0
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2 t2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4 t2_1
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: ((a < 450) AND (c = 0))
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
  a  | c |  b  | c 
-----+---+-----+---
 300 | 0 | 300 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p2.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p2.b = prt1_m_p0.a) AND (prt2_m_p2.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b  | c 
------+---+-----+---
 -250 | 0 |     |  
 -200 | 0 |     |  
 -150 | 0 |     |  
 -100 | 0 |     |  
  -50 | 0 |     |  
    0 | 0 |     |  
   50 | 0 |     |  
  100 | 0 |     |  
  150 | 0 |     |  
  200 | 0 |     |  
  250 | 0 |     |  
  300 | 0 | 300 | 0
  350 | 0 |     |  
  400 | 0 |     |  
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p4 t2_3
                           Filter: (c = 0)
(21 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                   QUERY PLAN                    
-------------------------------------------------
 Merge Semi Join
   Merge Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
   ->  Sort
         Sort Key: t1.b, t1.a
         ->  Append
               ->  Seq Scan on prt2_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p4 t1_3
                     Filter: (c = 0)
   ->  Sort
         Sort Key: t2.a, t2.b
         ->  Append
               ->  Seq Scan on prt1_m_p0 t2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t2_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t2_2
                     Filter: (c = 0)
(22 rows)

SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
                      QUERY PLAN                      
------------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Seq Scan on prt1_m_p2 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Seq Scan on prt2_m_p4 t2_3
(13 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
  sum  |         avg          |  sum  |         avg          
-------+----------------------+-------+----------------------
 30750 | 123.0000000000000000 | 30750 | 123.0000000000000000
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
                        QUERY PLAN                        
----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t3
                     ->  Seq Scan on prt2_m_p1 t3_1
                     ->  Seq Scan on prt2_m_p2 t3_2
                     ->  Seq Scan on prt2_m_p4 t3_3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p2 t2_2
                                 Filter: (t1.a = a)
(25 rows)

SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
  a   |  b   | c | t2a  | t3a  | least 
------+------+---+------+------+-------
 -250 | -250 | 0 |      |      |      
 -200 | -200 | 0 |      |      |      
 -150 | -150 | 0 | -150 | -150 |  -150
 -100 | -100 | 0 |      |      |      
  -50 |  -50 | 0 |      |      |      
    0 |    0 | 0 |    0 |    0 |     0
   50 |   50 | 0 |      |      |      
  100 |  100 | 0 |      |      |      
  150 |  150 | 0 |  150 |  150 |   150
  200 |  200 | 0 |      |      |      
  250 |  250 | 0 |      |      |      
  300 |  300 | 0 |  300 |  300 |   300
  350 |  350 | 0 |      |      |      
  400 |  400 | 0 |      |      |      
  450 |  450 | 0 |  450 |  450 |   450
(15 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p2.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p2.b = prt1_m_p0.a) AND (prt2_m_p2.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(17 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t1_3.b) AND (t1.b = t1_3.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
         ->  Hash
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.b = t1_7.a) AND (t1_3.a = t1_7.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t1_3
                           ->  Seq Scan on prt2_m_p1 t1_4
                           ->  Seq Scan on prt2_m_p2 t1_5
                           ->  Seq Scan on prt2_m_p4 t1_6
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1_7
                                 ->  Seq Scan on prt1_m_p1 t1_8
                                 ->  Seq Scan on prt1_m_p2 t1_9
(24 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
(15 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t4
               ->  Seq Scan on prt2_m_p1 t4_1
               ->  Seq Scan on prt2_m_p2 t4_2
               ->  Seq Scan on prt2_m_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt1_m_p0 t5
                                       ->  Seq Scan on prt1_m_p1 t5_1
                                       ->  Seq Scan on prt1_m_p2 t5_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt1_m_p0 t3
                                                   ->  Seq Scan on prt1_m_p1 t3_1
                                                   ->  Seq Scan on prt1_m_p2 t3_2
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(39 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t4
               ->  Seq Scan on prt2_m_p1 t4_1
               ->  Seq Scan on prt2_m_p2 t4_2
               ->  Seq Scan on prt2_m_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt1_m_p0 t5
                                       ->  Seq Scan on prt1_m_p1 t5_1
                                       ->  Seq Scan on prt1_m_p2 t5_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt1_m_p0 t3
                                                   ->  Seq Scan on prt1_m_p1 t3_1
                                                   ->  Seq Scan on prt1_m_p2 t3_2
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(39 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t4
               ->  Seq Scan on prt2_m_p1 t4_1
               ->  Seq Scan on prt2_m_p2 t4_2
               ->  Seq Scan on prt2_m_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt1_m_p0 t5
                                       ->  Seq Scan on prt1_m_p1 t5_1
                                       ->  Seq Scan on prt1_m_p2 t5_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt1_m_p0 t3
                                                   ->  Seq Scan on prt1_m_p1 t3_1
                                                   ->  Seq Scan on prt1_m_p2 t3_2
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(39 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p4 t2_3
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t5
                           ->  Seq Scan on prt1_m_p1 t5_1
                           ->  Seq Scan on prt1_m_p2 t5_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p4 t4_3
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt1_m_p0 t3
                                                   ->  Seq Scan on prt1_m_p1 t3_1
                                                   ->  Seq Scan on prt1_m_p2 t3_2
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(39 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t4
               ->  Seq Scan on prt2_m_p1 t4_1
               ->  Seq Scan on prt2_m_p2 t4_2
               ->  Seq Scan on prt2_m_p4 t4_3
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p4 t2_3
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt1_m_p0 t5
                                       ->  Seq Scan on prt1_m_p1 t5_1
                                       ->  Seq Scan on prt1_m_p2 t5_2
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt1_m_p0 t3
                                                   ->  Seq Scan on prt1_m_p1 t3_1
                                                   ->  Seq Scan on prt1_m_p2 t3_2
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
(39 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
(5 rows)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
-- both partitions have gaps in range which filled by default partition of each other
-- Partition-wise join is not possible when one table need to join
-- with more than one table.
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt1_m_p1 PARTITION OF prt1_m FOR VALUES FROM (0,0) TO (250,250);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m FOR VALUES FROM (300,300) TO (450,450);
CREATE TABLE prt1_m_p3 PARTITION OF prt1_m FOR VALUES FROM (500,500) TO (600,600);
CREATE TABLE prt1_m_p4 PARTITION OF prt1_m DEFAULT;
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-250, 699) i WHERE i % 2 = 0 AND (i NOT BETWEEN 250 AND 300 OR i NOT BETWEEN 450 AND 500);
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (0,0);
CREATE TABLE prt2_m_p1 PARTITION OF prt2_m FOR VALUES FROM (50,50) TO (200,200);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m FOR VALUES FROM (250,250) TO (500,500);
CREATE TABLE prt2_m_p3 PARTITION OF prt2_m FOR VALUES FROM (550,550) TO (600,600);
CREATE TABLE prt2_m_p4 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-250, 699) i WHERE i % 3 = 0 AND (i NOT BETWEEN 0 AND 50 OR i NOT BETWEEN 200 AND 250 OR i NOT BETWEEN 500 AND 550);
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p3 t2_3
               ->  Seq Scan on prt2_m_p4 t2_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p4 t1_4
                           Filter: (c = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
  600 | 0 |  600 | 0
(6 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p1 t2_1
               ->  Seq Scan on prt2_m_p2 t2_2
               ->  Seq Scan on prt2_m_p3 t2_3
               ->  Seq Scan on prt2_m_p4 t2_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p3 t1_3
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p4 t1_4
                           Filter: (c = 0)
(22 rows)

SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
      t1       |      t2       
---------------+---------------
 (-250,-250,0) | 
 (-200,-200,0) | 
 (-150,-150,0) | (-150,-150,0)
 (-100,-100,0) | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
 (50,50,0)     | 
 (100,100,0)   | 
 (150,150,0)   | (150,150,0)
 (200,200,0)   | 
 (250,250,0)   | 
 (300,300,0)   | (300,300,0)
 (350,350,0)   | 
 (400,400,0)   | 
 (450,450,0)   | (450,450,0)
 (500,500,0)   | 
 (550,550,0)   | 
 (600,600,0)   | (600,600,0)
 (650,650,0)   | 
(19 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Seq Scan on prt1_m_p2 t1_2
               ->  Seq Scan on prt1_m_p3 t1_3
               ->  Seq Scan on prt1_m_p4 t1_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3 t2_3
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p4 t2_4
                           Filter: (c = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c 
------+---+------+---
 -150 | 0 | -150 | 0
    0 | 0 |    0 | 0
  150 | 0 |  150 | 0
  300 | 0 |  300 | 0
  450 | 0 |  450 | 0
  600 | 0 |  600 | 0
      |   | -225 | 0
      |   |  -75 | 0
      |   |   75 | 0
      |   |  225 | 0
      |   |  375 | 0
      |   |  525 | 0
      |   |  675 | 0
(13 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Full Join
         Hash Cond: ((prt1_m_p0.a = prt2_m_p0.b) AND (prt1_m_p0.b = prt2_m_p0.a))
         Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p4
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p4
                           Filter: (c = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a  | c | b  | c 
----+---+----+---
 50 | 0 |    |  
    |   | 75 | 0
(2 rows)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2 t2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p3 t2_1
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4 t2_2
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1 t1_1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2 t1_2
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p4 t1_3
                           Filter: ((a < 450) AND (c = 0))
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
  a  | c |  b  | c 
-----+---+-----+---
 300 | 0 | 300 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p2.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p2.b = prt1_m_p0.a) AND (prt2_m_p2.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p3
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p4
                           Filter: ((a < 450) AND (c = 0))
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b  | c 
------+---+-----+---
 -250 | 0 |     |  
 -200 | 0 |     |  
 -150 | 0 |     |  
 -100 | 0 |     |  
  -50 | 0 |     |  
    0 | 0 |     |  
   50 | 0 |     |  
  100 | 0 |     |  
  150 | 0 |     |  
  200 | 0 |     |  
  250 | 0 |     |  
  300 | 0 | 300 | 0
  350 | 0 |     |  
  400 | 0 |     |  
(14 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p4 t1_4
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p3 t2_3
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p4 t2_4
                           Filter: (c = 0)
(27 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
  600 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.b
   ->  Hash Semi Join
         Hash Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p3 t1_3
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p4 t1_4
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p1 t2_1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t2_2
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p3 t2_3
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p4 t2_4
                           Filter: (c = 0)
(27 rows)

SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
  600 |  600 | 0
(6 rows)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
                      QUERY PLAN                      
------------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p1 t1_1
               ->  Seq Scan on prt1_m_p2 t1_2
               ->  Seq Scan on prt1_m_p3 t1_3
               ->  Seq Scan on prt1_m_p4 t1_4
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Seq Scan on prt2_m_p1 t2_1
                     ->  Seq Scan on prt2_m_p2 t2_2
                     ->  Seq Scan on prt2_m_p3 t2_3
                     ->  Seq Scan on prt2_m_p4 t2_4
(16 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
  sum  |         avg          |  sum  |         avg          
-------+----------------------+-------+----------------------
 70850 | 223.5015772870662461 | 70850 | 223.5015772870662461
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
                        QUERY PLAN                        
----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p4 t1_4
                     Filter: (c = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t3
                     ->  Seq Scan on prt2_m_p1 t3_1
                     ->  Seq Scan on prt2_m_p2 t3_2
                     ->  Seq Scan on prt2_m_p3 t3_3
                     ->  Seq Scan on prt2_m_p4 t3_4
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p1 t2_1
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p2 t2_2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p3 t2_3
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p4 t2_4
                                 Filter: (t1.a = a)
(34 rows)

SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
  a   |  b   | c | t2a  | t3a  | least 
------+------+---+------+------+-------
 -250 | -250 | 0 |      |      |      
 -200 | -200 | 0 |      |      |      
 -150 | -150 | 0 | -150 | -150 |  -150
 -100 | -100 | 0 |      |      |      
  -50 |  -50 | 0 |      |      |      
    0 |    0 | 0 |    0 |    0 |     0
   50 |   50 | 0 |      |      |      
  100 |  100 | 0 |      |      |      
  150 |  150 | 0 |  150 |  150 |   150
  200 |  200 | 0 |      |      |      
  250 |  250 | 0 |      |      |      
  300 |  300 | 0 |  300 |  300 |   300
  350 |  350 | 0 |      |      |      
  400 |  400 | 0 |      |      |      
  450 |  450 | 0 |  450 |  450 |   450
  500 |  500 | 0 |      |      |      
  550 |  550 | 0 |      |      |      
  600 |  600 | 0 |  600 |  600 |   600
  650 |  650 | 0 |      |      |      
(19 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p2.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p2.b = prt1_m_p0.a) AND (prt2_m_p2.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p3
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p4
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p4
                           Filter: ((a < 450) AND (c = 0))
(21 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   |  b  
------+-----
 -250 |    
 -200 |    
 -150 |    
 -100 |    
  -50 |    
    0 |    
   50 |    
  100 |    
  150 |    
  200 |    
  250 |    
  300 | 300
  350 |    
  400 |    
(14 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t1_5.b) AND (t1.b = t1_5.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p1 t1_1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p3 t1_3
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p4 t1_4
                     Filter: (c = 0)
         ->  Hash
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.b = t1_10.a) AND (t1_5.a = t1_10.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t1_5
                           ->  Seq Scan on prt2_m_p1 t1_6
                           ->  Seq Scan on prt2_m_p2 t1_7
                           ->  Seq Scan on prt2_m_p3 t1_8
                           ->  Seq Scan on prt2_m_p4 t1_9
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1_10
                                 ->  Seq Scan on prt1_m_p1 t1_11
                                 ->  Seq Scan on prt1_m_p2 t1_12
                                 ->  Seq Scan on prt1_m_p3 t1_13
                                 ->  Seq Scan on prt1_m_p4 t1_14
(31 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
  a   |  b   | c 
------+------+---
 -150 | -150 | 0
    0 |    0 | 0
  150 |  150 | 0
  300 |  300 | 0
  450 |  450 | 0
  600 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
  600 | 0 |  600 | 0 |  600 | 0
  650 | 0 |      |   |      | 0
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
  600 | 0 |  600 | 0 |  600 | 0
  650 | 0 |      |   |      | 0
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
  600 | 0 |  600 | 0 |  600 | 0
  650 | 0 |      |   |      | 0
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p1 t3_1
               ->  Seq Scan on prt1_m_p2 t3_2
               ->  Seq Scan on prt1_m_p3 t3_3
               ->  Seq Scan on prt1_m_p4 t3_4
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p1 t2_1
                           ->  Seq Scan on prt2_m_p2 t2_2
                           ->  Seq Scan on prt2_m_p3 t2_3
                           ->  Seq Scan on prt2_m_p4 t2_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p1 t1_1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_2
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p3 t1_3
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p4 t1_4
                                       Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -250 | 0 |      |   |      | 0
 -200 | 0 |      |   |      | 0
 -150 | 0 | -150 | 0 | -150 | 0
 -100 | 0 |      |   |      | 0
  -50 | 0 |      |   |      | 0
    0 | 0 |    0 | 0 |    0 | 0
   50 | 0 |      |   |      | 0
  100 | 0 |      |   |      | 0
  150 | 0 |  150 | 0 |  150 | 0
  200 | 0 |      |   |      | 0
  250 | 0 |      |   |      | 0
  300 | 0 |  300 | 0 |  300 | 0
  350 | 0 |      |   |      | 0
  400 | 0 |      |   |      | 0
  450 | 0 |  450 | 0 |  450 | 0
  500 | 0 |      |   |      | 0
  550 | 0 |      |   |      | 0
  600 | 0 |  600 | 0 |  600 | 0
  650 | 0 |      |   |      | 0
(19 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
               ->  Seq Scan on prt1_m_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                           ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                       ->  Seq Scan on prt2_m_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                                   ->  Seq Scan on prt2_m_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p4 t1_4
                                                               Filter: (c = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
               ->  Seq Scan on prt1_m_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                           ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                       ->  Seq Scan on prt2_m_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                                   ->  Seq Scan on prt2_m_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p4 t1_4
                                                               Filter: (c = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
               ->  Seq Scan on prt1_m_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                           ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                       ->  Seq Scan on prt2_m_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                                   ->  Seq Scan on prt2_m_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p4 t1_4
                                                               Filter: (c = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
               ->  Seq Scan on prt1_m_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                           ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                       ->  Seq Scan on prt2_m_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                                   ->  Seq Scan on prt2_m_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p4 t1_4
                                                               Filter: (c = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p1 t5_1
               ->  Seq Scan on prt1_m_p2 t5_2
               ->  Seq Scan on prt1_m_p3 t5_3
               ->  Seq Scan on prt1_m_p4 t5_4
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p1 t3_1
                           ->  Seq Scan on prt1_m_p2 t3_2
                           ->  Seq Scan on prt1_m_p3 t3_3
                           ->  Seq Scan on prt1_m_p4 t3_4
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p1 t4_1
                                       ->  Seq Scan on prt2_m_p2 t4_2
                                       ->  Seq Scan on prt2_m_p3 t4_3
                                       ->  Seq Scan on prt2_m_p4 t4_4
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p1 t2_1
                                                   ->  Seq Scan on prt2_m_p2 t2_2
                                                   ->  Seq Scan on prt2_m_p3 t2_3
                                                   ->  Seq Scan on prt2_m_p4 t2_4
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p1 t1_1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_2
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p3 t1_3
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p4 t1_4
                                                               Filter: (c = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c |  b   | c |  a   | c 
------+---+------+---+------+---
 -150 | 0 | -150 | 0 | -150 | 0
    0 | 0 |    0 | 0 |    0 | 0
  150 | 0 |  150 | 0 |  150 | 0
  300 | 0 |  300 | 0 |  300 | 0
  450 | 0 |  450 | 0 |  450 | 0
  600 | 0 |  600 | 0 |  600 | 0
(6 rows)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
-- only default is common bounds in both relation
-- partition wise join not possible.
CREATE TABLE prt1_m (a int, b int, c int) PARTITION BY RANGE(a,b);
CREATE TABLE prt1_m_p0 PARTITION OF prt1_m FOR VALUES FROM (MINVALUE,MINVALUE) TO (-9,-9);
CREATE TABLE prt1_m_p2 PARTITION OF prt1_m DEFAULT;
INSERT INTO prt1_m SELECT i, i, i % 25  FROM generate_series(-500, 10) i WHERE i % 2 = 0;
ANALYZE prt1_m;
CREATE TABLE prt2_m (a int, b int, c int) PARTITION BY RANGE(b,a);
CREATE TABLE prt2_m_p0 PARTITION OF prt2_m FOR VALUES FROM (10,10) TO (MAXVALUE,MAXVALUE);
CREATE TABLE prt2_m_p2 PARTITION OF prt2_m DEFAULT;
INSERT INTO prt2_m SELECT i, i, i % 25  FROM generate_series(-10, 500) i WHERE i % 3 = 0;
ANALYZE prt2_m;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p2 t2_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_1
                           Filter: (c = 0)
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c 
---+---+---+---
 0 | 0 | 0 | 0
(1 row)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
               ->  Seq Scan on prt2_m_p2 t2_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: (c = 0)
                     ->  Seq Scan on prt1_m_p2 t1_1
                           Filter: (c = 0)
(13 rows)

SELECT t1, t2 FROM prt1_m t1 LEFT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
      t1       |   t2    
---------------+---------
 (-500,-500,0) | 
 (-450,-450,0) | 
 (-400,-400,0) | 
 (-350,-350,0) | 
 (-300,-300,0) | 
 (-250,-250,0) | 
 (-200,-200,0) | 
 (-150,-150,0) | 
 (-100,-100,0) | 
 (-50,-50,0)   | 
 (0,0,0)       | (0,0,0)
(11 rows)

-- right outer join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_1
                           Filter: (c = 0)
(13 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t2.c = 0 ORDER BY t1.a, t2.b;
 a | c |  b  | c 
---+---+-----+---
 0 | 0 |   0 | 0
   |   |  75 | 0
   |   | 150 | 0
   |   | 225 | 0
   |   | 300 | 0
   |   | 375 | 0
   |   | 450 | 0
(7 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Full Join
         Hash Cond: ((prt1_m_p0.a = prt2_m_p0.b) AND (prt1_m_p0.b = prt2_m_p0.a))
         Filter: (((50) = prt1_m_p0.a) OR ((75) = prt2_m_p0.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2
                           Filter: (c = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT 50 phv, * FROM prt1_m WHERE prt1_m.c = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2_m WHERE prt2_m.c = 0) t2 ON (t1.a = t2.b AND t1.b = t2.a) WHERE t1.phv = t1.a OR t2.phv = t2.b ORDER BY t1.a, t2.b;
 a | c | b  | c 
---+---+----+---
   |   | 75 | 0
(1 row)

-- Join with pruned partitions from joining relations
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
                        QUERY PLAN                         
-----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0 t2
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p2 t2_1
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0 t1
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2 t1_1
                           Filter: ((a < 450) AND (c = 0))
(15 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1_m t1, prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a AND t1.a < 450 AND t2.b > 250 AND t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c 
---+---+---+---
(0 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p0.b = prt1_m_p0.a) AND (prt2_m_p0.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(15 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c | b | c 
------+---+---+---
 -500 | 0 |   |  
 -450 | 0 |   |  
 -400 | 0 |   |  
 -350 | 0 |   |  
 -300 | 0 |   |  
 -250 | 0 |   |  
 -200 | 0 |   |  
 -150 | 0 |   |  
 -100 | 0 |   |  
  -50 | 0 |   |  
    0 | 0 |   |  
(11 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
                      QUERY PLAN                      
------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_1
                     Filter: (c = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                           Filter: (c = 0)
                     ->  Seq Scan on prt2_m_p2 t2_1
                           Filter: (c = 0)
(15 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t2.b,t2.a FROM prt2_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.a;
 a | b | c 
---+---+---
 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
                   QUERY PLAN                    
-------------------------------------------------
 Merge Semi Join
   Merge Cond: ((t1.b = t2.a) AND (t1.a = t2.b))
   ->  Sort
         Sort Key: t1.b, t1.a
         ->  Append
               ->  Seq Scan on prt2_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt2_m_p2 t1_1
                     Filter: (c = 0)
   ->  Sort
         Sort Key: t2.a, t2.b
         ->  Append
               ->  Seq Scan on prt1_m_p0 t2
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t2_1
                     Filter: (c = 0)
(16 rows)

SELECT t1.* FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t2.a,t2.b FROM prt1_m t2 WHERE t2.c = 0) AND t1.c = 0 ORDER BY t1.b;
 a | b | c 
---+---+---
 0 | 0 | 0
(1 row)

-- Anti-join with aggregates
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
                      QUERY PLAN                      
------------------------------------------------------
 Aggregate
   ->  Hash Anti Join
         Hash Cond: ((t1.a = t2.b) AND (t1.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
               ->  Seq Scan on prt1_m_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t2
                     ->  Seq Scan on prt2_m_p2 t2_1
(10 rows)

SELECT sum(t1.a), avg(t1.a), sum(t1.b), avg(t1.b) FROM prt1_m t1 WHERE NOT EXISTS (SELECT 1 FROM prt2_m t2 WHERE t1.a = t2.b AND t1.b = t2.a);
  sum   |          avg          |  sum   |          avg          
--------+-----------------------+--------+-----------------------
 -62720 | -247.9051383399209486 | -62720 | -247.9051383399209486
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
                        QUERY PLAN                        
----------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Left Join
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_1
                     Filter: (c = 0)
         ->  Hash Join
               Hash Cond: (t3.b = t2.a)
               ->  Append
                     ->  Seq Scan on prt2_m_p0 t3
                     ->  Seq Scan on prt2_m_p2 t3_1
               ->  Hash
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t2
                                 Filter: (t1.a = a)
                           ->  Seq Scan on prt1_m_p2 t2_1
                                 Filter: (t1.a = a)
(19 rows)

SELECT * FROM prt1_m t1 LEFT JOIN LATERAL (SELECT t2.a AS t2a, t3.a AS t3a, least(t1.a,t2.a,t3.b) FROM prt1_m t2 JOIN prt2_m t3 ON (t2.a = t3.b)) ss ON t1.a = ss.t2a WHERE t1.c = 0 ORDER BY t1.a;
  a   |  b   | c | t2a | t3a | least 
------+------+---+-----+-----+-------
 -500 | -500 | 0 |     |     |      
 -450 | -450 | 0 |     |     |      
 -400 | -400 | 0 |     |     |      
 -350 | -350 | 0 |     |     |      
 -300 | -300 | 0 |     |     |      
 -250 | -250 | 0 |     |     |      
 -200 | -200 | 0 |     |     |      
 -150 | -150 | 0 |     |     |      
 -100 | -100 | 0 |     |     |      
  -50 |  -50 | 0 |     |     |      
    0 |    0 | 0 |   0 |   0 |     0
(11 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_m_p0.a, prt2_m_p0.b
   ->  Hash Right Join
         Hash Cond: ((prt2_m_p0.b = prt1_m_p0.a) AND (prt2_m_p0.a = prt1_m_p0.b))
         ->  Append
               ->  Seq Scan on prt2_m_p0
                     Filter: (b > 250)
               ->  Seq Scan on prt2_m_p2
                     Filter: (b > 250)
         ->  Hash
               ->  Append
                     ->  Seq Scan on prt1_m_p0
                           Filter: ((a < 450) AND (c = 0))
                     ->  Seq Scan on prt1_m_p2
                           Filter: ((a < 450) AND (c = 0))
(15 rows)

SELECT t1.a, t2.b FROM (SELECT * FROM prt1_m WHERE a < 450) t1 LEFT JOIN (SELECT * FROM prt2_m WHERE b > 250) t2 ON t1.a = t2.b AND t1.b = t2.a WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | b 
------+---
 -500 |  
 -450 |  
 -400 |  
 -350 |  
 -300 |  
 -250 |  
 -200 |  
 -150 |  
 -100 |  
  -50 |  
    0 |  
(11 rows)

--N-WAY joins
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Semi Join
         Hash Cond: ((t1.a = t1_2.b) AND (t1.b = t1_2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t1
                     Filter: (c = 0)
               ->  Seq Scan on prt1_m_p2 t1_1
                     Filter: (c = 0)
         ->  Hash
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.b = t1_4.a) AND (t1_2.a = t1_4.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t1_2
                           ->  Seq Scan on prt2_m_p2 t1_3
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1_4
                                 ->  Seq Scan on prt1_m_p2 t1_5
(19 rows)

SELECT t1.* FROM prt1_m t1 WHERE (t1.a,t1.b) IN (SELECT t1.b,t1.a FROM prt2_m t1 WHERE (t1.b,t1.a) IN (SELECT t1.a,t1.b FROM prt1_m t1)) AND t1.c = 0 ORDER BY t1.a;
 a | b | c 
---+---+---
 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c | b | c | a | c 
------+---+---+---+---+---
 -500 | 0 |   |   |   | 0
 -450 | 0 |   |   |   | 0
 -400 | 0 |   |   |   | 0
 -350 | 0 |   |   |   | 0
 -300 | 0 |   |   |   | 0
 -250 | 0 |   |   |   | 0
 -200 | 0 |   |   |   | 0
 -150 | 0 |   |   |   | 0
 -100 | 0 |   |   |   | 0
  -50 | 0 |   |   |   | 0
    0 | 0 | 0 | 0 | 0 | 0
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c | b | c | a | c 
------+---+---+---+---+---
 -500 | 0 |   |   |   | 0
 -450 | 0 |   |   |   | 0
 -400 | 0 |   |   |   | 0
 -350 | 0 |   |   |   | 0
 -300 | 0 |   |   |   | 0
 -250 | 0 |   |   |   | 0
 -200 | 0 |   |   |   | 0
 -150 | 0 |   |   |   | 0
 -100 | 0 |   |   |   | 0
  -50 | 0 |   |   |   | 0
    0 | 0 | 0 | 0 | 0 | 0
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c | b | c | a | c 
------+---+---+---+---+---
 -500 | 0 |   |   |   | 0
 -450 | 0 |   |   |   | 0
 -400 | 0 |   |   |   | 0
 -350 | 0 |   |   |   | 0
 -300 | 0 |   |   |   | 0
 -250 | 0 |   |   |   | 0
 -200 | 0 |   |   |   | 0
 -150 | 0 |   |   |   | 0
 -100 | 0 |   |   |   | 0
  -50 | 0 |   |   |   | 0
    0 | 0 | 0 | 0 | 0 | 0
(11 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) RIGHT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (t3.b = t2.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t3
               ->  Seq Scan on prt1_m_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                     ->  Append
                           ->  Seq Scan on prt2_m_p0 t2
                           ->  Seq Scan on prt2_m_p2 t2_1
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_m_p0 t1
                                       Filter: (c = 0)
                                 ->  Seq Scan on prt1_m_p2 t1_1
                                       Filter: (c = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 FULL JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) FULL JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
  a   | c | b | c | a | c 
------+---+---+---+---+---
 -500 | 0 |   |   |   | 0
 -450 | 0 |   |   |   | 0
 -400 | 0 |   |   |   | 0
 -350 | 0 |   |   |   | 0
 -300 | 0 |   |   |   | 0
 -250 | 0 |   |   |   | 0
 -200 | 0 |   |   |   | 0
 -150 | 0 |   |   |   | 0
 -100 | 0 |   |   |   | 0
  -50 | 0 |   |   |   | 0
    0 | 0 | 0 | 0 | 0 | 0
(11 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_1
                                                               Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) INNER JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_1
                                                               Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) INNER JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) RIGHT JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_1
                                                               Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 LEFT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t5.a = t4.b) AND (t5.b = t4.a))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_1
                                                               Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 INNER JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) RIGHT JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) FULL JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t5.a = t1.a) AND (t5.b = t1.b))
         ->  Append
               ->  Seq Scan on prt1_m_p0 t5
               ->  Seq Scan on prt1_m_p2 t5_1
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t3.a = t1.a) AND (t3.b = t1.b))
                     ->  Append
                           ->  Seq Scan on prt1_m_p0 t3
                           ->  Seq Scan on prt1_m_p2 t3_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t4.b = t1.a) AND (t4.a = t1.b))
                                 ->  Append
                                       ->  Seq Scan on prt2_m_p0 t4
                                       ->  Seq Scan on prt2_m_p2 t4_1
                                 ->  Hash
                                       ->  Hash Join
                                             Hash Cond: ((t2.b = t1.a) AND (t2.a = t1.b))
                                             ->  Append
                                                   ->  Seq Scan on prt2_m_p0 t2
                                                   ->  Seq Scan on prt2_m_p2 t2_1
                                             ->  Hash
                                                   ->  Append
                                                         ->  Seq Scan on prt1_m_p0 t1
                                                               Filter: (c = 0)
                                                         ->  Seq Scan on prt1_m_p2 t1_1
                                                               Filter: (c = 0)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1_m t1 RIGHT JOIN prt2_m t2 ON (t1.a = t2.b AND t1.b = t2.a) LEFT JOIN prt1_m t3 ON (t2.b = t3.a AND t2.a = t3.b) FULL JOIN prt2_m t4 ON (t3.a = t4.b AND t3.b = t4.a) INNER JOIN prt1_m t5 ON (t4.b = t5.a AND t4.a = t5.b) WHERE t1.c = 0 ORDER BY t1.a, t2.b;
 a | c | b | c | a | c 
---+---+---+---+---+---
 0 | 0 | 0 | 0 | 0 | 0
(1 row)

DROP TABLE prt1_m;
DROP TABLE prt2_m;
--=============================================================================================================================
--
-- partitioned by list and partition by expression as partition key
--
--=============================================================================================================================
-- plt1 and plt2 both have default partition with excat bound matches.
-- pwj is possible for all cases.
-- NOTE: But in N-way joins, although PWJ is considered while creating the
-- paths, the costs come out to be higher than non-PWJ paths (esp.
-- (parallel hash partitioning), so PWJ plan is
-- chosen. Need to increase the data?
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_p3 PARTITION OF plt1 DEFAULT;
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e DEFAULT;
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Join Filter: ((t1.b + t2.b) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Join Filter: ((t1_1.b + t2_1.b) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Join Filter: ((t1_2.b + t2_2.b) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Left Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Left Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_p1 t2
               ->  Hash Left Join
                     Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                     Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_p2 t2_1
               ->  Hash Left Join
                     Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                     Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_p3 t2_2
(22 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (47,0,0003)  | (47,0,0003)
 (94,0,0006)  | (94,0,0006)
 (141,0,0009) | (141,0,0009)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | (235,0,0004)
 (282,0,0007) | (282,0,0007)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
 (470,0,0008) | (470,0,0008)
(9 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t1
               ->  Hash Left Join
                     Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                     Filter: ((COALESCE(t1_1.b, 0) + t2_1.b) = 0)
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t1_1
               ->  Hash Left Join
                     Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                     Filter: ((COALESCE(t1_2.b, 0) + t2_2.b) = 0)
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t1_2
(22 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Full Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((COALESCE(t1_1.b, 0) + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Full Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((COALESCE(t1_2.b, 0) + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
                     Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
                     ->  Seq Scan on plt1_p1
                     ->  Hash
                           ->  Seq Scan on plt2_p1
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     Join Filter: ((plt2_p2.b = 0) AND (plt1_p2.b = 0))
                     Filter: ((('0001'::text) = (plt1_p2.c)::text) OR (('0002'::text) = (plt2_p2.c)::text))
                     ->  Seq Scan on plt1_p2
                     ->  Hash
                           ->  Seq Scan on plt2_p2
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     Join Filter: ((plt2_p3.b = 0) AND (plt1_p3.b = 0))
                     Filter: ((('0001'::text) = (plt1_p3.c)::text) OR (('0002'::text) = (plt2_p3.c)::text))
                     ->  Seq Scan on plt1_p3
                     ->  Hash
                           ->  Seq Scan on plt2_p3
(25 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Anti Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a | b | c 
---+---+---
(0 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Anti Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a | b | c 
---+---+---
(0 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0003 | 0003 | 0003
 0004 | 0004 | 0004
 0005 | 0005 | 0005
 0006 | 0006 | 0006
 0007 | 0007 | 0007
 0008 | 0008 | 0008
 0009 | 0009 | 0009
(9 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p3.c, plt2_p3.c
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((plt2_p3.c)::text = (plt1_p3.c)::text)
               ->  Seq Scan on plt2_p3
                     Filter: ((c)::text > '0002'::text)
               ->  Hash
                     ->  Seq Scan on plt1_p3
                           Filter: (((c)::text < '0000'::text) AND (b = 0))
(10 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Result
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t2
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt2_p3 t2_2
(33 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(9 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Result
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t2
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt2_p3 t2_2
(33 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t1_1.a) AND (ltrim((t3_1.c)::text, 'A'::text) = (t1_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t1_2.a) AND (ltrim((t3_2.c)::text, 'A'::text) = (t1_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (ltrim((t3_1.c)::text, 'A'::text) = (t2_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (ltrim((t3_2.c)::text, 'A'::text) = (t2_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |          | 
  75 | 0009 |    |      |          | 
 100 | 0001 |    |      |          | 
 125 | 0004 |    |      |          | 
 150 | 0007 |    |      |          | 
 200 | 0002 |    |      |          | 
 225 | 0005 |    |      |          | 
 250 | 0008 |    |      |          | 
 300 | 0003 |    |      |          | 
 325 | 0006 |    |      |          | 
 350 | 0009 |    |      |          | 
 375 | 0001 |    |      |          | 
 400 | 0004 |    |      |          | 
 425 | 0007 |    |      |          | 
 475 | 0002 |    |      |          | 
 500 | 0005 |    |      |          | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)) AND (t1_2.a = t3_2.a))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      103 | 0009
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      371 | 0009
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(34 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t2_1.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t2_2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t2_2
(30 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |          avg           |  c   
-----+------+------------------------+------
 475 | 0001 |                        | 
 675 | 0002 |                        | 
  25 | 0003 |    25.0000000000000000 | 0003
 300 | 0003 |                        | 
 525 | 0004 |                        | 
 725 | 0005 |                        | 
 375 | 0006 |                        | 
 575 | 0007 |                        | 
 250 | 0008 |                        | 
 425 | 0009 |                        | 
     |      |    12.5000000000000000 | 0001
     |      |    12.5000000000000000 | 0002
     |      | 0.00000000000000000000 | 0003
     |      |    12.5000000000000000 | 0004
     |      |    12.5000000000000000 | 0005
     |      |    12.5000000000000000 | 0006
     |      |    12.5000000000000000 | 0007
     |      |    12.5000000000000000 | 0008
     |      |    12.5000000000000000 | 0009
(19 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |          avg           |  c   |         avg         
-----+------+-----+------------------------+------+---------------------
 475 | 0001 |  50 |                        |      |                    
 675 | 0002 |  50 |                        |      |                    
  25 | 0003 |  25 |    25.0000000000000000 | 0003 | 50.0000000000000000
 300 | 0003 |  25 |                        |      |                    
 525 | 0004 |  50 |                        |      |                    
 725 | 0005 |  50 |                        |      |                    
 375 | 0006 |  50 |                        |      |                    
 575 | 0007 |  50 |                        |      |                    
 250 | 0008 |  25 |                        |      |                    
 425 | 0009 |  50 |                        |      |                    
     |      |     |    12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     | 0.00000000000000000000 | 0003 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0004 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0009 | 50.0000000000000000
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p1 t2
               ->  Hash
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_1.b = t1_1.a) AND (ltrim((t2_1.c)::text, 'A'::text) = ltrim((t1_1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Hash
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_2.b = t1_2.a) AND (ltrim((t2_2.c)::text, 'A'::text) = ltrim((t1_2.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p3 t2_2
               ->  Hash
                     ->  Seq Scan on plt1_e_p3 t1_2
                           Filter: ((a % 25) = 0)
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p1 t2
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND (ltrim((t1_1.c)::text, 'A'::text) = ltrim((t2_1.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p2 t2_1
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND (ltrim((t1_2.c)::text, 'A'::text) = ltrim((t2_2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_e_p3 t2_2
                                 Filter: ((b % 25) = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a  |  c   | b  |  c   
----+------+----+------
 25 | 0003 | 25 | 0003
    |      |  0 | 0001
    |      |  0 | 0002
    |      |  0 | 0003
    |      |  0 | 0004
    |      |  0 | 0005
    |      |  0 | 0006
    |      |  0 | 0007
    |      |  0 | 0008
    |      |  0 | 0009
    |      | 25 | 0001
    |      | 25 | 0002
    |      | 25 | 0004
    |      | 25 | 0005
    |      | 25 | 0006
    |      | 25 | 0007
    |      | 25 | 0008
    |      | 25 | 0009
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p1.a = plt2_e_p1.b) AND (ltrim((plt1_e_p1.c)::text, 'A'::text) = ltrim((plt2_e_p1.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p1
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p1
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p2.a = plt2_e_p2.b) AND (ltrim((plt1_e_p2.c)::text, 'A'::text) = ltrim((plt2_e_p2.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p2
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p2
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p3.a = plt2_e_p3.b) AND (ltrim((plt1_e_p3.c)::text, 'A'::text) = ltrim((plt2_e_p3.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p3
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p3
                           Filter: ((b % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0003
     |      |  0 | 0004
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0004
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
(34 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
  25 | 25 | 0003 | 0003 | 0003 | 0003
  50 |  3 | 0006 | 0006 | 0006 | 0006
  75 | 28 | 0009 | 0009 | 0009 | 0009
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 | 0004 | 0004 | 0004
 150 |  9 | 0007 | 0007 | 0007 | 0007
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 250 | 15 | 0008 | 0008 | 0008 | 0008
 300 | 18 | 0003 | 0003 | 0003 | 0003
 325 | 43 | 0006 | 0006 | 0006 | 0006
 350 | 21 | 0009 | 0009 | 0009 | 0009
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 | 0004 | 0004 | 0004
 425 |  2 | 0007 | 0007 | 0007 | 0007
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(17 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(35 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      103 | 0009
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      371 | 0009
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(34 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t1.c)::text = (t5.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t4.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1.c)::text = (t3.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t4_1.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_2.c)::text = (t4_2.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t4.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1.c)::text = (t3.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t4_1.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_2.c)::text = (t4_2.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1.c)::text = (t2.c)::text)
                                             ->  Seq Scan on plt1_p1 t1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p1 t2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1.c)::text = (t2.c)::text)
                                             ->  Seq Scan on plt1_p1 t1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p1 t2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2.c)::text = (t3.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2.c)::text = (t1.c)::text)
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p1 t1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p2 t1_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p3 t1_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- plt2 have extra partition which is default partition
-- pwj is possible when default partition is outer side of relation.
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0005','0006','0007','0008');
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,9,10);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0005','0006','0007','0008');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0005','0006','0007','0008');
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,9,10);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0005','0006','0007','0008');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Join Filter: ((t1.b + t2.b) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Join Filter: ((t1_1.b + t2_1.b) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
(15 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(8 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Left Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
(15 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(8 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_p1 t2
               ->  Hash Left Join
                     Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                     Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_p2 t2_1
(16 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (47,0,0003)  | (47,0,0003)
 (94,0,0006)  | (94,0,0006)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | (235,0,0004)
 (282,0,0007) | (282,0,0007)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
 (470,0,0008) | (470,0,0008)
(8 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Hash Left Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
     |      | 141 | 0009
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Hash Full Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
     |      | 141 | 0009
(9 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.c)::text = (plt1_p1.c)::text)
               Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
               Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                     ->  Seq Scan on plt2_p2
                     ->  Seq Scan on plt2_p3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                           ->  Seq Scan on plt1_p2
(15 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  HashAggregate
                           Group Key: (t2.c)::text
                           ->  Seq Scan on plt2_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  HashAggregate
                           Group Key: (t2_1.c)::text
                           ->  Seq Scan on plt2_p2 t2_1
(19 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  HashAggregate
                           Group Key: (t2.c)::text
                           ->  Seq Scan on plt1_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Hash
                     ->  HashAggregate
                           Group Key: (t2_1.c)::text
                           ->  Seq Scan on plt1_p2 t2_1
(19 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Anti Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
(13 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a | b | c 
---+---+---
(0 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Anti Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t2
                     ->  Seq Scan on plt1_p2 t2_1
(15 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
 141 | 0 | 0009
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
(23 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0003 | 0003 | 0003
 0004 | 0004 | 0004
 0005 | 0005 | 0005
 0006 | 0006 | 0006
 0007 | 0007 | 0007
 0008 | 0008 | 0008
(8 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
           QUERY PLAN           
--------------------------------
 Sort
   Sort Key: plt1.c, plt2.c
   ->  Result
         One-Time Filter: false
(4 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash Join
                                 Hash Cond: ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
(21 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Append
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash Join
                                 Hash Cond: ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
(21 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t1_1.a) AND (ltrim((t3_1.c)::text, 'A'::text) = (t1_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (ltrim((t3_1.c)::text, 'A'::text) = (t2_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |          | 
 100 | 0001 |    |      |          | 
 125 | 0004 |    |      |          | 
 150 | 0007 |    |      |          | 
 200 | 0002 |    |      |          | 
 225 | 0005 |    |      |          | 
 250 | 0008 |    |      |          | 
 300 | 0003 |    |      |          | 
 325 | 0006 |    |      |          | 
 375 | 0001 |    |      |          | 
 400 | 0004 |    |      |          | 
 425 | 0007 |    |      |          | 
 475 | 0002 |    |      |          | 
 500 | 0005 |    |      |          | 
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.b = plt1_p1.a) AND ((plt2_p1.c)::text = (plt1_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(25 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(32 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_2.c)::text = ltrim((t2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_2
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t2_1.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t2_1
(21 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.c)::text = ltrim((t1_4.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_2
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_4
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_5.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_5
                                 Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt2_p1.c)::text = (plt1_p1.c)::text) AND (plt2_p1.b = plt1_p1.a))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
(19 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |          avg           |  c   
-----+------+------------------------+------
 475 | 0001 |                        | 
 675 | 0002 |                        | 
  25 | 0003 |    25.0000000000000000 | 0003
 300 | 0003 |                        | 
 525 | 0004 |                        | 
 725 | 0005 |                        | 
 375 | 0006 |                        | 
 575 | 0007 |                        | 
 250 | 0008 |                        | 
     |      |    12.5000000000000000 | 0001
     |      |    12.5000000000000000 | 0002
     |      | 0.00000000000000000000 | 0003
     |      |    12.5000000000000000 | 0004
     |      |    12.5000000000000000 | 0005
     |      |    12.5000000000000000 | 0006
     |      |    12.5000000000000000 | 0007
     |      |    12.5000000000000000 | 0008
     |      |    12.5000000000000000 | 0009
(18 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt2_p1.c)::text = (plt1_p1.c)::text) AND (plt2_p1.b = plt1_p1.a))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
(19 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |          avg           |  c   |         avg         
-----+------+-----+------------------------+------+---------------------
 475 | 0001 |  50 |                        |      |                    
 675 | 0002 |  50 |                        |      |                    
  25 | 0003 |  25 |    25.0000000000000000 | 0003 | 50.0000000000000000
 300 | 0003 |  25 |                        |      |                    
 525 | 0004 |  50 |                        |      |                    
 725 | 0005 |  50 |                        |      |                    
 375 | 0006 |  50 |                        |      |                    
 575 | 0007 |  50 |                        |      |                    
 250 | 0008 |  25 |                        |      |                    
     |      |     |    12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     | 0.00000000000000000000 | 0003 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0004 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0009 | 50.0000000000000000
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p1 t2
               ->  Hash
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_1.b = t1_1.a) AND (ltrim((t2_1.c)::text, 'A'::text) = ltrim((t1_1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Hash
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
(15 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t1
               ->  Seq Scan on plt1_e_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1 t2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2 t2_1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3 t2_2
                           Filter: ((b % 25) = 0)
(15 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a  |  c   | b  |  c   
----+------+----+------
 25 | 0003 | 25 | 0003
    |      |  0 | 0001
    |      |  0 | 0002
    |      |  0 | 0003
    |      |  0 | 0004
    |      |  0 | 0005
    |      |  0 | 0006
    |      |  0 | 0007
    |      |  0 | 0008
    |      |  0 | 0009
    |      | 25 | 0001
    |      | 25 | 0002
    |      | 25 | 0004
    |      | 25 | 0005
    |      | 25 | 0006
    |      | 25 | 0007
    |      | 25 | 0008
    |      | 25 | 0009
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt2_e_p1.b = plt1_e_p1.a) AND (ltrim((plt2_e_p1.c)::text, 'A'::text) = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt2_e_p1
                     Filter: ((b % 25) = 0)
               ->  Seq Scan on plt2_e_p2
                     Filter: ((b % 25) = 0)
               ->  Seq Scan on plt2_e_p3
                     Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0003
     |      |  0 | 0004
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0004
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
(32 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
(23 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
  25 | 25 | 0003 | 0003 | 0003 | 0003
  50 |  3 | 0006 | 0006 | 0006 | 0006
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 | 0004 | 0004 | 0004
 150 |  9 | 0007 | 0007 | 0007 | 0007
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 250 | 15 | 0008 | 0008 | 0008 | 0008
 300 | 18 | 0003 | 0003 | 0003 | 0003
 325 | 43 | 0006 | 0006 | 0006 | 0006
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 | 0004 | 0004 | 0004
 425 |  2 | 0007 | 0007 | 0007 | 0007
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(15 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.c)::text = (plt1_p1.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(26 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.b = plt1_p1.a) AND ((plt2_p1.c)::text = (plt1_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(25 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(32 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.c)::text = ltrim((t1_4.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_2
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_4
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_5.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_5
                                 Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         ->  Hash Join
               Hash Cond: ((t2.c)::text = (t5.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t4.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = (t3.c)::text)
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.c)::text = (t4_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.c)::text = (t3_1.c)::text)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t4.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = (t3.c)::text)
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t2_1.c)::text = (t4_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.c)::text = (t3_1.c)::text)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t1_1
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     Join Filter: ((t3.c)::text = (t4.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4.c)::text = (t5.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t5
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = (t3.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
               ->  Nested Loop Left Join
                     Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t5_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
(48 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Hash Right Join
               Hash Cond: ((t3.c)::text = (t4.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t3.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = (t2.c)::text)
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t3
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = (t3_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t3_1
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
(45 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     Join Filter: ((t3.c)::text = (t4.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4.c)::text = (t5.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t5
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Left Join
                                 Hash Cond: ((t2.c)::text = (t1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t2.c)::text = (t3.c)::text)
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
               ->  Nested Loop Left Join
                     Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t5_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Left Join
                                 Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t2_1.c)::text = (t3_1.c)::text)
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
(48 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- plt2 have default partition and plt1 have some extra list values 
-- pwj is possible when default partition is outer side of relation. - ?? (right is picking pwj but for range it is not picking)
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_p3 PARTITION OF plt1 FOR VALUES IN ('0007','0008','0009');
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e FOR VALUES IN ('0007','0008','0009');
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Join Filter: ((t1.b + t2.b) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Join Filter: ((t1_1.b + t2_1.b) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Join Filter: ((t1_2.b + t2_2.b) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Left Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Left Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_p1 t2
               ->  Hash Left Join
                     Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                     Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_p2 t2_1
               ->  Hash Left Join
                     Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                     Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_p3 t2_2
(22 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (47,0,0003)  | (47,0,0003)
 (94,0,0006)  | (94,0,0006)
 (141,0,0009) | (141,0,0009)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | (235,0,0004)
 (282,0,0007) | (282,0,0007)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
 (470,0,0008) | (470,0,0008)
(9 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t1
               ->  Hash Left Join
                     Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                     Filter: ((COALESCE(t1_1.b, 0) + t2_1.b) = 0)
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t1_1
               ->  Hash Left Join
                     Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                     Filter: ((COALESCE(t1_2.b, 0) + t2_2.b) = 0)
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t1_2
(22 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Full Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((COALESCE(t1_1.b, 0) + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Full Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((COALESCE(t1_2.b, 0) + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 | 0003 |  47 | 0003
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
                     Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
                     ->  Seq Scan on plt1_p1
                     ->  Hash
                           ->  Seq Scan on plt2_p1
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     Join Filter: ((plt2_p2.b = 0) AND (plt1_p2.b = 0))
                     Filter: ((('0001'::text) = (plt1_p2.c)::text) OR (('0002'::text) = (plt2_p2.c)::text))
                     ->  Seq Scan on plt1_p2
                     ->  Hash
                           ->  Seq Scan on plt2_p2
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     Join Filter: ((plt2_p3.b = 0) AND (plt1_p3.b = 0))
                     Filter: ((('0001'::text) = (plt1_p3.c)::text) OR (('0002'::text) = (plt2_p3.c)::text))
                     ->  Seq Scan on plt1_p3
                     ->  Hash
                           ->  Seq Scan on plt2_p3
(25 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Anti Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a | b | c 
---+---+---
(0 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop Anti Join
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(18 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a | b | c 
---+---+---
(0 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0003 | 0003 | 0003
 0004 | 0004 | 0004
 0005 | 0005 | 0005
 0006 | 0006 | 0006
 0007 | 0007 | 0007
 0008 | 0008 | 0008
 0009 | 0009 | 0009
(9 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
           QUERY PLAN           
--------------------------------
 Sort
   Sort Key: plt1.c, plt2.c
   ->  Result
         One-Time Filter: false
(4 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Result
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t2
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt2_p3 t2_2
(33 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(9 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Result
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt2_p1 t2
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt2_p3 t2_2
(33 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 250.5000000000000000 | 22.6521739130434783 | 273.1521739130434783 | 0003 | 0003 | 0003
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t1_1.a) AND (ltrim((t3_1.c)::text, 'A'::text) = (t1_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t1_2.a) AND (ltrim((t3_2.c)::text, 'A'::text) = (t1_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (ltrim((t3_1.c)::text, 'A'::text) = (t2_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (ltrim((t3_2.c)::text, 'A'::text) = (t2_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |          | 
  75 | 0009 |    |      |          | 
 100 | 0001 |    |      |          | 
 125 | 0004 |    |      |          | 
 150 | 0007 |    |      |          | 
 200 | 0002 |    |      |          | 
 225 | 0005 |    |      |          | 
 250 | 0008 |    |      |          | 
 300 | 0003 |    |      |          | 
 325 | 0006 |    |      |          | 
 350 | 0009 |    |      |          | 
 375 | 0001 |    |      |          | 
 400 | 0004 |    |      |          | 
 425 | 0007 |    |      |          | 
 475 | 0002 |    |      |          | 
 500 | 0005 |    |      |          | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)) AND (t1_2.a = t3_2.a))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      103 | 0009
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      371 | 0009
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(34 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t2_1.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t2_2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t2_2
(30 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |          avg           |  c   
-----+------+------------------------+------
 475 | 0001 |                        | 
 675 | 0002 |                        | 
  25 | 0003 |    25.0000000000000000 | 0003
 300 | 0003 |                        | 
 525 | 0004 |                        | 
 725 | 0005 |                        | 
 375 | 0006 |                        | 
 575 | 0007 |                        | 
 250 | 0008 |                        | 
 425 | 0009 |                        | 
     |      |    12.5000000000000000 | 0001
     |      |    12.5000000000000000 | 0002
     |      | 0.00000000000000000000 | 0003
     |      |    12.5000000000000000 | 0004
     |      |    12.5000000000000000 | 0005
     |      |    12.5000000000000000 | 0006
     |      |    12.5000000000000000 | 0007
     |      |    12.5000000000000000 | 0008
     |      |    12.5000000000000000 | 0009
(19 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |          avg           |  c   |         avg         
-----+------+-----+------------------------+------+---------------------
 475 | 0001 |  50 |                        |      |                    
 675 | 0002 |  50 |                        |      |                    
  25 | 0003 |  25 |    25.0000000000000000 | 0003 | 50.0000000000000000
 300 | 0003 |  25 |                        |      |                    
 525 | 0004 |  50 |                        |      |                    
 725 | 0005 |  50 |                        |      |                    
 375 | 0006 |  50 |                        |      |                    
 575 | 0007 |  50 |                        |      |                    
 250 | 0008 |  25 |                        |      |                    
 425 | 0009 |  50 |                        |      |                    
     |      |     |    12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     | 0.00000000000000000000 | 0003 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0004 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0009 | 50.0000000000000000
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p1 t2
               ->  Hash
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_1.b = t1_1.a) AND (ltrim((t2_1.c)::text, 'A'::text) = ltrim((t1_1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Hash
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_2.b = t1_2.a) AND (ltrim((t2_2.c)::text, 'A'::text) = ltrim((t1_2.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p3 t2_2
               ->  Hash
                     ->  Seq Scan on plt1_e_p3 t1_2
                           Filter: ((a % 25) = 0)
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p1 t2
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND (ltrim((t1_1.c)::text, 'A'::text) = ltrim((t2_1.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p2 t2_1
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND (ltrim((t1_2.c)::text, 'A'::text) = ltrim((t2_2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_e_p3 t2_2
                                 Filter: ((b % 25) = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a  |  c   | b  |  c   
----+------+----+------
 25 | 0003 | 25 | 0003
    |      |  0 | 0001
    |      |  0 | 0002
    |      |  0 | 0003
    |      |  0 | 0004
    |      |  0 | 0005
    |      |  0 | 0006
    |      |  0 | 0007
    |      |  0 | 0008
    |      |  0 | 0009
    |      | 25 | 0001
    |      | 25 | 0002
    |      | 25 | 0004
    |      | 25 | 0005
    |      | 25 | 0006
    |      | 25 | 0007
    |      | 25 | 0008
    |      | 25 | 0009
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p1.a = plt2_e_p1.b) AND (ltrim((plt1_e_p1.c)::text, 'A'::text) = ltrim((plt2_e_p1.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p1
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p1
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p2.a = plt2_e_p2.b) AND (ltrim((plt1_e_p2.c)::text, 'A'::text) = ltrim((plt2_e_p2.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p2
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p2
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p3.a = plt2_e_p3.b) AND (ltrim((plt1_e_p3.c)::text, 'A'::text) = ltrim((plt2_e_p3.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p3
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p3
                           Filter: ((b % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
  25 | 0003 | 25 | 0003
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0003
     |      |  0 | 0004
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0004
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
(34 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
  25 | 25 | 0003 | 0003 | 0003 | 0003
  50 |  3 | 0006 | 0006 | 0006 | 0006
  75 | 28 | 0009 | 0009 | 0009 | 0009
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 | 0004 | 0004 | 0004
 150 |  9 | 0007 | 0007 | 0007 | 0007
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 250 | 15 | 0008 | 0008 | 0008 | 0008
 300 | 18 | 0003 | 0003 | 0003 | 0003
 325 | 43 | 0006 | 0006 | 0006 | 0006
 350 | 21 | 0009 | 0009 | 0009 | 0009
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 | 0004 | 0004 | 0004
 425 |  2 | 0007 | 0007 | 0007 | 0007
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(17 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(35 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a  |  c   | b  |  c   | ?column? |  c   
----+------+----+------+----------+------
 25 | 0003 | 25 | 0003 |       50 | 0003
    |      |    |      |       53 | 0006
    |      |    |      |      103 | 0009
    |      |    |      |      106 | 0001
    |      |    |      |      156 | 0004
    |      |    |      |      159 | 0007
    |      |    |      |      212 | 0002
    |      |    |      |      262 | 0005
    |      |    |      |      265 | 0008
    |      |    |      |      318 | 0003
    |      |    |      |      368 | 0006
    |      |    |      |      371 | 0009
    |      |    |      |      421 | 0001
    |      |    |      |      424 | 0004
    |      |    |      |      427 | 0007
    |      |    |      |      480 | 0002
    |      |    |      |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 | 0003 | 25 | 0003 |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0003 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
(34 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  25 | 25 | 0003
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 300 | 18 | 0003
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(17 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(9 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t1.c)::text = (t5.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t4.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1.c)::text = (t3.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t4_1.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_2.c)::text = (t4_2.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t4.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1.c)::text = (t3.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t4_1.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_2.c)::text = (t4_2.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1.c)::text = (t2.c)::text)
                                             ->  Seq Scan on plt1_p1 t1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p1 t2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1.c)::text = (t2.c)::text)
                                             ->  Seq Scan on plt1_p1 t1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p1 t2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2.c)::text = (t3.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2.c)::text = (t1.c)::text)
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p1 t1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p2 t1_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p3 t1_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(9 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- both partitions have some different list values which filled by default partition of each other
-- Partition-wise join is not possible when one table need to join
-- with more than one table.
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0003','0004');
CREATE TABLE plt1_p3 PARTITION OF plt1 DEFAULT;
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (7,8);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0007','0008');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (3,4);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0003','0004');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e DEFAULT;
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (7,8);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0007','0008');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (3,4);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Join Filter: ((t1.b + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 329 | 0010 | 329 | 0010
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
(7 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  47 | 0003 |     | 
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 |     | 
 329 | 0010 | 329 | 0010
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
(9 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (0,0,0000)   | (0,0,0000)
 (47,0,0003)  | 
 (94,0,0006)  | (94,0,0006)
 (141,0,0009) | (141,0,0009)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | 
 (329,0,0010) | (329,0,0010)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
(9 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Hash Left Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 329 | 0010 | 329 | 0010
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
     |      | 470 | 0008
     |      | 282 | 0007
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Hash Full Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  47 | 0003 |     | 
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 |     | 
 329 | 0010 | 329 | 0010
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
     |      | 282 | 0007
     |      | 470 | 0008
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.c)::text = (plt1_p1.c)::text)
               Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
               Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                     ->  Seq Scan on plt2_p2
                     ->  Seq Scan on plt2_p3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                           ->  Seq Scan on plt1_p2
                           ->  Seq Scan on plt1_p3
(16 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Seq Scan on plt2_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                 ->  Seq Scan on plt1_p2 t2_1
                                 ->  Seq Scan on plt1_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                     QUERY PLAN                     
----------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Nested Loop Anti Join
         Join Filter: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
         ->  Materialize
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(16 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
 235 | 0 | 0004
(2 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                     QUERY PLAN                     
----------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Nested Loop Anti Join
         Join Filter: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Materialize
               ->  Append
                     ->  Seq Scan on plt1_p1 t2
                     ->  Seq Scan on plt1_p2 t2_1
                     ->  Seq Scan on plt1_p3 t2_2
(16 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
 282 | 0 | 0007
 470 | 0 | 0008
(2 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1.c)::text = (c)::text)
(26 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0000 | 0000 | 0000
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0003 |      | 
 0004 |      | 
 0005 | 0005 | 0005
 0006 | 0006 | 0006
 0009 | 0009 | 0009
 0010 | 0010 | 0010
(9 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p3.c, plt2_p2.c
   ->  Hash Right Join
         Hash Cond: ((plt2_p2.c)::text = (plt1_p3.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p2
                     Filter: ((c)::text > '0002'::text)
               ->  Seq Scan on plt2_p3
                     Filter: ((c)::text > '0002'::text)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p3
                           Filter: (((c)::text < '0000'::text) AND (b = 0))
(13 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 247.5000000000000000 | 22.7173913043478261 | 270.2173913043478261 | 0000 | 0000 | 0000
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
 252.0000000000000000 | 22.2222222222222222 | 274.2222222222222222 | 0010 | 0010 | 0010
(7 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 247.5000000000000000 | 22.7173913043478261 | 270.2173913043478261 | 0000 | 0000 | 0000
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
 252.0000000000000000 | 22.2222222222222222 | 274.2222222222222222 | 0010 | 0010 | 0010
(7 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t3
               ->  Seq Scan on plt1_e_p2 t3_1
               ->  Seq Scan on plt1_e_p3 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |       50 | 0003
  50 | 0006 |   |      |       53 | 0006
  75 | 0009 |   |      |      103 | 0009
 100 | 0001 |   |      |      106 | 0001
 125 | 0004 |   |      |      156 | 0004
 175 | 0010 |   |      |      209 | 0010
 200 | 0002 |   |      |      212 | 0002
 225 | 0005 |   |      |      262 | 0005
 275 | 0000 |   |      |      315 | 0000
 300 | 0003 |   |      |      318 | 0003
 325 | 0006 |   |      |      368 | 0006
 350 | 0009 |   |      |      371 | 0009
 375 | 0001 |   |      |      421 | 0001
 400 | 0004 |   |      |      424 | 0004
 450 | 0010 |   |      |      477 | 0010
 475 | 0002 |   |      |      480 | 0002
 500 | 0005 |   |      |      530 | 0005
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t3
               ->  Seq Scan on plt1_e_p2 t3_1
               ->  Seq Scan on plt1_e_p3 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |          | 
  50 | 0006 |   |      |          | 
  75 | 0009 |   |      |          | 
 100 | 0001 |   |      |          | 
 125 | 0004 |   |      |          | 
 175 | 0010 |   |      |          | 
 200 | 0002 |   |      |          | 
 225 | 0005 |   |      |          | 
 275 | 0000 |   |      |          | 
 300 | 0003 |   |      |          | 
 325 | 0006 |   |      |          | 
 350 | 0009 |   |      |          | 
 375 | 0001 |   |      |          | 
 400 | 0004 |   |      |          | 
 450 | 0010 |   |      |          | 
 475 | 0002 |   |      |          | 
 500 | 0005 |   |      |          | 
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Hash Right Join
                           Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: (((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)) AND (t1_2.a = t3_2.a))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |       50 | 0003
  50 | 0006 |   |      |       53 | 0006
  75 | 0009 |   |      |      103 | 0009
 100 | 0001 |   |      |      106 | 0001
 125 | 0004 |   |      |      156 | 0004
 175 | 0010 |   |      |      209 | 0010
 200 | 0002 |   |      |      212 | 0002
 225 | 0005 |   |      |      262 | 0005
 275 | 0000 |   |      |      315 | 0000
 300 | 0003 |   |      |      318 | 0003
 325 | 0006 |   |      |      368 | 0006
 350 | 0009 |   |      |      371 | 0009
 375 | 0001 |   |      |      421 | 0001
 400 | 0004 |   |      |      424 | 0004
 450 | 0010 |   |      |      477 | 0010
 475 | 0002 |   |      |      480 | 0002
 500 | 0005 |   |      |      530 | 0005
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
               ->  Seq Scan on plt1_p3 t1_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a |  c   | b |  c   | ?column? |  c   
---+------+---+------+----------+------
 0 | 0000 | 0 | 0000 |        0 | 0000
   |      |   |      |       50 | 0003
   |      |   |      |       53 | 0006
   |      |   |      |      103 | 0009
   |      |   |      |      106 | 0001
   |      |   |      |      156 | 0004
   |      |   |      |      209 | 0010
   |      |   |      |      212 | 0002
   |      |   |      |      262 | 0005
   |      |   |      |      315 | 0000
   |      |   |      |      318 | 0003
   |      |   |      |      368 | 0006
   |      |   |      |      371 | 0009
   |      |   |      |      421 | 0001
   |      |   |      |      424 | 0004
   |      |   |      |      477 | 0010
   |      |   |      |      480 | 0002
   |      |   |      |      530 | 0005
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
   0 | 0000 |  0 | 0000 |        0 | 0000
  25 | 0003 |    |      |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 175 | 0010 |    |      |      209 | 0010
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 275 | 0000 |    |      |      315 | 0000
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 450 | 0010 |    |      |      477 | 0010
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 | 0010 |          | 
     |      | 25 | 0000 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 | 0010 |          | 
(35 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Merge Join
                           Merge Cond: ((t1_3.c)::text = (ltrim((t2.c)::text, 'A'::text)))
                           ->  Sort
                                 Sort Key: t1_3.c
                                 ->  Append
                                       ->  Seq Scan on plt2_p1 t1_3
                                       ->  Seq Scan on plt2_p2 t1_4
                                       ->  Seq Scan on plt2_p3 t1_5
                           ->  Sort
                                 Sort Key: (ltrim((t2.c)::text, 'A'::text))
                                 ->  Result
                                       ->  Append
                                             ->  Seq Scan on plt1_e_p1 t2
                                             ->  Seq Scan on plt1_e_p2 t2_1
                                             ->  Seq Scan on plt1_e_p3 t2_2
(29 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 175 | 34 | 0010
 200 | 12 | 0002
 225 | 37 | 0005
 275 | 40 | 0000
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 450 | 27 | 0010
 475 |  5 | 0002
 500 | 30 | 0005
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Hash Semi Join
                           Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t1_3
                                 ->  Seq Scan on plt2_p2 t1_4
                                 ->  Seq Scan on plt2_p3 t1_5
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_e_p1 t1_6
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p2 t1_7
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p3 t1_8
                                             Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 175 | 34 | 0010
 200 | 12 | 0002
 225 | 37 | 0005
 275 | 40 | 0000
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 450 | 27 | 0010
 475 |  5 | 0002
 500 | 30 | 0005
(14 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
(21 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |          avg           |  c   
-----+------+------------------------+------
   0 | 0000 | 0.00000000000000000000 | 0000
 275 | 0000 |                        | 
 475 | 0001 |                        | 
 675 | 0002 |                        | 
 325 | 0003 |                        | 
 525 | 0004 |                        | 
 725 | 0005 |                        | 
 375 | 0006 |                        | 
 425 | 0009 |                        | 
 625 | 0010 |                        | 
     |      |    25.0000000000000000 | 0000
     |      |    12.5000000000000000 | 0001
     |      |    12.5000000000000000 | 0002
     |      |    12.5000000000000000 | 0005
     |      |    12.5000000000000000 | 0006
     |      |    12.5000000000000000 | 0007
     |      |    12.5000000000000000 | 0008
     |      |    12.5000000000000000 | 0009
     |      |    12.5000000000000000 | 0010
(19 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
(21 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |          avg           |  c   |         avg         
-----+------+-----+------------------------+------+---------------------
   0 | 0000 |  25 | 0.00000000000000000000 | 0000 | 50.0000000000000000
 275 | 0000 |  25 |                        |      |                    
 475 | 0001 |  50 |                        |      |                    
 675 | 0002 |  50 |                        |      |                    
 325 | 0003 |  50 |                        |      |                    
 525 | 0004 |  50 |                        |      |                    
 725 | 0005 |  50 |                        |      |                    
 375 | 0006 |  50 |                        |      |                    
 425 | 0009 |  50 |                        |      |                    
 625 | 0010 |  50 |                        |      |                    
     |      |     |    25.0000000000000000 | 0000 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0009 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0010 | 50.0000000000000000
(19 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt2_e_p1 t2
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Seq Scan on plt2_e_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3 t1_2
                           Filter: ((a % 25) = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   
-----+------+---+------
   0 | 0000 | 0 | 0000
  25 | 0003 |   | 
  50 | 0006 |   | 
  75 | 0009 |   | 
 100 | 0001 |   | 
 125 | 0004 |   | 
 175 | 0010 |   | 
 200 | 0002 |   | 
 225 | 0005 |   | 
 275 | 0000 |   | 
 300 | 0003 |   | 
 325 | 0006 |   | 
 350 | 0009 |   | 
 375 | 0001 |   | 
 400 | 0004 |   | 
 450 | 0010 |   | 
 475 | 0002 |   | 
 500 | 0005 |   | 
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t1
               ->  Seq Scan on plt1_e_p2 t1_1
               ->  Seq Scan on plt1_e_p3 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1 t2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2 t2_1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3 t2_2
                           Filter: ((b % 25) = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a |  c   | b  |  c   
---+------+----+------
 0 | 0000 |  0 | 0000
   |      |  0 | 0001
   |      |  0 | 0002
   |      |  0 | 0005
   |      |  0 | 0006
   |      |  0 | 0007
   |      |  0 | 0008
   |      |  0 | 0009
   |      |  0 | 0010
   |      | 25 | 0000
   |      | 25 | 0001
   |      | 25 | 0002
   |      | 25 | 0005
   |      | 25 | 0006
   |      | 25 | 0007
   |      | 25 | 0008
   |      | 25 | 0009
   |      | 25 | 0010
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_e_p1.a = plt2_e_p1.b) AND (ltrim((plt1_e_p1.c)::text, 'A'::text) = ltrim((plt2_e_p1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_e_p2
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_e_p3
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3
                           Filter: ((b % 25) = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
   0 | 0000 |  0 | 0000
  25 | 0003 |    | 
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 175 | 0010 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 275 | 0000 |    | 
 300 | 0003 |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 450 | 0010 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      |  0 | 0010
     |      | 25 | 0000
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
     |      | 25 | 0010
(35 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1.c)::text = (c)::text)
(26 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
   0 |  0 | 0000 | 0000 | 0000 | 0000
  25 | 25 | 0003 |      |      | 
  50 |  3 | 0006 | 0006 | 0006 | 0006
  75 | 28 | 0009 | 0009 | 0009 | 0009
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 |      |      | 
 175 | 34 | 0010 | 0010 | 0010 | 0010
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 275 | 40 | 0000 | 0000 | 0000 | 0000
 300 | 18 | 0003 |      |      | 
 325 | 43 | 0006 | 0006 | 0006 | 0006
 350 | 21 | 0009 | 0009 | 0009 | 0009
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 |      |      | 
 450 | 27 | 0010 | 0010 | 0010 | 0010
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(18 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(30 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
               ->  Seq Scan on plt1_p3 t1_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a |  c   | b |  c   | ?column? |  c   
---+------+---+------+----------+------
 0 | 0000 | 0 | 0000 |        0 | 0000
   |      |   |      |       50 | 0003
   |      |   |      |       53 | 0006
   |      |   |      |      103 | 0009
   |      |   |      |      106 | 0001
   |      |   |      |      156 | 0004
   |      |   |      |      209 | 0010
   |      |   |      |      212 | 0002
   |      |   |      |      262 | 0005
   |      |   |      |      315 | 0000
   |      |   |      |      318 | 0003
   |      |   |      |      368 | 0006
   |      |   |      |      371 | 0009
   |      |   |      |      421 | 0001
   |      |   |      |      424 | 0004
   |      |   |      |      477 | 0010
   |      |   |      |      480 | 0002
   |      |   |      |      530 | 0005
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
   0 | 0000 |  0 | 0000 |        0 | 0000
  25 | 0003 |    |      |       50 | 0003
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 175 | 0010 |    |      |      209 | 0010
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 275 | 0000 |    |      |      315 | 0000
 300 | 0003 |    |      |      318 | 0003
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 450 | 0010 |    |      |      477 | 0010
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 | 0010 |          | 
     |      | 25 | 0000 |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 | 0010 |          | 
(35 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Hash Semi Join
                           Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t1_3
                                 ->  Seq Scan on plt2_p2 t1_4
                                 ->  Seq Scan on plt2_p3 t1_5
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_e_p1 t1_6
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p2 t1_7
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p3 t1_8
                                             Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 175 | 34 | 0010
 200 | 12 | 0002
 225 | 37 | 0005
 275 | 40 | 0000
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 450 | 27 | 0010
 475 |  5 | 0002
 500 | 30 | 0005
(14 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 329 | 0 | 0010
 376 | 0 | 0002
 423 | 0 | 0005
(7 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t5.c)::text)
                           ->  Merge Join
                                 Merge Cond: ((t1.c)::text = (t3.c)::text)
                                 ->  Sort
                                       Sort Key: t1.c
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t3.c
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt1_p1 t5
                                       Filter: (b = 0)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t5_1.c)::text)
                           ->  Merge Join
                                 Merge Cond: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Sort
                                       Sort Key: t1_1.c
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t3_1.c
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt1_p2 t5_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t5_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t5_2
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t2_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t2_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
(65 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 329 | 0010 | 0 | 0010 | 329 | 0010
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(7 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               ->  Hash Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     ->  Append
                           ->  Merge Join
                                 Merge Cond: ((t2.c)::text = (t4.c)::text)
                                 ->  Sort
                                       Sort Key: t2.c
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t4.c
                                       ->  Seq Scan on plt2_p1 t4
                                             Filter: (b = 0)
                           ->  Merge Join
                                 Merge Cond: ((t2_1.c)::text = (t4_1.c)::text)
                                 ->  Sort
                                       Sort Key: t2_1.c
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t4_1.c
                                       ->  Seq Scan on plt2_p2 t4_1
                                             Filter: (b = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.c)::text = (t4_2.c)::text)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p3 t4_2
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t3
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t3_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p3 t3_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
(60 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 329 | 0010 | 0 | 0010 | 329 | 0010
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
     |      |   |      |     | 
     |      |   |      |     | 
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t3.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Merge Join
                           Merge Cond: ((t1.c)::text = (t3.c)::text)
                           ->  Sort
                                 Sort Key: t1.c
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                           ->  Sort
                                 Sort Key: t3.c
                                 ->  Seq Scan on plt1_p1 t3
                                       Filter: (b = 0)
                     ->  Merge Join
                           Merge Cond: ((t1_1.c)::text = (t3_1.c)::text)
                           ->  Sort
                                 Sort Key: t1_1.c
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                           ->  Sort
                                 Sort Key: t3_1.c
                                 ->  Seq Scan on plt1_p2 t3_1
                                       Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t3_2.c)::text)
                           ->  Seq Scan on plt1_p3 t1_2
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t3_2
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t2_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t2_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Hash Join
                     Hash Cond: ((t5.c)::text = (t4.c)::text)
                     ->  Append
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
(60 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 329 | 0010 | 0 | 0010 | 329 | 0010
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(7 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Hash Right Join
               Hash Cond: ((t3.c)::text = (t4.c)::text)
               ->  Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Merge Join
                                 Merge Cond: ((t1.c)::text = (t3.c)::text)
                                 ->  Sort
                                       Sort Key: t1.c
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t3.c
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                           ->  Merge Join
                                 Merge Cond: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Sort
                                       Sort Key: t1_1.c
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t3_1.c
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
(60 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 329 | 0010 | 0 | 0010 | 329 | 0010
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
     |      |   |      |     | 
     |      |   |      |     | 
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Left Join
         Hash Cond: ((t4.c)::text = (t3.c)::text)
         ->  Hash Join
               Hash Cond: ((t5.c)::text = (t4.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt1_p1 t1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t1_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p3 t1_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t3.c)::text = (t2.c)::text)
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                                 ->  Hash
                                       ->  Append
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 329 | 0010 | 0 | 0010 | 329 | 0010
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(7 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- only default is common bounds in both relation
-- partition-wise-join not possible as default list is different
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0003','0004');
CREATE TABLE plt1_p3 PARTITION OF plt1 DEFAULT;
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (5,6,7,8);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0005','0006');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0007','0008');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (1,2,3,4);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0003','0004');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e DEFAULT;
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (5,6,7,8);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0005','0006');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0007','0008');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (1,2,3,4);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Join Filter: ((t1.b + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
 141 | 0009 | 141 | 0009
 329 | 0010 | 329 | 0010
(3 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  47 | 0003 |     | 
 141 | 0009 | 141 | 0009
 188 | 0001 |     | 
 235 | 0004 |     | 
 329 | 0010 | 329 | 0010
 376 | 0002 |     | 
(7 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (0,0,0000)   | (0,0,0000)
 (47,0,0003)  | 
 (141,0,0009) | (141,0,0009)
 (188,0,0001) | 
 (235,0,0004) | 
 (329,0,0010) | (329,0,0010)
 (376,0,0002) | 
(7 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Hash Left Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
 141 | 0009 | 141 | 0009
 329 | 0010 | 329 | 0010
     |      |  94 | 0006
     |      | 470 | 0008
     |      | 423 | 0005
     |      | 282 | 0007
(7 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Hash Full Join
         Hash Cond: ((t2.c)::text = (t1.c)::text)
         Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Seq Scan on plt1_p3 t1_2
(14 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
   0 | 0000 |   0 | 0000
  47 | 0003 |     | 
 141 | 0009 | 141 | 0009
 188 | 0001 |     | 
 235 | 0004 |     | 
 329 | 0010 | 329 | 0010
 376 | 0002 |     | 
     |      |  94 | 0006
     |      | 282 | 0007
     |      | 423 | 0005
     |      | 470 | 0008
(11 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.c)::text = (plt1_p1.c)::text)
               Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
               Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                     ->  Seq Scan on plt2_p2
                     ->  Seq Scan on plt2_p3
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                           ->  Seq Scan on plt1_p2
                           ->  Seq Scan on plt1_p3
(16 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   | c 
------+---
 0001 | 
(1 row)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Seq Scan on plt2_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                 ->  Seq Scan on plt1_p2 t2_1
                                 ->  Seq Scan on plt1_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Anti Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(16 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 0003
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
(4 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Anti Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t2
                     ->  Seq Scan on plt1_p2 t2_1
                     ->  Seq Scan on plt1_p3 t2_2
(16 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 282 | 0 | 0007
 423 | 0 | 0005
 470 | 0 | 0008
(4 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1.c)::text = (c)::text)
(26 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0000 | 0000 | 0000
 0001 |      | 
 0002 |      | 
 0003 |      | 
 0004 |      | 
 0009 | 0009 | 0009
 0010 | 0010 | 0010
(7 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p3.c, plt2_p1.c
   ->  Hash Right Join
         Hash Cond: ((plt2_p1.c)::text = (plt1_p3.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1
                     Filter: ((c)::text > '0002'::text)
               ->  Seq Scan on plt2_p2
                     Filter: ((c)::text > '0002'::text)
               ->  Seq Scan on plt2_p3
                     Filter: ((c)::text > '0002'::text)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p3
                           Filter: (((c)::text < '0000'::text) AND (b = 0))
(15 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 247.5000000000000000 | 22.7173913043478261 | 270.2173913043478261 | 0000 | 0000 | 0000
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
 252.0000000000000000 | 22.2222222222222222 | 274.2222222222222222 | 0010 | 0010 | 0010
(3 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 247.5000000000000000 | 22.7173913043478261 | 270.2173913043478261 | 0000 | 0000 | 0000
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
 252.0000000000000000 | 22.2222222222222222 | 274.2222222222222222 | 0010 | 0010 | 0010
(3 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t3
               ->  Seq Scan on plt1_e_p2 t3_1
               ->  Seq Scan on plt1_e_p3 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |       50 | 0003
  75 | 0009 |   |      |      103 | 0009
 100 | 0001 |   |      |      106 | 0001
 125 | 0004 |   |      |      156 | 0004
 175 | 0010 |   |      |      209 | 0010
 200 | 0002 |   |      |      212 | 0002
 275 | 0000 |   |      |      315 | 0000
 300 | 0003 |   |      |      318 | 0003
 350 | 0009 |   |      |      371 | 0009
 375 | 0001 |   |      |      421 | 0001
 400 | 0004 |   |      |      424 | 0004
 450 | 0010 |   |      |      477 | 0010
 475 | 0002 |   |      |      480 | 0002
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t3
               ->  Seq Scan on plt1_e_p2 t3_1
               ->  Seq Scan on plt1_e_p3 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |          | 
  75 | 0009 |   |      |          | 
 100 | 0001 |   |      |          | 
 125 | 0004 |   |      |          | 
 175 | 0010 |   |      |          | 
 200 | 0002 |   |      |          | 
 275 | 0000 |   |      |          | 
 300 | 0003 |   |      |          | 
 350 | 0009 |   |      |          | 
 375 | 0001 |   |      |          | 
 400 | 0004 |   |      |          | 
 450 | 0010 |   |      |          | 
 475 | 0002 |   |      |          | 
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Hash Right Join
                           Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: (((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)) AND (t1_2.a = t3_2.a))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b |  c   | ?column? |  c   
-----+------+---+------+----------+------
   0 | 0000 | 0 | 0000 |        0 | 0000
  25 | 0003 |   |      |       50 | 0003
  75 | 0009 |   |      |      103 | 0009
 100 | 0001 |   |      |      106 | 0001
 125 | 0004 |   |      |      156 | 0004
 175 | 0010 |   |      |      209 | 0010
 200 | 0002 |   |      |      212 | 0002
 275 | 0000 |   |      |      315 | 0000
 300 | 0003 |   |      |      318 | 0003
 350 | 0009 |   |      |      371 | 0009
 375 | 0001 |   |      |      421 | 0001
 400 | 0004 |   |      |      424 | 0004
 450 | 0010 |   |      |      477 | 0010
 475 | 0002 |   |      |      480 | 0002
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
               ->  Seq Scan on plt1_p3 t1_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a |  c   | b |  c   | ?column? |  c   
---+------+---+------+----------+------
 0 | 0000 | 0 | 0000 |        0 | 0000
   |      |   |      |       50 | 0003
   |      |   |      |      103 | 0009
   |      |   |      |      106 | 0001
   |      |   |      |      156 | 0004
   |      |   |      |      209 | 0010
   |      |   |      |      212 | 0002
   |      |   |      |      315 | 0000
   |      |   |      |      318 | 0003
   |      |   |      |      371 | 0009
   |      |   |      |      421 | 0001
   |      |   |      |      424 | 0004
   |      |   |      |      477 | 0010
   |      |   |      |      480 | 0002
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
   0 | 0000 |  0 | 0000 |        0 | 0000
  25 | 0003 |    |      |       50 | 0003
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 175 | 0010 |    |      |      209 | 0010
 200 | 0002 |    |      |      212 | 0002
 275 | 0000 |    |      |      315 | 0000
 300 | 0003 |    |      |      318 | 0003
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 450 | 0010 |    |      |      477 | 0010
 475 | 0002 |    |      |      480 | 0002
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 | 0010 |          | 
     |      | 25 | 0000 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 | 0010 |          | 
(27 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Hash Join
                           Hash Cond: ((t1_3.c)::text = ltrim((t2.c)::text, 'A'::text))
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t1_3
                                 ->  Seq Scan on plt2_p2 t1_4
                                 ->  Seq Scan on plt2_p3 t1_5
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_e_p1 t2
                                       ->  Seq Scan on plt1_e_p2 t2_1
                                       ->  Seq Scan on plt1_e_p3 t2_2
(25 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  75 | 28 | 0009
 175 | 34 | 0010
 275 | 40 | 0000
 350 | 21 | 0009
 450 | 27 | 0010
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Hash Semi Join
                           Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t1_3
                                 ->  Seq Scan on plt2_p2 t1_4
                                 ->  Seq Scan on plt2_p3 t1_5
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_e_p1 t1_6
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p2 t1_7
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p3 t1_8
                                             Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  75 | 28 | 0009
 175 | 34 | 0010
 275 | 40 | 0000
 350 | 21 | 0009
 450 | 27 | 0010
(6 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
(21 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |          avg           |  c   
-----+------+------------------------+------
   0 | 0000 | 0.00000000000000000000 | 0000
 275 | 0000 |                        | 
 475 | 0001 |                        | 
 675 | 0002 |                        | 
 325 | 0003 |                        | 
 525 | 0004 |                        | 
 425 | 0009 |                        | 
 625 | 0010 |                        | 
     |      |    25.0000000000000000 | 0000
     |      |    12.5000000000000000 | 0005
     |      |    12.5000000000000000 | 0006
     |      |    12.5000000000000000 | 0007
     |      |    12.5000000000000000 | 0008
     |      |    12.5000000000000000 | 0009
     |      |    12.5000000000000000 | 0010
(15 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
(21 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |          avg           |  c   |         avg         
-----+------+-----+------------------------+------+---------------------
   0 | 0000 |  25 | 0.00000000000000000000 | 0000 | 50.0000000000000000
 275 | 0000 |  25 |                        |      |                    
 475 | 0001 |  50 |                        |      |                    
 675 | 0002 |  50 |                        |      |                    
 325 | 0003 |  50 |                        |      |                    
 525 | 0004 |  50 |                        |      |                    
 425 | 0009 |  50 |                        |      |                    
 625 | 0010 |  50 |                        |      |                    
     |      |     |    25.0000000000000000 | 0000 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0009 | 50.0000000000000000
     |      |     |    12.5000000000000000 | 0010 | 50.0000000000000000
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt2_e_p1 t2
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Seq Scan on plt2_e_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3 t1_2
                           Filter: ((a % 25) = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   
-----+------+---+------
   0 | 0000 | 0 | 0000
  25 | 0003 |   | 
  75 | 0009 |   | 
 100 | 0001 |   | 
 125 | 0004 |   | 
 175 | 0010 |   | 
 200 | 0002 |   | 
 275 | 0000 |   | 
 300 | 0003 |   | 
 350 | 0009 |   | 
 375 | 0001 |   | 
 400 | 0004 |   | 
 450 | 0010 |   | 
 475 | 0002 |   | 
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t1
               ->  Seq Scan on plt1_e_p2 t1_1
               ->  Seq Scan on plt1_e_p3 t1_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1 t2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2 t2_1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3 t2_2
                           Filter: ((b % 25) = 0)
(16 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a |  c   | b  |  c   
---+------+----+------
 0 | 0000 |  0 | 0000
   |      |  0 | 0005
   |      |  0 | 0006
   |      |  0 | 0007
   |      |  0 | 0008
   |      |  0 | 0009
   |      |  0 | 0010
   |      | 25 | 0000
   |      | 25 | 0005
   |      | 25 | 0006
   |      | 25 | 0007
   |      | 25 | 0008
   |      | 25 | 0009
   |      | 25 | 0010
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_e_p1.a = plt2_e_p1.b) AND (ltrim((plt1_e_p1.c)::text, 'A'::text) = ltrim((plt2_e_p1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_e_p2
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_e_p3
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3
                           Filter: ((b % 25) = 0)
(19 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
   0 | 0000 |  0 | 0000
  25 | 0003 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 175 | 0010 |    | 
 200 | 0002 |    | 
 275 | 0000 |    | 
 300 | 0003 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 450 | 0010 |    | 
 475 | 0002 |    | 
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      |  0 | 0010
     |      | 25 | 0000
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
     |      | 25 | 0010
(27 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1.c)::text = (c)::text)
(26 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
   0 |  0 | 0000 | 0000 | 0000 | 0000
  25 | 25 | 0003 |      |      | 
  75 | 28 | 0009 | 0009 | 0009 | 0009
 100 |  6 | 0001 |      |      | 
 125 | 31 | 0004 |      |      | 
 175 | 34 | 0010 | 0010 | 0010 | 0010
 200 | 12 | 0002 |      |      | 
 275 | 40 | 0000 | 0000 | 0000 | 0000
 300 | 18 | 0003 |      |      | 
 350 | 21 | 0009 | 0009 | 0009 | 0009
 375 | 46 | 0001 |      |      | 
 400 | 24 | 0004 |      |      | 
 450 | 27 | 0010 | 0010 | 0010 | 0010
 475 |  5 | 0002 |      |      | 
(14 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(30 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b | phv | ltrim | phv  
-----+-----+---+-----+-------+------
 200 |  50 |   |     | 0002  | 0002
 200 |  50 |   |     | 0002  | 0002
 475 |  50 |   |     | 0002  | 0002
 475 |  50 |   |     | 0002  | 0002
(4 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
               ->  Seq Scan on plt1_p3 t1_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p3 t3_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a |  c   | b |  c   | ?column? |  c   
---+------+---+------+----------+------
 0 | 0000 | 0 | 0000 |        0 | 0000
   |      |   |      |       50 | 0003
   |      |   |      |      103 | 0009
   |      |   |      |      106 | 0001
   |      |   |      |      156 | 0004
   |      |   |      |      209 | 0010
   |      |   |      |      212 | 0002
   |      |   |      |      315 | 0000
   |      |   |      |      318 | 0003
   |      |   |      |      371 | 0009
   |      |   |      |      421 | 0001
   |      |   |      |      424 | 0004
   |      |   |      |      477 | 0010
   |      |   |      |      480 | 0002
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(29 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
   0 | 0000 |  0 | 0000 |        0 | 0000
  25 | 0003 |    |      |       50 | 0003
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 175 | 0010 |    |      |      209 | 0010
 200 | 0002 |    |      |      212 | 0002
 275 | 0000 |    |      |      315 | 0000
 300 | 0003 |    |      |      318 | 0003
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 450 | 0010 |    |      |      477 | 0010
 475 | 0002 |    |      |      480 | 0002
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 | 0010 |          | 
     |      | 25 | 0000 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 | 0010 |          | 
(27 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t1_3.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t1_3.c)::text
                     ->  Hash Semi Join
                           Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t1_3
                                 ->  Seq Scan on plt2_p2 t1_4
                                 ->  Seq Scan on plt2_p3 t1_5
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_e_p1 t1_6
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p2 t1_7
                                             Filter: ((a % 25) = 0)
                                       ->  Seq Scan on plt1_e_p3 t1_8
                                             Filter: ((a % 25) = 0)
(28 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
   0 |  0 | 0000
  75 | 28 | 0009
 175 | 34 | 0010
 275 | 40 | 0000
 350 | 21 | 0009
 450 | 27 | 0010
(6 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1_2.a, t2_2.b, t3_2.c
         ->  Parallel Hash Join
               Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
               Join Filter: (((t1_2.b + t2_2.b) + t3_2.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t2_2.c)::text = (t3_2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt2_p3 t2_2
                           ->  Parallel Seq Scan on plt2_p1 t2
                           ->  Parallel Seq Scan on plt2_p2 t2_1
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p3 t3_2
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
   0 | 0 | 0000
 141 | 0 | 0009
 329 | 0 | 0010
(3 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop
         Join Filter: ((t2.c)::text = (t1.c)::text)
         ->  Nested Loop
               Join Filter: ((t2.c)::text = (t4.c)::text)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Merge Join
                                 Merge Cond: ((t3.c)::text = (t5.c)::text)
                                 ->  Sort
                                       Sort Key: t3.c
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t5.c
                                       ->  Seq Scan on plt1_p1 t5
                                             Filter: (b = 0)
                           ->  Merge Join
                                 Merge Cond: ((t3_1.c)::text = (t5_1.c)::text)
                                 ->  Sort
                                       Sort Key: t3_1.c
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t5_1.c
                                       ->  Seq Scan on plt1_p2 t5_1
                                             Filter: (b = 0)
                           ->  Hash Join
                                 Hash Cond: ((t3_2.c)::text = (t5_2.c)::text)
                                 ->  Seq Scan on plt1_p3 t3_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t5_2
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
(58 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
 141 | 0009 | 0 | 0009 | 141 | 0009
 329 | 0010 | 0 | 0010 | 329 | 0010
(3 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Nested Loop
               Join Filter: ((t1.c)::text = (t3.c)::text)
               ->  Hash Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     ->  Append
                           ->  Merge Join
                                 Merge Cond: ((t2.c)::text = (t4.c)::text)
                                 ->  Sort
                                       Sort Key: t2.c
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t4.c
                                       ->  Seq Scan on plt2_p1 t4
                                             Filter: (b = 0)
                           ->  Merge Join
                                 Merge Cond: ((t2_1.c)::text = (t4_1.c)::text)
                                 ->  Sort
                                       Sort Key: t2_1.c
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                 ->  Sort
                                       Sort Key: t4_1.c
                                       ->  Seq Scan on plt2_p2 t4_1
                                             Filter: (b = 0)
                           ->  Hash Join
                                 Hash Cond: ((t2_2.c)::text = (t4_2.c)::text)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p3 t4_2
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
               ->  Append
                     ->  Seq Scan on plt1_p1 t3
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t3_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t3_2
                           Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
(59 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
 141 | 0009 | 0 | 0009 | 141 | 0009
 329 | 0010 | 0 | 0010 | 329 | 0010
     |      |   |      |     | 
     |      |   |      |     | 
     |      |   |      |     | 
     |      |   |      |     | 
(7 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Nested Loop Left Join
         Join Filter: ((t3.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t5.c)::text = (t4.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
         ->  Materialize
               ->  Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt1_p1 t1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t1_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p3 t1_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t3.c)::text = (t2.c)::text)
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                                 ->  Hash
                                       ->  Append
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
 141 | 0009 | 0 | 0009 | 141 | 0009
 329 | 0010 | 0 | 0010 | 329 | 0010
(3 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Nested Loop Left Join
               Join Filter: ((t3.c)::text = (t4.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
               ->  Materialize
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = (t2.c)::text)
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
                           ->  Hash
                                 ->  Hash Join
                                       Hash Cond: ((t3.c)::text = (t2.c)::text)
                                       ->  Append
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                                       ->  Hash
                                             ->  Append
                                                   ->  Seq Scan on plt2_p1 t2
                                                         Filter: (b = 0)
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
 141 | 0009 | 0 | 0009 | 141 | 0009
 329 | 0010 | 0 | 0010 | 329 | 0010
     |      |   |      |     | 
     |      |   |      |     | 
     |      |   |      |     | 
     |      |   |      |     | 
(7 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Nested Loop Left Join
         Join Filter: ((t3.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t5.c)::text = (t4.c)::text)
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
         ->  Materialize
               ->  Hash Right Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt1_p1 t1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t1_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p3 t1_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t3.c)::text = (t2.c)::text)
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                                 ->  Hash
                                       ->  Append
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
(49 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
   0 | 0000 | 0 | 0000 |   0 | 0000
 141 | 0009 | 0 | 0009 | 141 | 0009
 329 | 0010 | 0 | 0010 | 329 | 0010
(3 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- default with NULL list value.
-- both relation have NULL value with same list bounds and a default partition
-- partition-wise-join possible for all cases.
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_p3 PARTITION OF plt1 DEFAULT;
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt1 SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt2 SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e DEFAULT;
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt1_e SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt2_e SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Join Filter: ((t1.b + t2.b) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Join Filter: ((t1_1.b + t2_1.b) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Join Filter: ((t1_2.b + t2_2.b) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(8 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                         QUERY PLAN                         
------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Hash Left Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Left Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Left Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 |      |     | 
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
(9 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_p1 t2
               ->  Hash Left Join
                     Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                     Filter: ((t1_1.b + COALESCE(t2_1.b, 0)) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_p2 t2_1
               ->  Hash Left Join
                     Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                     Filter: ((t1_2.b + COALESCE(t2_2.b, 0)) = 0)
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_p3 t2_2
(22 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (47,0,)      | 
 (94,0,0006)  | (94,0,0006)
 (141,0,0009) | (141,0,0009)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | (235,0,0004)
 (282,0,0007) | (282,0,0007)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
 (470,0,0008) | (470,0,0008)
(9 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Result
         ->  Append
               ->  Hash Left Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Seq Scan on plt1_p1 t1
               ->  Hash Left Join
                     Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                     Filter: ((COALESCE(t1_1.b, 0) + t2_1.b) = 0)
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t1_1
               ->  Hash Left Join
                     Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                     Filter: ((COALESCE(t1_2.b, 0) + t2_2.b) = 0)
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t1_2
(22 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
     |      |  47 | 
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
               ->  Seq Scan on plt1_p1 t1
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Hash Full Join
               Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
               Filter: ((COALESCE(t1_1.b, 0) + COALESCE(t2_1.b, 0)) = 0)
               ->  Seq Scan on plt1_p2 t1_1
               ->  Hash
                     ->  Seq Scan on plt2_p2 t2_1
         ->  Hash Full Join
               Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
               Filter: ((COALESCE(t1_2.b, 0) + COALESCE(t2_2.b, 0)) = 0)
               ->  Seq Scan on plt1_p3 t1_2
               ->  Hash
                     ->  Seq Scan on plt2_p3 t2_2
(21 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 |      |     | 
  94 | 0006 |  94 | 0006
 141 | 0009 | 141 | 0009
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 282 | 0007 | 282 | 0007
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
 470 | 0008 | 470 | 0008
     |      |  47 | 
(10 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
                     Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
                     ->  Seq Scan on plt1_p1
                     ->  Hash
                           ->  Seq Scan on plt2_p1
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     Join Filter: ((plt2_p2.b = 0) AND (plt1_p2.b = 0))
                     Filter: ((('0001'::text) = (plt1_p2.c)::text) OR (('0002'::text) = (plt2_p2.c)::text))
                     ->  Seq Scan on plt1_p2
                     ->  Hash
                           ->  Seq Scan on plt2_p2
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     Join Filter: ((plt2_p3.b = 0) AND (plt1_p3.b = 0))
                     Filter: ((('0001'::text) = (plt1_p3.c)::text) OR (('0002'::text) = (plt2_p3.c)::text))
                     ->  Seq Scan on plt1_p3
                     ->  Hash
                           ->  Seq Scan on plt2_p3
(25 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Seq Scan on plt2_p1 t2
               ->  Materialize
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(21 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Nested Loop
               Join Filter: ((t1.c)::text = (t2.c)::text)
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Seq Scan on plt1_p1 t2
               ->  Materialize
                     ->  Seq Scan on plt2_p1 t1
                           Filter: (b = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(21 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Hash Anti Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on plt2_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a  | b | c 
----+---+---
 47 | 0 | 
(1 row)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Append
         ->  Hash Anti Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Hash
                     ->  Seq Scan on plt1_p1 t2
         ->  Nested Loop Anti Join
               Join Filter: ((t1_1.c)::text = (t2_1.c)::text)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t2_1
         ->  Nested Loop Anti Join
               Join Filter: ((t1_2.c)::text = (t2_2.c)::text)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p3 t2_2
(19 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a  | b | c 
----+---+---
 47 | 0 | 
(1 row)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: (b = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0004 | 0004 | 0004
 0005 | 0005 | 0005
 0006 | 0006 | 0006
 0007 | 0007 | 0007
 0008 | 0008 | 0008
 0009 | 0009 | 0009
      |      | 
(9 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p3.c, plt2_p3.c
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((plt2_p3.c)::text = (plt1_p3.c)::text)
               ->  Seq Scan on plt2_p3
                     Filter: ((c)::text > '0002'::text)
               ->  Hash
                     ->  Seq Scan on plt1_p3
                           Filter: (((c)::text < '0000'::text) AND (b = 0))
(10 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(8 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p3 t3_2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(27 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
 249.0000000000000000 | 22.3555555555555556 | 271.3555555555555556 | 0007 | 0007 | 0007
 250.0000000000000000 | 22.3111111111111111 | 272.3111111111111111 | 0008 | 0008 | 0008
 251.0000000000000000 | 22.2666666666666667 | 273.2666666666666667 | 0009 | 0009 | 0009
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t1_1.a) AND (ltrim((t3_1.c)::text, 'A'::text) = (t1_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t1_2.a) AND (ltrim((t3_2.c)::text, 'A'::text) = (t1_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? |  c   
-----+------+---+---+----------+------
  25 |      |   |   |          | 
  50 | 0006 |   |   |       53 | 0006
  75 | 0009 |   |   |      103 | 0009
 100 | 0001 |   |   |      106 | 0001
 125 | 0004 |   |   |      156 | 0004
 150 | 0007 |   |   |      159 | 0007
 200 | 0002 |   |   |      212 | 0002
 225 | 0005 |   |   |      262 | 0005
 250 | 0008 |   |   |      265 | 0008
 300 |      |   |   |          | 
 325 | 0006 |   |   |      368 | 0006
 350 | 0009 |   |   |      371 | 0009
 375 | 0001 |   |   |      421 | 0001
 400 | 0004 |   |   |      424 | 0004
 425 | 0007 |   |   |      427 | 0007
 475 | 0002 |   |   |      480 | 0002
 500 | 0005 |   |   |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
                     ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_1.a = t2_1.b) AND (ltrim((t3_1.c)::text, 'A'::text) = (t2_1.c)::text))
                     ->  Seq Scan on plt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t3_2.a = t2_2.b) AND (ltrim((t3_2.c)::text, 'A'::text) = (t2_2.c)::text))
                     ->  Seq Scan on plt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? | c 
-----+------+---+---+----------+---
  25 |      |   |   |          | 
  50 | 0006 |   |   |          | 
  75 | 0009 |   |   |          | 
 100 | 0001 |   |   |          | 
 125 | 0004 |   |   |          | 
 150 | 0007 |   |   |          | 
 200 | 0002 |   |   |          | 
 225 | 0005 |   |   |          | 
 250 | 0008 |   |   |          | 
 300 |      |   |   |          | 
 325 | 0006 |   |   |          | 
 350 | 0009 |   |   |          | 
 375 | 0001 |   |   |          | 
 400 | 0004 |   |   |          | 
 425 | 0007 |   |   |          | 
 475 | 0002 |   |   |          | 
 500 | 0005 |   |   |          | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Seq Scan on plt2_p1 t2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                                 ->  Seq Scan on plt1_p1 t1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_1.b = t1_1.a) AND ((t2_1.c)::text = (t1_1.c)::text))
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                                 ->  Seq Scan on plt1_p2 t1_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t2_2.b = t1_2.a) AND ((t2_2.c)::text = (t1_2.c)::text))
                     ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (((t1_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)) AND (t1_2.a = t3_2.a))
                                 ->  Seq Scan on plt1_p3 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? |  c   
-----+------+---+---+----------+------
  50 | 0006 |   |   |       53 | 0006
  75 | 0009 |   |   |      103 | 0009
 100 | 0001 |   |   |      106 | 0001
 125 | 0004 |   |   |      156 | 0004
 150 | 0007 |   |   |      159 | 0007
 200 | 0002 |   |   |      212 | 0002
 225 | 0005 |   |   |      262 | 0005
 250 | 0008 |   |   |      265 | 0008
 325 | 0006 |   |   |      368 | 0006
 350 | 0009 |   |   |      371 | 0009
 375 | 0001 |   |   |      421 | 0001
 400 | 0004 |   |   |      424 | 0004
 425 | 0007 |   |   |      427 | 0007
 475 | 0002 |   |   |      480 | 0002
 500 | 0005 |   |   |      530 | 0005
     |      |   |   |       50 | 
     |      |   |   |      318 | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a | c | b | c | ?column? |  c   
---+---+---+---+----------+------
   |   |   |   |       50 | 
   |   |   |   |       53 | 0006
   |   |   |   |      103 | 0009
   |   |   |   |      106 | 0001
   |   |   |   |      156 | 0004
   |   |   |   |      159 | 0007
   |   |   |   |      212 | 0002
   |   |   |   |      262 | 0005
   |   |   |   |      265 | 0008
   |   |   |   |      318 | 
   |   |   |   |      368 | 0006
   |   |   |   |      371 | 0009
   |   |   |   |      421 | 0001
   |   |   |   |      424 | 0004
   |   |   |   |      427 | 0007
   |   |   |   |      480 | 0002
   |   |   |   |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 |      |    |      |          | 
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 |      |    |      |          | 
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 |      |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 |      |          | 
     |      |    |      |       50 | 
     |      |    |      |      318 | 
(37 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t2
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t2_1.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t2_1
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t2_2.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t2_2
(30 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |         avg         |  c   
-----+------+---------------------+------
 475 | 0001 |                     | 
 675 | 0002 |                     | 
 525 | 0004 |                     | 
 725 | 0005 |                     | 
 375 | 0006 |                     | 
 575 | 0007 |                     | 
 250 | 0008 |                     | 
 425 | 0009 |                     | 
     |      | 12.5000000000000000 | 0001
     |      | 12.5000000000000000 | 0002
     |      | 12.5000000000000000 | 0004
     |      | 12.5000000000000000 | 0005
     |      | 12.5000000000000000 | 0006
     |      | 12.5000000000000000 | 0007
     |      | 12.5000000000000000 | 0008
     |      | 12.5000000000000000 | 0009
 325 |      | 12.5000000000000000 | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Result
               ->  Append
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p1.c)::text = (plt2_p1.c)::text) AND (plt1_p1.a = plt2_p1.b))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p2.c)::text = (plt2_p2.c)::text) AND (plt1_p2.a = plt2_p2.b))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash Full Join
                           Hash Cond: (((plt1_p3.c)::text = (plt2_p3.c)::text) AND (plt1_p3.a = plt2_p3.b))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
(27 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |         avg         |  c   |         avg         
-----+------+-----+---------------------+------+---------------------
 475 | 0001 |  50 |                     |      |                    
 675 | 0002 |  50 |                     |      |                    
 525 | 0004 |  50 |                     |      |                    
 725 | 0005 |  50 |                     |      |                    
 375 | 0006 |  50 |                     |      |                    
 575 | 0007 |  50 |                     |      |                    
 250 | 0008 |  25 |                     |      |                    
 425 | 0009 |  50 |                     |      |                    
     |      |     | 12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0004 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0009 | 50.0000000000000000
 325 |      |  50 | 12.5000000000000000 |      | 50.0000000000000000
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Append
         ->  Hash Right Join
               Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p1 t2
               ->  Hash
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_1.b = t1_1.a) AND (ltrim((t2_1.c)::text, 'A'::text) = ltrim((t1_1.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Hash
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
         ->  Hash Right Join
               Hash Cond: ((t2_2.b = t1_2.a) AND (ltrim((t2_2.c)::text, 'A'::text) = ltrim((t1_2.c)::text, 'A'::text)))
               ->  Seq Scan on plt2_e_p3 t2_2
               ->  Hash
                     ->  Seq Scan on plt1_e_p3 t1_2
                           Filter: ((a % 25) = 0)
(21 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b | c 
-----+------+---+---
  25 |      |   | 
  50 | 0006 |   | 
  75 | 0009 |   | 
 100 | 0001 |   | 
 125 | 0004 |   | 
 150 | 0007 |   | 
 200 | 0002 |   | 
 225 | 0005 |   | 
 250 | 0008 |   | 
 300 |      |   | 
 325 | 0006 |   | 
 350 | 0009 |   | 
 375 | 0001 |   | 
 400 | 0004 |   | 
 425 | 0007 |   | 
 475 | 0002 |   | 
 500 | 0005 |   | 
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p1 t1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p1 t2
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND (ltrim((t1_1.c)::text, 'A'::text) = ltrim((t2_1.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p2 t1_1
                     ->  Hash
                           ->  Seq Scan on plt2_e_p2 t2_1
                                 Filter: ((b % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND (ltrim((t1_2.c)::text, 'A'::text) = ltrim((t2_2.c)::text, 'A'::text)))
                     ->  Seq Scan on plt1_e_p3 t1_2
                     ->  Hash
                           ->  Seq Scan on plt2_e_p3 t2_2
                                 Filter: ((b % 25) = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a | c | b  |  c   
---+---+----+------
   |   |  0 | 0001
   |   |  0 | 0002
   |   |  0 | 0004
   |   |  0 | 0005
   |   |  0 | 0006
   |   |  0 | 0007
   |   |  0 | 0008
   |   |  0 | 0009
   |   |  0 | 
   |   | 25 | 0001
   |   | 25 | 0002
   |   | 25 | 0004
   |   | 25 | 0005
   |   | 25 | 0006
   |   | 25 | 0007
   |   | 25 | 0008
   |   | 25 | 0009
   |   | 25 | 
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Append
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p1.a = plt2_e_p1.b) AND (ltrim((plt1_e_p1.c)::text, 'A'::text) = ltrim((plt2_e_p1.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p1
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p1
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p2.a = plt2_e_p2.b) AND (ltrim((plt1_e_p2.c)::text, 'A'::text) = ltrim((plt2_e_p2.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p2
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p2
                           Filter: ((b % 25) = 0)
         ->  Hash Full Join
               Hash Cond: ((plt1_e_p3.a = plt2_e_p3.b) AND (ltrim((plt1_e_p3.c)::text, 'A'::text) = ltrim((plt2_e_p3.c)::text, 'A'::text)))
               ->  Seq Scan on plt1_e_p3
                     Filter: ((a % 25) = 0)
               ->  Hash
                     ->  Seq Scan on plt2_e_p3
                           Filter: ((b % 25) = 0)
(24 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
  25 |      |    | 
  50 | 0006 |    | 
  75 | 0009 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 150 | 0007 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 250 | 0008 |    | 
 300 |      |    | 
 325 | 0006 |    | 
 350 | 0009 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 425 | 0007 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0004
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      |  0 | 
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0004
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
     |      | 25 | 
(35 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Append
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3.c)::text = (t2.c)::text)
                           ->  Seq Scan on plt2_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_1.c)::text = (t2_1.c)::text)
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1_1.c)::text = (c)::text)
               ->  Nested Loop Left Join
                     ->  Seq Scan on plt1_p3 t1_2
                           Filter: ((a % 25) = 0)
                     ->  Hash Join
                           Hash Cond: ((t3_2.c)::text = (t2_2.c)::text)
                           ->  Seq Scan on plt2_p3 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt1_p3 t2_2
                                       Filter: ((t1_2.c)::text = (c)::text)
(32 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
  25 | 25 |      |      |      | 
  50 |  3 | 0006 | 0006 | 0006 | 0006
  75 | 28 | 0009 | 0009 | 0009 | 0009
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 | 0004 | 0004 | 0004
 150 |  9 | 0007 | 0007 | 0007 | 0007
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 250 | 15 | 0008 | 0008 | 0008 | 0008
 300 | 18 |      |      |      | 
 325 | 43 | 0006 | 0006 | 0006 | 0006
 350 | 21 | 0009 | 0009 | 0009 | 0009
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 | 0004 | 0004 | 0004
 425 |  2 | 0007 | 0007 | 0007 | 0007
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(17 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
                     ->  Seq Scan on plt1_p1
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p1
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.c)::text = (plt2_p2.c)::text)
                     ->  Seq Scan on plt1_p2
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p2
                                 Filter: ((b % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.c)::text = (plt2_p3.c)::text)
                     ->  Seq Scan on plt1_p3
                           Filter: ((a % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt2_p3
                                 Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p3
                           Filter: ((a % 25) = 0)
(35 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
                     ->  Seq Scan on plt1_p1 t1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_1.a = t2_1.b) AND ((t1_1.c)::text = (t2_1.c)::text))
                     ->  Seq Scan on plt1_p2 t1_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_1.b = t3_1.a) AND ((t2_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_1
                                             Filter: ((a % 25) = 0)
               ->  Hash Right Join
                     Hash Cond: ((t1_2.a = t2_2.b) AND ((t1_2.c)::text = (t2_2.c)::text))
                     ->  Seq Scan on plt1_p3 t1_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: ((t2_2.b = t3_2.a) AND ((t2_2.c)::text = ltrim((t3_2.c)::text, 'A'::text)))
                                 ->  Seq Scan on plt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_2
                                             Filter: ((a % 25) = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a | c | b | c | ?column? |  c   
---+---+---+---+----------+------
   |   |   |   |       50 | 
   |   |   |   |       53 | 0006
   |   |   |   |      103 | 0009
   |   |   |   |      106 | 0001
   |   |   |   |      156 | 0004
   |   |   |   |      159 | 0007
   |   |   |   |      212 | 0002
   |   |   |   |      262 | 0005
   |   |   |   |      265 | 0008
   |   |   |   |      318 | 
   |   |   |   |      368 | 0006
   |   |   |   |      371 | 0009
   |   |   |   |      421 | 0001
   |   |   |   |      424 | 0004
   |   |   |   |      427 | 0007
   |   |   |   |      480 | 0002
   |   |   |   |      530 | 0005
(17 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p1.a = plt2_p1.b) AND ((plt1_p1.c)::text = (plt2_p1.c)::text))
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p1
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p2.a = plt1_e_p2.a) AND ((plt1_p2.c)::text = ltrim((plt1_e_p2.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p2.a = plt2_p2.b) AND ((plt1_p2.c)::text = (plt2_p2.c)::text))
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p2
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2
                                 Filter: ((a % 25) = 0)
               ->  Hash Full Join
                     Hash Cond: ((plt1_p3.a = plt1_e_p3.a) AND ((plt1_p3.c)::text = ltrim((plt1_e_p3.c)::text, 'A'::text)))
                     ->  Hash Full Join
                           Hash Cond: ((plt1_p3.a = plt2_p3.b) AND ((plt1_p3.c)::text = (plt2_p3.c)::text))
                           ->  Seq Scan on plt1_p3
                                 Filter: ((a % 25) = 0)
                           ->  Hash
                                 ->  Seq Scan on plt2_p3
                                       Filter: ((b % 25) = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3
                                 Filter: ((a % 25) = 0)
(40 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 |      |    |      |          | 
  50 | 0006 |    |      |       53 | 0006
  75 | 0009 |    |      |      103 | 0009
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 150 | 0007 |    |      |      159 | 0007
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 250 | 0008 |    |      |      265 | 0008
 300 |      |    |      |          | 
 325 | 0006 |    |      |      368 | 0006
 350 | 0009 |    |      |      371 | 0009
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 425 | 0007 |    |      |      427 | 0007
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 |      |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 |      |          | 
     |      |    |      |       50 | 
     |      |    |      |      318 | 
(37 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Append
         ->  Nested Loop Semi Join
               Join Filter: ((t1.c)::text = (t1_3.c)::text)
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_3.c)::text = ltrim((t1_6.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p1 t1_3
                     ->  Hash
                           ->  Seq Scan on plt1_e_p1 t1_6
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_1.c)::text = (t1_4.c)::text)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_4.c)::text = ltrim((t1_7.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p2 t1_4
                     ->  Hash
                           ->  Seq Scan on plt1_e_p2 t1_7
                                 Filter: ((a % 25) = 0)
         ->  Nested Loop Semi Join
               Join Filter: ((t1_2.c)::text = (t1_5.c)::text)
               ->  Seq Scan on plt1_p3 t1_2
                     Filter: ((a % 25) = 0)
               ->  Hash Semi Join
                     Hash Cond: ((t1_5.c)::text = ltrim((t1_8.c)::text, 'A'::text))
                     ->  Seq Scan on plt2_p3 t1_5
                     ->  Hash
                           ->  Seq Scan on plt1_e_p3 t1_8
                                 Filter: ((a % 25) = 0)
(33 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
  75 | 28 | 0009
 100 |  6 | 0001
 125 | 31 | 0004
 150 |  9 | 0007
 200 | 12 | 0002
 225 | 37 | 0005
 250 | 15 | 0008
 325 | 43 | 0006
 350 | 21 | 0009
 375 | 46 | 0001
 400 | 24 | 0004
 425 |  2 | 0007
 475 |  5 | 0002
 500 | 30 | 0005
(15 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t3.c)::text)
               Join Filter: (((t1.b + t2.b) + t3.b) = 0)
               ->  Parallel Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t1
                           ->  Parallel Seq Scan on plt1_p2 t1_1
                           ->  Parallel Seq Scan on plt1_p3 t1_2
                     ->  Parallel Hash
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt2_p1 t2
                                 ->  Parallel Seq Scan on plt2_p2 t2_1
                                 ->  Parallel Seq Scan on plt2_p3 t2_2
               ->  Parallel Hash
                     ->  Parallel Append
                           ->  Parallel Seq Scan on plt1_p1 t3
                           ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Seq Scan on plt1_p3 t3_2
(23 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 141 | 0 | 0009
 188 | 0 | 0001
 235 | 0 | 0004
 282 | 0 | 0007
 376 | 0 | 0002
 423 | 0 | 0005
 470 | 0 | 0008
(8 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t5.c)::text)
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t1.c)::text = (t4.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1.c)::text = (t3.c)::text)
                           ->  Seq Scan on plt1_p1 t3
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Hash Join
                                       Hash Cond: ((t1.c)::text = (t2.c)::text)
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                     ->  Merge Join
                           Merge Cond: ((t1_1.c)::text = (t2_1.c)::text)
                           ->  Sort
                                 Sort Key: t1_1.c
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
                           ->  Sort
                                 Sort Key: t2_1.c
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Join
                                 Hash Cond: ((t3_1.c)::text = (t4_1.c)::text)
                                 ->  Seq Scan on plt1_p2 t3_1
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p2 t4_1
                                             Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                     ->  Merge Join
                           Merge Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Sort
                                 Sort Key: t1_2.c
                                 ->  Seq Scan on plt1_p3 t1_2
                                       Filter: (b = 0)
                           ->  Sort
                                 Sort Key: t2_2.c
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Join
                                 Hash Cond: ((t3_2.c)::text = (t4_2.c)::text)
                                 ->  Seq Scan on plt1_p3 t3_2
                                       Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt2_p3 t4_2
                                             Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p3 t5_2
                           Filter: (b = 0)
(69 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Materialize
                           ->  Nested Loop
                                 Join Filter: ((t1.c)::text = (t4.c)::text)
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Materialize
                                             ->  Hash Join
                                                   Hash Cond: ((t1.c)::text = (t2.c)::text)
                                                   ->  Seq Scan on plt1_p1 t1
                                                         Filter: (b = 0)
                                                   ->  Hash
                                                         ->  Seq Scan on plt2_p1 t2
                                                               Filter: (b = 0)
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_1.c)::text = (t4_1.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop
                           Join Filter: ((t1_2.c)::text = (t4_2.c)::text)
                           ->  Nested Loop
                                 Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                       ->  Seq Scan on plt1_p3 t1_2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                 ->  Materialize
                                       ->  Seq Scan on plt1_p3 t3_2
                                             Filter: (b = 0)
                           ->  Materialize
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(69 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
     |      |   |      |     | 
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1.c)::text = (t3.c)::text)
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Materialize
                                             ->  Hash Join
                                                   Hash Cond: ((t1.c)::text = (t2.c)::text)
                                                   ->  Seq Scan on plt1_p1 t1
                                                         Filter: (b = 0)
                                                   ->  Hash
                                                         ->  Seq Scan on plt2_p1 t2
                                                               Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Materialize
                           ->  Nested Loop Left Join
                                 Join Filter: ((t3.c)::text = (t4.c)::text)
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                                 ->  Materialize
                                       ->  Nested Loop
                                             Join Filter: ((t1.c)::text = (t3.c)::text)
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                             ->  Materialize
                                                   ->  Hash Join
                                                         Hash Cond: ((t1.c)::text = (t2.c)::text)
                                                         ->  Seq Scan on plt1_p1 t1
                                                               Filter: (b = 0)
                                                         ->  Hash
                                                               ->  Seq Scan on plt2_p1 t2
                                                                     Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_1.c)::text = (t2_1.c)::text)
                                             ->  Seq Scan on plt1_p2 t1_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p2 t2_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t1_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                                             ->  Seq Scan on plt1_p3 t1_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt2_p3 t2_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Hash
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
     |      |   |      |     | 
(9 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop
                     Join Filter: ((t4.c)::text = (t5.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3.c)::text = (t4.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop Left Join
                                       Join Filter: ((t1.c)::text = (t2.c)::text)
                                       ->  Hash Join
                                             Hash Cond: ((t2.c)::text = (t3.c)::text)
                                             ->  Seq Scan on plt2_p1 t2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p1 t3
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p1 t1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_1.c)::text = (t5_1.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_1.c)::text = (t3_1.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                                             ->  Seq Scan on plt2_p2 t2_1
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p2 t1_1
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
               ->  Nested Loop
                     Join Filter: ((t4_2.c)::text = (t5_2.c)::text)
                     ->  Nested Loop Left Join
                           Join Filter: ((t3_2.c)::text = (t4_2.c)::text)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                           ->  Materialize
                                 ->  Nested Loop
                                       Join Filter: ((t2_2.c)::text = (t3_2.c)::text)
                                       ->  Hash Left Join
                                             Hash Cond: ((t2_2.c)::text = (t1_2.c)::text)
                                             ->  Seq Scan on plt2_p3 t2_2
                                                   Filter: (b = 0)
                                             ->  Hash
                                                   ->  Seq Scan on plt1_p3 t1_2
                                                         Filter: (b = 0)
                                       ->  Materialize
                                             ->  Seq Scan on plt1_p3 t3_2
                                                   Filter: (b = 0)
                     ->  Materialize
                           ->  Seq Scan on plt1_p3 t5_2
                                 Filter: (b = 0)
(70 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 141 | 0009 | 0 | 0009 | 141 | 0009
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
-- default with NULL list value.
-- one relation have NULL value and default and other have only default partition
-- partition-wise-join not possible as it need one relation to join with two partitions.
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0004','0005','0006');
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3,7,8,9);
INSERT INTO plt1 SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt2 SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt2;
CREATE TABLE plt1_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0001','0002',NULL);
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0004','0005','0006');
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3,7,8,9);
INSERT INTO plt1_e SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt1_e;
CREATE TABLE plt2_e (a int, b int, c varchar) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt2_e_p1 PARTITION OF plt2_e FOR VALUES IN ('0001','0002');
CREATE TABLE plt2_e_p2 PARTITION OF plt2_e FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_e_p3 PARTITION OF plt2_e DEFAULT;
INSERT INTO plt2_e SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10,3);
INSERT INTO plt2_e SELECT i, i % 47, NULL FROM generate_series(0, 500) i WHERE i % 11 IN (3);
ANALYSE plt2_e;
-- inner join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         Join Filter: ((t1.b + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 INNER JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
(5 rows)

-- left join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Left Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 |      |     | 
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
(6 rows)

-- left outer join, with whole-row reference
EXPLAIN (COSTS OFF)
SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Left Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         Filter: ((t1.b + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(13 rows)

SELECT t1,t2 FROM plt1 t1 LEFT JOIN plt2 t2 ON t1.c = t2.c WHERE t1.b + coalesce(t2.b, 0) = 0 ORDER BY t1.a;
      t1      |      t2      
--------------+--------------
 (47,0,)      | 
 (94,0,0006)  | (94,0,0006)
 (188,0,0001) | (188,0,0001)
 (235,0,0004) | (235,0,0004)
 (376,0,0002) | (376,0,0002)
 (423,0,0005) | (423,0,0005)
(6 rows)

-- right join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t2.a;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t2.a
   ->  Hash Right Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         Filter: ((COALESCE(t1.b, 0) + t2.b) = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + t2.b = 0 ORDER BY t1.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
     |      |  47 | 
     |      | 282 | 0007
     |      | 470 | 0008
     |      | 141 | 0009
(9 rows)

-- full join
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
                          QUERY PLAN                           
---------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.a
   ->  Hash Full Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         Filter: ((COALESCE(t1.b, 0) + COALESCE(t2.b, 0)) = 0)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(13 rows)

SELECT t1.a, t1.c, t2.a, t2.c FROM plt1 t1 FULL JOIN plt2 t2 ON t1.c = t2.c WHERE coalesce(t1.b, 0) + coalesce(t2.b, 0) = 0 ORDER BY t1.a, t2.a;
  a  |  c   |  a  |  c   
-----+------+-----+------
  47 |      |     | 
  94 | 0006 |  94 | 0006
 188 | 0001 | 188 | 0001
 235 | 0004 | 235 | 0004
 376 | 0002 | 376 | 0002
 423 | 0005 | 423 | 0005
     |      |  47 | 
     |      | 141 | 0009
     |      | 282 | 0007
     |      | 470 | 0008
(10 rows)

-- full outer join, with placeholder vars
EXPLAIN (COSTS OFF)
SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Unique
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: ((plt1_p1.c)::text = (plt2_p1.c)::text)
               Join Filter: ((plt2_p1.b = 0) AND (plt1_p1.b = 0))
               Filter: ((('0001'::text) = (plt1_p1.c)::text) OR (('0002'::text) = (plt2_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt1_p1
                     ->  Seq Scan on plt1_p2
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1
                           ->  Seq Scan on plt2_p2
                           ->  Seq Scan on plt2_p3
(15 rows)

SELECT DISTINCT  t1.c, t2.c FROM (SELECT '0001' phv, * FROM plt1) t1 FULL JOIN (SELECT '0002' phv, * FROM plt2) t2 ON (t1.c = t2.c and t2.b = 0 AND t1.b = 0) WHERE (t1.phv = t1.c OR t2.phv = t2.c) ORDER BY 1,2;
  c   |  c   
------+------
 0001 | 0001
 0001 | 
 0002 | 0002
      | 0002
(4 rows)

-- semi join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                 ->  Seq Scan on plt2_p2 t2_1
                                 ->  Seq Scan on plt2_p3 t2_2
(17 rows)

select t1.a, t1.b, t1.c from plt1 t1 where exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  HashAggregate
                     Group Key: (t2.c)::text
                     ->  Result
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                 ->  Seq Scan on plt1_p2 t2_1
(18 rows)

select t1.a, t1.b, t1.c from plt2 t1 where exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

-- anti join
EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Anti Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_p1 t2
                     ->  Seq Scan on plt2_p2 t2_1
                     ->  Seq Scan on plt2_p3 t2_2
(14 rows)

select t1.a, t1.b, t1.c from plt1 t1 where not exists (select 1 from plt2 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
 a  | b | c 
----+---+---
 47 | 0 | 
(1 row)

EXPLAIN (COSTS OFF)
select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
                    QUERY PLAN                    
--------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c
   ->  Hash Anti Join
         Hash Cond: ((t1.c)::text = (t2.c)::text)
         ->  Append
               ->  Seq Scan on plt2_p1 t1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p2 t1_1
                     Filter: (b = 0)
               ->  Seq Scan on plt2_p3 t1_2
                     Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t2
                     ->  Seq Scan on plt1_p2 t2_1
(15 rows)

select t1.a, t1.b, t1.c from plt2 t1 where not exists (select 1 from plt1 t2 WHERE t1.c = t2.c) and t1.b = 0 order by t1.a, t1.b, t1.c;
  a  | b |  c   
-----+---+------
  47 | 0 | 
 141 | 0 | 0009
 282 | 0 | 0007
 470 | 0 | 0008
(4 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: (b = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
(22 rows)

SELECT DISTINCT t1.c, t2c,least_all FROM plt1 t1 LEFT JOIN LATERAL (SELECT t2.c AS t2c, t2.b AS t2b, t3.c AS t3c, t3.b AS t3b,least(t1.c,t2.c,t3.c) AS least_all FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss ON t1.c = ss.t2c WHERE t1.b = 0 ORDER BY t1.c;
  c   | t2c  | least_all 
------+------+-----------
 0001 | 0001 | 0001
 0002 | 0002 | 0002
 0004 | 0004 | 0004
 0005 | 0005 | 0005
 0006 | 0006 | 0006
      |      | 
(6 rows)

--nullable column
EXPLAIN (COSTS OFF)
SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
           QUERY PLAN           
--------------------------------
 Sort
   Sort Key: plt1.c, plt2.c
   ->  Result
         One-Time Filter: false
(4 rows)

SELECT t1.c, t2.c FROM (SELECT * FROM plt1 WHERE c < '0000') t1 LEFT JOIN (SELECT * FROM plt2 WHERE c > '0002') t2 ON t1.c = t2.c WHERE t1.b = 0 ORDER BY t1.c, t2.c;
 c | c 
---+---
(0 rows)

-- test partition matching with N-way join
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(22 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
(5 rows)

EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Hash Join
               Hash Cond: ((t1.c)::text = (t2.c)::text)
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t1.c)::text = ltrim((t3.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                     ->  Hash Join
                           Hash Cond: ((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
(22 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 248.5000000000000000 | 22.6956521739130435 | 271.1956521739130435 | 0001 | 0001 | 0001
 249.5000000000000000 | 22.6739130434782609 | 272.1739130434782609 | 0002 | 0002 | 0002
 251.5000000000000000 | 22.6304347826086957 | 274.1304347826086957 | 0004 | 0004 | 0004
 252.5000000000000000 | 22.6086956521739130 | 275.1086956521739130 | 0005 | 0005 | 0005
 248.0000000000000000 | 22.4000000000000000 | 270.4000000000000000 | 0006 | 0006 | 0006
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Hash Right Join
                           Hash Cond: ((t3.a = t1.a) AND (ltrim((t3.c)::text, 'A'::text) = (t1.c)::text))
                           ->  Seq Scan on plt1_e_p1 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: ((t3_1.a = t1_1.a) AND (ltrim((t3_1.c)::text, 'A'::text) = (t1_1.c)::text))
                           ->  Seq Scan on plt1_e_p2 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? |  c   
-----+------+---+---+----------+------
  25 |      |   |   |          | 
  50 | 0006 |   |   |       53 | 0006
 100 | 0001 |   |   |      106 | 0001
 125 | 0004 |   |   |      156 | 0004
 200 | 0002 |   |   |      212 | 0002
 225 | 0005 |   |   |      262 | 0005
 300 |      |   |   |          | 
 325 | 0006 |   |   |      368 | 0006
 375 | 0001 |   |   |      421 | 0001
 400 | 0004 |   |   |      424 | 0004
 475 | 0002 |   |   |      480 | 0002
 500 | 0005 |   |   |      530 | 0005
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t3.a = t2.b) AND (ltrim((t3.c)::text, 'A'::text) = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t3
               ->  Seq Scan on plt1_e_p2 t3_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
(20 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) LEFT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? | c 
-----+------+---+---+----------+---
  25 |      |   |   |          | 
  50 | 0006 |   |   |          | 
 100 | 0001 |   |   |          | 
 125 | 0004 |   |   |          | 
 200 | 0002 |   |   |          | 
 225 | 0005 |   |   |          | 
 300 |      |   |   |          | 
 325 | 0006 |   |   |          | 
 375 | 0001 |   |   |          | 
 400 | 0004 |   |   |          | 
 475 | 0002 |   |   |          | 
 500 | 0005 |   |   |          | 
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND ((t2.c)::text = (t1.c)::text))
         ->  Append
               ->  Seq Scan on plt2_p1 t2
               ->  Seq Scan on plt2_p2 t2_1
               ->  Seq Scan on plt2_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Hash Right Join
                           Hash Cond: (((t1.c)::text = ltrim((t3.c)::text, 'A'::text)) AND (t1.a = t3.a))
                           ->  Seq Scan on plt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                     ->  Hash Right Join
                           Hash Cond: (((t1_1.c)::text = ltrim((t3_1.c)::text, 'A'::text)) AND (t1_1.a = t3_1.a))
                           ->  Seq Scan on plt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
(22 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 LEFT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   | b | c | ?column? |  c   
-----+------+---+---+----------+------
  50 | 0006 |   |   |       53 | 0006
 100 | 0001 |   |   |      106 | 0001
 125 | 0004 |   |   |      156 | 0004
 200 | 0002 |   |   |      212 | 0002
 225 | 0005 |   |   |      262 | 0005
 325 | 0006 |   |   |      368 | 0006
 375 | 0001 |   |   |      421 | 0001
 400 | 0004 |   |   |      424 | 0004
 475 | 0002 |   |   |      480 | 0002
 500 | 0005 |   |   |      530 | 0005
     |      |   |   |       50 | 
     |      |   |   |      318 | 
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
(20 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a | c | b | c | ?column? |  c   
---+---+---+---+----------+------
   |   |   |   |       50 | 
   |   |   |   |       53 | 0006
   |   |   |   |      106 | 0001
   |   |   |   |      156 | 0004
   |   |   |   |      212 | 0002
   |   |   |   |      262 | 0005
   |   |   |   |      318 | 
   |   |   |   |      368 | 0006
   |   |   |   |      421 | 0001
   |   |   |   |      424 | 0004
   |   |   |   |      480 | 0002
   |   |   |   |      530 | 0005
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.b = plt1_p1.a) AND ((plt2_p1.c)::text = (plt1_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(25 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 |      |    |      |          | 
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 300 |      |    |      |          | 
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 |      |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 |      |          | 
     |      |    |      |       50 | 
     |      |    |      |      318 | 
(32 rows)

-- Semi-join
EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop Semi Join
         Join Filter: ((t1.c)::text = (t1_2.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t1
                     Filter: ((a % 25) = 0)
               ->  Seq Scan on plt1_p2 t1_1
                     Filter: ((a % 25) = 0)
         ->  Hash Join
               Hash Cond: ((t1_2.c)::text = ltrim((t2.c)::text, 'A'::text))
               ->  Append
                     ->  Seq Scan on plt2_p1 t1_2
                     ->  Seq Scan on plt2_p2 t1_3
                     ->  Seq Scan on plt2_p3 t1_4
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_e_p1 t2
                           ->  Seq Scan on plt1_e_p2 t2_1
(19 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1, plt1_e t2 WHERE t1.c = ltrim(t2.c, 'A')) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 200 | 12 | 0002
 225 | 37 | 0005
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 475 |  5 | 0002
 500 | 30 | 0005
(10 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop
         Join Filter: ((t1.c)::text = (t1_2.c)::text)
         ->  HashAggregate
               Group Key: (t1_2.c)::text
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.c)::text = ltrim((t1_5.c)::text, 'A'::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t1_2
                           ->  Seq Scan on plt2_p2 t1_3
                           ->  Seq Scan on plt2_p3 t1_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t1_5
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t1_6
                                       Filter: ((a % 25) = 0)
         ->  Materialize
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 200 | 12 | 0002
 225 | 37 | 0005
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 475 |  5 | 0002
 500 | 30 | 0005
(10 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt2_p1.c)::text = (plt1_p1.c)::text) AND (plt2_p1.b = plt1_p1.a))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
(19 rows)

SELECT sum(t1.a), t1.c, avg(t2.b), t2.c FROM (SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   |         avg         |  c   
-----+------+---------------------+------
 475 | 0001 |                     | 
 675 | 0002 |                     | 
 525 | 0004 |                     | 
 725 | 0005 |                     | 
 375 | 0006 |                     | 
     |      | 12.5000000000000000 | 0001
     |      | 12.5000000000000000 | 0002
     |      | 12.5000000000000000 | 0004
     |      | 12.5000000000000000 | 0005
     |      | 12.5000000000000000 | 0006
     |      | 12.5000000000000000 | 0007
     |      | 12.5000000000000000 | 0008
     |      | 12.5000000000000000 | 0009
 325 |      | 12.5000000000000000 | 
(14 rows)

EXPLAIN (COSTS OFF)
SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 GroupAggregate
   Group Key: plt1_p1.c, plt2_p1.c
   ->  Sort
         Sort Key: plt1_p1.c, plt2_p1.c
         ->  Hash Full Join
               Hash Cond: (((plt2_p1.c)::text = (plt1_p1.c)::text) AND (plt2_p1.b = plt1_p1.a))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
(19 rows)

SELECT sum(t1.a), t1.c, sum(t1.phv), avg(t2.b), t2.c, avg(t2.phv) FROM (SELECT 25 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 50 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c AND t1.a = t2.b) GROUP BY t1.c, t2.c ORDER BY t1.c, t2.c;
 sum |  c   | sum |         avg         |  c   |         avg         
-----+------+-----+---------------------+------+---------------------
 475 | 0001 |  50 |                     |      |                    
 675 | 0002 |  50 |                     |      |                    
 525 | 0004 |  50 |                     |      |                    
 725 | 0005 |  50 |                     |      |                    
 375 | 0006 |  50 |                     |      |                    
     |      |     | 12.5000000000000000 | 0001 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0002 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0004 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0005 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0006 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0007 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0008 | 50.0000000000000000
     |      |     | 12.5000000000000000 | 0009 | 50.0000000000000000
 325 |      |  50 | 12.5000000000000000 |      | 50.0000000000000000
(14 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t2.b = t1.a) AND (ltrim((t2.c)::text, 'A'::text) = ltrim((t1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt2_e_p1 t2
               ->  Seq Scan on plt2_e_p2 t2_1
               ->  Seq Scan on plt2_e_p3 t2_2
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2 t1_1
                           Filter: ((a % 25) = 0)
(14 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 LEFT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b | c 
-----+------+---+---
  25 |      |   | 
  50 | 0006 |   | 
 100 | 0001 |   | 
 125 | 0004 |   | 
 200 | 0002 |   | 
 225 | 0005 |   | 
 300 |      |   | 
 325 | 0006 |   | 
 375 | 0001 |   | 
 400 | 0004 |   | 
 475 | 0002 |   | 
 500 | 0005 |   | 
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.c, t2.b, t2.c
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND (ltrim((t1.c)::text, 'A'::text) = ltrim((t2.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt1_e_p1 t1
               ->  Seq Scan on plt1_e_p2 t1_1
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt2_e_p1 t2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p2 t2_1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_e_p3 t2_2
                           Filter: ((b % 25) = 0)
(15 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM plt1_e t1 RIGHT JOIN plt2_e t2 ON t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A') WHERE t2.b % 25 = 0 ORDER BY 1,2,3,4;
 a | c | b  |  c   
---+---+----+------
   |   |  0 | 0001
   |   |  0 | 0002
   |   |  0 | 0004
   |   |  0 | 0005
   |   |  0 | 0006
   |   |  0 | 0007
   |   |  0 | 0008
   |   |  0 | 0009
   |   |  0 | 
   |   | 25 | 0001
   |   | 25 | 0002
   |   | 25 | 0004
   |   | 25 | 0005
   |   | 25 | 0006
   |   | 25 | 0007
   |   | 25 | 0008
   |   | 25 | 0009
   |   | 25 | 
(18 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_e_p1.a, plt1_e_p1.c, plt2_e_p1.b, plt2_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt2_e_p1.b = plt1_e_p1.a) AND (ltrim((plt2_e_p1.c)::text, 'A'::text) = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Append
               ->  Seq Scan on plt2_e_p1
                     Filter: ((b % 25) = 0)
               ->  Seq Scan on plt2_e_p2
                     Filter: ((b % 25) = 0)
               ->  Seq Scan on plt2_e_p3
                     Filter: ((b % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(17 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2_e WHERE plt2_e.b % 25 = 0) t2 ON (t1.a = t2.b AND ltrim(t1.c, 'A') = ltrim(t2.c, 'A')) ORDER BY 1,2,3,4;
  a  |  c   | b  |  c   
-----+------+----+------
  25 |      |    | 
  50 | 0006 |    | 
 100 | 0001 |    | 
 125 | 0004 |    | 
 200 | 0002 |    | 
 225 | 0005 |    | 
 300 |      |    | 
 325 | 0006 |    | 
 375 | 0001 |    | 
 400 | 0004 |    | 
 475 | 0002 |    | 
 500 | 0005 |    | 
     |      |  0 | 0001
     |      |  0 | 0002
     |      |  0 | 0004
     |      |  0 | 0005
     |      |  0 | 0006
     |      |  0 | 0007
     |      |  0 | 0008
     |      |  0 | 0009
     |      |  0 | 
     |      | 25 | 0001
     |      | 25 | 0002
     |      | 25 | 0004
     |      | 25 | 0005
     |      | 25 | 0006
     |      | 25 | 0007
     |      | 25 | 0008
     |      | 25 | 0009
     |      | 25 | 
(30 rows)

-- lateral reference
EXPLAIN (COSTS OFF)
SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t1.b, t1.c, t2.c, (LEAST(t1.c, t2.c, t3.c))
   ->  HashAggregate
         Group Key: t1.a, t1.b, t1.c, t2.c, t3.c, (LEAST(t1.c, t2.c, t3.c))
         ->  Nested Loop Left Join
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
               ->  Hash Join
                     Hash Cond: ((t3.c)::text = (t2.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t3
                           ->  Seq Scan on plt2_p2 t3_1
                           ->  Seq Scan on plt2_p3 t3_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t2
                                       Filter: ((t1.c)::text = (c)::text)
                                 ->  Seq Scan on plt1_p2 t2_1
                                       Filter: ((t1.c)::text = (c)::text)
(22 rows)

SELECT distinct * FROM plt1 t1 LEFT JOIN LATERAL
			  (SELECT t2.c AS t2c, t3.c AS t3c, least(t1.c,t2.c,t3.c) FROM plt1 t2 JOIN plt2 t3 ON (t2.c = t3.c)) ss
			  ON t1.c = ss.t2c WHERE t1.a % 25 = 0 ORDER BY 1,2,3,4,5,6;
  a  | b  |  c   | t2c  | t3c  | least 
-----+----+------+------+------+-------
  25 | 25 |      |      |      | 
  50 |  3 | 0006 | 0006 | 0006 | 0006
 100 |  6 | 0001 | 0001 | 0001 | 0001
 125 | 31 | 0004 | 0004 | 0004 | 0004
 200 | 12 | 0002 | 0002 | 0002 | 0002
 225 | 37 | 0005 | 0005 | 0005 | 0005
 300 | 18 |      |      |      | 
 325 | 43 | 0006 | 0006 | 0006 | 0006
 375 | 46 | 0001 | 0001 | 0001 | 0001
 400 | 24 | 0004 | 0004 | 0004 | 0004
 475 |  5 | 0002 | 0002 | 0002 | 0002
 500 | 30 | 0005 | 0005 | 0005 | 0005
(12 rows)

-- Cases with non-nullable expressions in subquery results;
-- make sure these go to null as expected
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt2_p1.b, (ltrim((plt1_e_p1.c)::text, 'A'::text))
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text))
         Filter: ((plt1_p1.a = (50)) OR (plt2_p1.b = (75)) OR (ltrim((plt1_e_p1.c)::text, 'A'::text) = ('0002'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.c)::text = (plt1_p1.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(26 rows)

SELECT t1.a, t1.phv, t2.b, t2.phv, ltrim(t3.c,'A'), t3.phv FROM ((SELECT 50 phv, * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT 75 phv, * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.c = t2.c)) FULL JOIN (SELECT '0002'::text phv, * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.c = ltrim(t3.c,'A')) WHERE t1.a = t1.phv OR t2.b = t2.phv OR ltrim(t3.c,'A') = t3.phv ORDER BY t1.a, t2.b, ltrim(t3.c,'A');
  a  | phv | b  | phv | ltrim | phv  
-----+-----+----+-----+-------+------
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 |  0 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
  50 |  50 | 25 |  75 | 0006  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 |  0 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 200 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 |  0 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
 475 |  50 | 25 |  75 | 0002  | 0002
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: ((t1.a = t2.b) AND ((t1.c)::text = (t2.c)::text))
         ->  Append
               ->  Seq Scan on plt1_p1 t1
               ->  Seq Scan on plt1_p2 t1_1
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: ((t2.b = t3.a) AND ((t2.c)::text = ltrim((t3.c)::text, 'A'::text)))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                           ->  Seq Scan on plt2_p2 t2_1
                           ->  Seq Scan on plt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t3
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t3_1
                                       Filter: ((a % 25) = 0)
(20 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (plt1 t1 RIGHT JOIN plt2 t2 ON t1.a = t2.b AND t1.c = t2.c) RIGHT JOIN plt1_e t3 ON (t2.b = t3.a AND t2.c = ltrim(t3.c, 'A')) WHERE t3.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
 a | c | b | c | ?column? |  c   
---+---+---+---+----------+------
   |   |   |   |       50 | 
   |   |   |   |       53 | 0006
   |   |   |   |      106 | 0001
   |   |   |   |      156 | 0004
   |   |   |   |      212 | 0002
   |   |   |   |      262 | 0005
   |   |   |   |      318 | 
   |   |   |   |      368 | 0006
   |   |   |   |      421 | 0001
   |   |   |   |      424 | 0004
   |   |   |   |      480 | 0002
   |   |   |   |      530 | 0005
(12 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: plt1_p1.a, plt1_p1.c, plt2_p1.b, plt2_p1.c, ((plt1_e_p1.a + plt1_e_p1.b)), plt1_e_p1.c
   ->  Hash Full Join
         Hash Cond: ((plt1_p1.a = plt1_e_p1.a) AND ((plt1_p1.c)::text = ltrim((plt1_e_p1.c)::text, 'A'::text)))
         ->  Hash Full Join
               Hash Cond: ((plt2_p1.b = plt1_p1.a) AND ((plt2_p1.c)::text = (plt1_p1.c)::text))
               ->  Append
                     ->  Seq Scan on plt2_p1
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p2
                           Filter: ((b % 25) = 0)
                     ->  Seq Scan on plt2_p3
                           Filter: ((b % 25) = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1
                                 Filter: ((a % 25) = 0)
                           ->  Seq Scan on plt1_p2
                                 Filter: ((a % 25) = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_e_p1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_e_p2
                           Filter: ((a % 25) = 0)
(25 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM ((SELECT * FROM plt1 WHERE plt1.a % 25 = 0) t1 FULL JOIN (SELECT * FROM plt2 WHERE plt2.b % 25 = 0) t2 ON (t1.a = t2.b AND t1.c = t2.c)) FULL JOIN (SELECT * FROM plt1_e WHERE plt1_e.a % 25 = 0) t3 ON (t1.a = t3.a AND ltrim(t3.c, 'A') = t1.c) ORDER BY 1,2,3,4,5,6;
  a  |  c   | b  |  c   | ?column? |  c   
-----+------+----+------+----------+------
  25 |      |    |      |          | 
  50 | 0006 |    |      |       53 | 0006
 100 | 0001 |    |      |      106 | 0001
 125 | 0004 |    |      |      156 | 0004
 200 | 0002 |    |      |      212 | 0002
 225 | 0005 |    |      |      262 | 0005
 300 |      |    |      |          | 
 325 | 0006 |    |      |      368 | 0006
 375 | 0001 |    |      |      421 | 0001
 400 | 0004 |    |      |      424 | 0004
 475 | 0002 |    |      |      480 | 0002
 500 | 0005 |    |      |      530 | 0005
     |      |  0 | 0001 |          | 
     |      |  0 | 0002 |          | 
     |      |  0 | 0004 |          | 
     |      |  0 | 0005 |          | 
     |      |  0 | 0006 |          | 
     |      |  0 | 0007 |          | 
     |      |  0 | 0008 |          | 
     |      |  0 | 0009 |          | 
     |      |  0 |      |          | 
     |      | 25 | 0001 |          | 
     |      | 25 | 0002 |          | 
     |      | 25 | 0004 |          | 
     |      | 25 | 0005 |          | 
     |      | 25 | 0006 |          | 
     |      | 25 | 0007 |          | 
     |      | 25 | 0008 |          | 
     |      | 25 | 0009 |          | 
     |      | 25 |      |          | 
     |      |    |      |       50 | 
     |      |    |      |      318 | 
(32 rows)

EXPLAIN (COSTS OFF)
SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop
         Join Filter: ((t1.c)::text = (t1_2.c)::text)
         ->  HashAggregate
               Group Key: (t1_2.c)::text
               ->  Hash Semi Join
                     Hash Cond: ((t1_2.c)::text = ltrim((t1_5.c)::text, 'A'::text))
                     ->  Append
                           ->  Seq Scan on plt2_p1 t1_2
                           ->  Seq Scan on plt2_p2 t1_3
                           ->  Seq Scan on plt2_p3 t1_4
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_e_p1 t1_5
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on plt1_e_p2 t1_6
                                       Filter: ((a % 25) = 0)
         ->  Materialize
               ->  Append
                     ->  Seq Scan on plt1_p1 t1
                           Filter: ((a % 25) = 0)
                     ->  Seq Scan on plt1_p2 t1_1
                           Filter: ((a % 25) = 0)
(24 rows)

SELECT t1.* FROM plt1 t1 WHERE t1.c IN (SELECT t1.c FROM plt2 t1 WHERE t1.c IN (SELECT ltrim(t1.c, 'A') FROM plt1_e t1 WHERE t1.a % 25 = 0)) AND t1.a % 25 = 0 ORDER BY t1.a;
  a  | b  |  c   
-----+----+------
  50 |  3 | 0006
 100 |  6 | 0001
 125 | 31 | 0004
 200 | 12 | 0002
 225 | 37 | 0005
 325 | 43 | 0006
 375 | 46 | 0001
 400 | 24 | 0004
 475 |  5 | 0002
 500 | 30 | 0005
(10 rows)

--Join combinations
--inner and left outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) left outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--inner and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--inner and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 inner join plt2 t2 on (t1.c = t2.c) full outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--left outer and right outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) right outer join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--left outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 left outer join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--right outer and full outer join 
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Gather Merge
   Workers Planned: 2
   ->  Sort
         Sort Key: t1.a, t2_2.b, t3.c
         ->  Parallel Hash Join
               Hash Cond: ((t1.c)::text = (t2_2.c)::text)
               Join Filter: (((t1.b + t2_2.b) + t3.b) = 0)
               ->  Parallel Append
                     ->  Parallel Seq Scan on plt1_p1 t1
                     ->  Parallel Seq Scan on plt1_p2 t1_1
               ->  Parallel Hash
                     ->  Parallel Hash Join
                           Hash Cond: ((t3.c)::text = (t2_2.c)::text)
                           ->  Parallel Append
                                 ->  Parallel Seq Scan on plt1_p1 t3
                                 ->  Parallel Seq Scan on plt1_p2 t3_1
                           ->  Parallel Hash
                                 ->  Parallel Append
                                       ->  Parallel Seq Scan on plt2_p3 t2_2
                                       ->  Parallel Seq Scan on plt2_p2 t2_1
                                       ->  Parallel Seq Scan on plt2_p1 t2
(21 rows)

select t1.a,t2.b,t3.c from plt1 t1 right join plt2 t2 on (t1.c = t2.c) full join plt1 t3 on (t2.c = t3.c) where t1.b + t2.b +t3.b = 0 order by 1,2,3;
  a  | b |  c   
-----+---+------
  94 | 0 | 0006
 188 | 0 | 0001
 235 | 0 | 0004
 376 | 0 | 0002
 423 | 0 | 0005
(5 rows)

--join combinations (more than 3 joins)
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Nested Loop
         Join Filter: ((t4.c)::text = (t1.c)::text)
         ->  Hash Join
               Hash Cond: ((t2.c)::text = (t1.c)::text)
               ->  Hash Join
                     Hash Cond: ((t2.c)::text = (t3.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t2
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t2_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t2_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t3
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t3_1
                                       Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t1_1
                                 Filter: (b = 0)
         ->  Materialize
               ->  Hash Join
                     Hash Cond: ((t4.c)::text = (t5.c)::text)
                     ->  Append
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Seq Scan on plt2_p3 t4_2
                                 Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t5
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t5_1
                                       Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) INNER JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Nested Loop Left Join
         Join Filter: ((t4.c)::text = (t5.c)::text)
         ->  Append
               ->  Seq Scan on plt1_p1 t5
                     Filter: (b = 0)
               ->  Seq Scan on plt1_p2 t5_1
                     Filter: (b = 0)
         ->  Materialize
               ->  Hash Join
                     Hash Cond: ((t1.c)::text = (t2.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4.c)::text = (t1.c)::text)
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t4
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t4_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t4_2
                                       Filter: (b = 0)
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = (t3.c)::text)
                                 ->  Append
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt2_p3 t2_2
                                             Filter: (b = 0)
                                 ->  Hash
                                       ->  Append
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) INNER JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) RIGHT JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
     |      |   |      |     | 
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Nested Loop Left Join
         Join Filter: ((t3.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t4.c)::text = (t5.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
         ->  Materialize
               ->  Hash Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t3.c)::text)
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 LEFT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(5 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Hash Right Join
         Hash Cond: ((t4.c)::text = (t5.c)::text)
         ->  Hash Left Join
               Hash Cond: ((t4.c)::text = (t3.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = (t3.c)::text)
                                 ->  Append
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt2_p3 t2_2
                                             Filter: (b = 0)
                                 ->  Hash
                                       ->  Append
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
         ->  Hash
               ->  Append
                     ->  Seq Scan on plt1_p1 t5
                           Filter: (b = 0)
                     ->  Seq Scan on plt1_p2 t5_1
                           Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 INNER JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) RIGHT JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) FULL JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
     |      |   |      |     | 
(6 rows)

EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Nested Loop Left Join
         Join Filter: ((t3.c)::text = (t4.c)::text)
         ->  Hash Join
               Hash Cond: ((t4.c)::text = (t5.c)::text)
               ->  Append
                     ->  Seq Scan on plt2_p1 t4
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p2 t4_1
                           Filter: (b = 0)
                     ->  Seq Scan on plt2_p3 t4_2
                           Filter: (b = 0)
               ->  Hash
                     ->  Append
                           ->  Seq Scan on plt1_p1 t5
                                 Filter: (b = 0)
                           ->  Seq Scan on plt1_p2 t5_1
                                 Filter: (b = 0)
         ->  Materialize
               ->  Hash Left Join
                     Hash Cond: ((t2.c)::text = (t1.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t3.c)::text)
                           ->  Append
                                 ->  Seq Scan on plt2_p1 t2
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p2 t2_1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt2_p3 t2_2
                                       Filter: (b = 0)
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on plt1_p1 t3
                                             Filter: (b = 0)
                                       ->  Seq Scan on plt1_p2 t3_1
                                             Filter: (b = 0)
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on plt1_p1 t1
                                       Filter: (b = 0)
                                 ->  Seq Scan on plt1_p2 t1_1
                                       Filter: (b = 0)
(43 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
(5 rows)

DROP TABLE plt1;
DROP TABLE plt1_e;
DROP TABLE plt2;
DROP TABLE plt2_e;
--=============================================================================================================================
--
-- test cases with bugs/error/crashes
--
--=============================================================================================================================
--issue-1
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (-21) TO (-10);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (-10) TO (0);
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (-21) TO (-10);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (-10) TO (-5);
EXPLAIN (COSTS OFF)
SELECT t1.a, t2.b, t3.a FROM prt1 t1 INNER JOIN prt2 t2 ON t1.a = t2.b INNER JOIN prt1 t3 ON t2.b = t3.a ORDER BY 1,2,3;
                       QUERY PLAN                       
--------------------------------------------------------
 Merge Append
   Sort Key: t1.a
   ->  Merge Join
         Merge Cond: (t3.a = t1.a)
         ->  Sort
               Sort Key: t3.a
               ->  Seq Scan on prt1_p1 t3
         ->  Materialize
               ->  Merge Join
                     Merge Cond: (t1.a = t2.b)
                     ->  Sort
                           Sort Key: t1.a
                           ->  Seq Scan on prt1_p1 t1
                     ->  Sort
                           Sort Key: t2.b
                           ->  Seq Scan on prt2_p1 t2
   ->  Merge Join
         Merge Cond: (t3_1.a = t1_1.a)
         ->  Sort
               Sort Key: t3_1.a
               ->  Seq Scan on prt1_p2 t3_1
         ->  Materialize
               ->  Merge Join
                     Merge Cond: (t1_1.a = t2_1.b)
                     ->  Sort
                           Sort Key: t1_1.a
                           ->  Seq Scan on prt1_p2 t1_1
                     ->  Sort
                           Sort Key: t2_1.b
                           ->  Seq Scan on prt2_p2 t2_1
(30 rows)

SELECT t1.a, t2.b, t3.a FROM prt1 t1 INNER JOIN prt2 t2 ON t1.a = t2.b INNER JOIN prt1 t3 ON t2.b = t3.a ORDER BY 1,2,3;
 a | b | a 
---+---+---
(0 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-2
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(0, 599, 2) i;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (550);
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(0+50, 599-50, 3) i;
ANALYZE prt2;
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c, t3.a, t3.c FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b LEFT JOIN prt2 t3 ON (t1.a = t3.b) WHERE t1.b + t2.a = 0 ORDER BY t1.a, t2.b;
                           QUERY PLAN                           
----------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p1 t3
               ->  Seq Scan on prt2_p2 t3_1
               ->  Seq Scan on prt2_p3 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t1.a = t2.b)
                           Join Filter: ((t1.b + t2.a) = 0)
                           ->  Seq Scan on prt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on prt2_p1 t2
                     ->  Hash Join
                           Hash Cond: (t1_1.a = t2_1.b)
                           Join Filter: ((t1_1.b + t2_1.a) = 0)
                           ->  Seq Scan on prt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: (t1_2.a = t2_2.b)
                           Join Filter: ((t1_2.b + t2_2.a) = 0)
                           ->  Seq Scan on prt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on prt2_p3 t2_2
(28 rows)

SELECT t1.a, t1.c, t2.a, t2.c, t3.a, t3.c FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b LEFT JOIN prt2 t3 ON (t1.a = t3.b) WHERE t1.b + t2.a = 0 ORDER BY t1.a, t2.b;
  a  |  c   | a |  c   | a |  c   
-----+------+---+------+---+------
  50 | 0050 | 0 | 0050 | 0 | 0050
 200 | 0200 | 0 | 0200 | 0 | 0200
 350 | 0350 | 0 | 0350 | 0 | 0350
 500 | 0500 | 0 | 0500 | 0 | 0500
(4 rows)

--issue-3
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.a, t2.c, t3.a, t3.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b FULL JOIN prt2 t3 ON (t1.a = t3.b) WHERE t1.b + t2.a = 0 ORDER BY t1.a, t2.b;
                           QUERY PLAN                           
----------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Right Join
         Hash Cond: (t3.b = t1.a)
         ->  Append
               ->  Seq Scan on prt2_p1 t3
               ->  Seq Scan on prt2_p2 t3_1
               ->  Seq Scan on prt2_p3 t3_2
         ->  Hash
               ->  Append
                     ->  Hash Join
                           Hash Cond: (t1.a = t2.b)
                           Join Filter: ((t1.b + t2.a) = 0)
                           ->  Seq Scan on prt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on prt2_p1 t2
                     ->  Hash Join
                           Hash Cond: (t1_1.a = t2_1.b)
                           Join Filter: ((t1_1.b + t2_1.a) = 0)
                           ->  Seq Scan on prt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on prt2_p2 t2_1
                     ->  Hash Join
                           Hash Cond: (t1_2.a = t2_2.b)
                           Join Filter: ((t1_2.b + t2_2.a) = 0)
                           ->  Seq Scan on prt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on prt2_p3 t2_2
(28 rows)

SELECT t1.a, t1.c, t2.a, t2.c, t3.a, t3.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b FULL JOIN prt2 t3 ON (t1.a = t3.b) WHERE t1.b + t2.a = 0 ORDER BY t1.a, t2.b;
  a  |  c   | a |  c   | a |  c   
-----+------+---+------+---+------
  50 | 0050 | 0 | 0050 | 0 | 0050
 200 | 0200 | 0 | 0200 | 0 | 0200
 350 | 0350 | 0 | 0350 | 0 | 0350
 500 | 0500 | 0 | 0500 | 0 | 0500
(4 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-4
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(0, 599, 2) i;
CREATE INDEX iprt1_p1_a on prt1_p1(a);
CREATE INDEX iprt1_p2_a on prt1_p2(a);
CREATE INDEX iprt1_p3_a on prt1_p3(a);
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (50) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (550);
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(0+50, 599-50, 3) i;
CREATE INDEX iprt2_p1_b on prt2_p1(b);
CREATE INDEX iprt2_p2_b on prt2_p2(b);
CREATE INDEX iprt2_p3_b on prt2_p3(b);
ANALYZE prt2;
CREATE TABLE prt1_e (a int, b int, c int) PARTITION BY RANGE(((a + b)/2));
CREATE TABLE prt1_e_p1 PARTITION OF prt1_e FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_e_p2 PARTITION OF prt1_e FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_e_p3 PARTITION OF prt1_e FOR VALUES FROM (500) TO (600);
INSERT INTO prt1_e SELECT i, i, i % 25 FROM generate_series(0, 599, 2) i;
CREATE INDEX iprt1_e_p1_ab2 on prt1_e_p1(((a+b)/2));
CREATE INDEX iprt1_e_p2_ab2 on prt1_e_p2(((a+b)/2));
CREATE INDEX iprt1_e_p3_ab2 on prt1_e_p3(((a+b)/2));
ANALYZE prt1_e;
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) LEFT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t1.b = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (((t3.a + t3.b) / 2) = t1.a)
                     ->  Seq Scan on prt1_e_p1 t3
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2.b = t1.a)
                                 ->  Seq Scan on prt2_p1 t2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p1 t1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (((t3_1.a + t3_1.b) / 2) = t1_1.a)
                     ->  Seq Scan on prt1_e_p2 t3_1
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_1.b = t1_1.a)
                                 ->  Seq Scan on prt2_p2 t2_1
                                 ->  Hash
                                       ->  Seq Scan on prt1_p2 t1_1
                                             Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (((t3_2.a + t3_2.b) / 2) = t1_2.a)
                     ->  Seq Scan on prt1_e_p3 t3_2
                     ->  Hash
                           ->  Hash Right Join
                                 Hash Cond: (t2_2.b = t1_2.a)
                                 ->  Seq Scan on prt2_p3 t2_2
                                 ->  Hash
                                       ->  Seq Scan on prt1_p3 t1_2
                                             Filter: (b = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) LEFT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t1.b = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   |  b  |  c   | ?column? | c 
-----+------+-----+------+----------+---
   0 | 0000 |     |      |        0 | 0
  50 | 0050 |  50 | 0050 |      100 | 0
 100 | 0100 |     |      |      200 | 0
 150 | 0150 |     |      |      300 | 0
 200 | 0200 | 200 | 0200 |      400 | 0
 250 | 0250 |     |      |      500 | 0
 300 | 0300 |     |      |      600 | 0
 350 | 0350 | 350 | 0350 |      700 | 0
 400 | 0400 |     |      |      800 | 0
 450 | 0450 |     |      |      900 | 0
 500 | 0500 | 500 | 0500 |     1000 | 0
 550 | 0550 |     |      |     1100 | 0
(12 rows)

--issue-5
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) RIGHT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t3.c = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     ->  Hash Right Join
                           Hash Cond: (t1.a = ((t3.a + t3.b) / 2))
                           ->  Seq Scan on prt1_p1 t1
                           ->  Hash
                                 ->  Seq Scan on prt1_e_p1 t3
                                       Filter: (c = 0)
                     ->  Index Scan using iprt2_p1_b on prt2_p1 t2
                           Index Cond: (t1.a = b)
               ->  Nested Loop Left Join
                     ->  Hash Right Join
                           Hash Cond: (t1_1.a = ((t3_1.a + t3_1.b) / 2))
                           ->  Seq Scan on prt1_p2 t1_1
                           ->  Hash
                                 ->  Seq Scan on prt1_e_p2 t3_1
                                       Filter: (c = 0)
                     ->  Index Scan using iprt2_p2_b on prt2_p2 t2_1
                           Index Cond: (t1_1.a = b)
               ->  Nested Loop Left Join
                     ->  Hash Right Join
                           Hash Cond: (t1_2.a = ((t3_2.a + t3_2.b) / 2))
                           ->  Seq Scan on prt1_p3 t1_2
                           ->  Hash
                                 ->  Seq Scan on prt1_e_p3 t3_2
                                       Filter: (c = 0)
                     ->  Index Scan using iprt2_p3_b on prt2_p3 t2_2
                           Index Cond: (t1_2.a = b)
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) RIGHT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t3.c = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   |  b  |  c   | ?column? | c 
-----+------+-----+------+----------+---
   0 | 0000 |     |      |        0 | 0
  50 | 0050 |  50 | 0050 |      100 | 0
 100 | 0100 |     |      |      200 | 0
 150 | 0150 |     |      |      300 | 0
 200 | 0200 | 200 | 0200 |      400 | 0
 250 | 0250 |     |      |      500 | 0
 300 | 0300 |     |      |      600 | 0
 350 | 0350 | 350 | 0350 |      700 | 0
 400 | 0400 |     |      |      800 | 0
 450 | 0450 |     |      |      900 | 0
 500 | 0500 | 500 | 0500 |     1000 | 0
 550 | 0550 |     |      |     1100 | 0
(12 rows)

--issue-6
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.phv, t2.b, t2.phv, t3.a + t3.b, t3.phv FROM ((SELECT 50 phv, * FROM prt1 WHERE prt1.b = 0) t1 FULL JOIN (SELECT 75 phv, * FROM prt2 WHERE prt2.a = 0) t2 ON (t1.a = t2.b)) FULL JOIN (SELECT 50 phv, * FROM prt1_e WHERE prt1_e.c = 0) t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t1.a = t1.phv OR t2.b = t2.phv OR (t3.a + t3.b)/2 = t3.phv ORDER BY t1.a, t2.b, t3.a + t3.b;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Sort
   Sort Key: prt1_p1.a, prt2_p1.b, ((prt1_e_p1.a + prt1_e_p1.b))
   ->  Result
         ->  Append
               ->  Hash Full Join
                     Hash Cond: (prt1_p1.a = ((prt1_e_p1.a + prt1_e_p1.b) / 2))
                     Filter: ((prt1_p1.a = (50)) OR (prt2_p1.b = (75)) OR (((prt1_e_p1.a + prt1_e_p1.b) / 2) = (50)))
                     ->  Hash Full Join
                           Hash Cond: (prt1_p1.a = prt2_p1.b)
                           ->  Seq Scan on prt1_p1
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on prt2_p1
                                       Filter: (a = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_e_p1
                                 Filter: (c = 0)
               ->  Hash Full Join
                     Hash Cond: (prt1_p2.a = ((prt1_e_p2.a + prt1_e_p2.b) / 2))
                     Filter: ((prt1_p2.a = (50)) OR (prt2_p2.b = (75)) OR (((prt1_e_p2.a + prt1_e_p2.b) / 2) = (50)))
                     ->  Hash Full Join
                           Hash Cond: (prt1_p2.a = prt2_p2.b)
                           ->  Seq Scan on prt1_p2
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on prt2_p2
                                       Filter: (a = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_e_p2
                                 Filter: (c = 0)
               ->  Hash Full Join
                     Hash Cond: (prt1_p3.a = ((prt1_e_p3.a + prt1_e_p3.b) / 2))
                     Filter: ((prt1_p3.a = (50)) OR (prt2_p3.b = (75)) OR (((prt1_e_p3.a + prt1_e_p3.b) / 2) = (50)))
                     ->  Hash Full Join
                           Hash Cond: (prt1_p3.a = prt2_p3.b)
                           ->  Seq Scan on prt1_p3
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on prt2_p3
                                       Filter: (a = 0)
                     ->  Hash
                           ->  Seq Scan on prt1_e_p3
                                 Filter: (c = 0)
(43 rows)

SET enable_hashjoin TO off;
SET enable_nestloop TO off;
--issue-7
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) RIGHT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t3.c = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Result
         ->  Append
               ->  Merge Left Join
                     Merge Cond: (t1.a = t2.b)
                     ->  Sort
                           Sort Key: t1.a
                           ->  Merge Left Join
                                 Merge Cond: ((((t3.a + t3.b) / 2)) = t1.a)
                                 ->  Sort
                                       Sort Key: (((t3.a + t3.b) / 2))
                                       ->  Seq Scan on prt1_e_p1 t3
                                             Filter: (c = 0)
                                 ->  Sort
                                       Sort Key: t1.a
                                       ->  Seq Scan on prt1_p1 t1
                     ->  Sort
                           Sort Key: t2.b
                           ->  Seq Scan on prt2_p1 t2
               ->  Merge Left Join
                     Merge Cond: (t1_1.a = t2_1.b)
                     ->  Sort
                           Sort Key: t1_1.a
                           ->  Merge Left Join
                                 Merge Cond: ((((t3_1.a + t3_1.b) / 2)) = t1_1.a)
                                 ->  Sort
                                       Sort Key: (((t3_1.a + t3_1.b) / 2))
                                       ->  Seq Scan on prt1_e_p2 t3_1
                                             Filter: (c = 0)
                                 ->  Sort
                                       Sort Key: t1_1.a
                                       ->  Seq Scan on prt1_p2 t1_1
                     ->  Sort
                           Sort Key: t2_1.b
                           ->  Seq Scan on prt2_p2 t2_1
               ->  Merge Left Join
                     Merge Cond: (t1_2.a = t2_2.b)
                     ->  Sort
                           Sort Key: t1_2.a
                           ->  Merge Left Join
                                 Merge Cond: ((((t3_2.a + t3_2.b) / 2)) = t1_2.a)
                                 ->  Sort
                                       Sort Key: (((t3_2.a + t3_2.b) / 2))
                                       ->  Seq Scan on prt1_e_p3 t3_2
                                             Filter: (c = 0)
                                 ->  Sort
                                       Sort Key: t1_2.a
                                       ->  Seq Scan on prt1_p3 t1_2
                     ->  Sort
                           Sort Key: t2_2.b
                           ->  Seq Scan on prt2_p3 t2_2
(52 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) RIGHT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t3.c = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   |  b  |  c   | ?column? | c 
-----+------+-----+------+----------+---
   0 | 0000 |     |      |        0 | 0
  50 | 0050 |  50 | 0050 |      100 | 0
 100 | 0100 |     |      |      200 | 0
 150 | 0150 |     |      |      300 | 0
 200 | 0200 | 200 | 0200 |      400 | 0
 250 | 0250 |     |      |      500 | 0
 300 | 0300 |     |      |      600 | 0
 350 | 0350 | 350 | 0350 |      700 | 0
 400 | 0400 |     |      |      800 | 0
 450 | 0450 |     |      |      900 | 0
 500 | 0500 | 500 | 0500 |     1000 | 0
 550 | 0550 |     |      |     1100 | 0
(12 rows)

--issue-8
-- Add an extra partition to prt2 , Partition-wise join is possible with partitions on inner side are allowed
CREATE TABLE prt2_p4 PARTITION OF prt2 FOR VALUES FROM (600) TO (700);
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(600, 699, 3) i;
ANALYZE prt2;
select t1.a, t1.b, t1.c from prt2 t1 where not exists (select 1 from prt1 t2 WHERE t1.b = t2.a) and t1.a = 0 order by t1.a, t1.b, t1.c;
 a |  b  |  c   
---+-----+------
 0 | 125 | 0125
 0 | 275 | 0275
 0 | 425 | 0425
 0 | 600 | 0600
 0 | 675 | 0675
(5 rows)

RESET enable_hashjoin;
RESET enable_nestloop;
DROP TABLE prt1;
DROP TABLE prt2;
DROP TABLE prt1_e;
--issue-9
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p4 PARTITION OF prt1 FOR VALUES FROM (600) TO (800);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(0, 599, 2) i;
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 0, 2) i;
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(600, 799, 2) i;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (-250) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt2_p4 PARTITION OF prt2 FOR VALUES FROM (600) TO (800);
CREATE TABLE prt2_p5 PARTITION OF prt2 FOR VALUES FROM (800) TO (1000);
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(0, 599, 3) i;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 0, 3) i;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(600, 999, 3) i;
ANALYZE prt2;
SELECT t1.a, t1.c, t2.a, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY 1,2,3;
  a   |   c   | a |   c   
------+-------+---+-------
 -250 | -0250 | 0 | -0250
 -100 | -0100 | 0 | -0100
    0 | 0000  | 0 | 0000
    0 | 0000  | 0 | 0000
  150 | 0150  | 0 | 0150
  300 | 0300  | 0 | 0300
  450 | 0450  | 0 | 0450
  600 | 0600  | 0 | 0600
  750 | 0750  | 0 | 0750
      |       | 0 | 0075
      |       | 0 | 0375
      |       | 0 | 0825
      |       | 0 | -0175
      |       | 0 | 0900
      |       | 0 | 0675
      |       | 0 | -0025
      |       | 0 | 0525
      |       | 0 | 0225
      |       | 0 | 0975
(19 rows)

--issue-10
SELECT t1.a, t1.c, t2.a, t2.c FROM prt1 t1 FULL JOIN prt2 t2 ON t1.a = t2.b WHERE coalesce(t1.b, 0) + coalesce(t2.a, 0) = 0 ORDER BY t1.a, t2.a;
  a   |   c   | a |   c   
------+-------+---+-------
 -250 | -0250 | 0 | -0250
 -200 | -0200 |   | 
 -150 | -0150 |   | 
 -100 | -0100 | 0 | -0100
  -50 | -0050 |   | 
    0 | 0000  | 0 | 0000
    0 | 0000  | 0 | 0000
   50 | 0050  |   | 
  100 | 0100  |   | 
  150 | 0150  | 0 | 0150
  200 | 0200  |   | 
  250 | 0250  |   | 
  300 | 0300  | 0 | 0300
  350 | 0350  |   | 
  400 | 0400  |   | 
  450 | 0450  | 0 | 0450
  500 | 0500  |   | 
  550 | 0550  |   | 
  600 | 0600  | 0 | 0600
  650 | 0650  |   | 
  700 | 0700  |   | 
  750 | 0750  | 0 | 0750
      |       | 0 | 0825
      |       | 0 | -0175
      |       | 0 | 0900
      |       | 0 | 0675
      |       | 0 | -0025
      |       | 0 | 0525
      |       | 0 | 0225
      |       | 0 | 0975
      |       | 0 | 0075
      |       | 0 | 0375
(32 rows)

--issue-11
select t1.a, t1.b, t1.c from prt2 t1 where not exists (select 1 from prt1 t2 WHERE t1.b = t2.a) and t1.a = 0 order by t1.a, t1.b, t1.c;
 a |  b   |   c   
---+------+-------
 0 | -175 | -0175
 0 |  -25 | -0025
 0 |   75 | 0075
 0 |  225 | 0225
 0 |  375 | 0375
 0 |  525 | 0525
 0 |  675 | 0675
 0 |  825 | 0825
 0 |  900 | 0900
 0 |  975 | 0975
(10 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-12
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 DEFAULT;
INSERT INTO prt1 SELECT i, i, to_char(i, 'FM0000') FROM
generate_series(0, 599, 2) i;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt2_p3 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i, i, to_char(i, 'FM0000') FROM generate_series(0, 599, 3) i;
ANALYZE prt2;
EXPLAIN (COSTS OFF)
select t1.a,t2.b,t3.a,t4.b from prt1 t1 inner join prt2 t2 on (t1.a = t2.b) inner join prt1 t3 on (t2.b = t3.a) inner join prt2 t4 on (t3.a = t4.b) ORDER BY 1,2,3;;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a
   ->  Hash Join
         Hash Cond: (t3.a = t1.a)
         ->  Append
               ->  Seq Scan on prt1_p1 t3
               ->  Seq Scan on prt1_p2 t3_1
               ->  Seq Scan on prt1_p3 t3_2
         ->  Hash
               ->  Hash Join
                     Hash Cond: (t1.a = t4.b)
                     ->  Hash Join
                           Hash Cond: (t1.a = t2.b)
                           ->  Append
                                 ->  Seq Scan on prt1_p1 t1
                                 ->  Seq Scan on prt1_p2 t1_1
                                 ->  Seq Scan on prt1_p3 t1_2
                           ->  Hash
                                 ->  Append
                                       ->  Seq Scan on prt2_p1 t2
                                       ->  Seq Scan on prt2_p2 t2_1
                                       ->  Seq Scan on prt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt2_p1 t4
                                 ->  Seq Scan on prt2_p2 t4_1
                                 ->  Seq Scan on prt2_p3 t4_2
(27 rows)

select t1.a,t2.b,t3.a,t4.b from prt1 t1 inner join prt2 t2 on (t1.a = t2.b) inner join prt1 t3 on (t2.b = t3.a) inner join prt2 t4 on (t3.a = t4.b) ORDER BY 1,2,3;;
  a  |  b  |  a  |  b  
-----+-----+-----+-----
   0 |   0 |   0 |   0
   6 |   6 |   6 |   6
  12 |  12 |  12 |  12
  18 |  18 |  18 |  18
  24 |  24 |  24 |  24
  30 |  30 |  30 |  30
  36 |  36 |  36 |  36
  42 |  42 |  42 |  42
  48 |  48 |  48 |  48
  54 |  54 |  54 |  54
  60 |  60 |  60 |  60
  66 |  66 |  66 |  66
  72 |  72 |  72 |  72
  78 |  78 |  78 |  78
  84 |  84 |  84 |  84
  90 |  90 |  90 |  90
  96 |  96 |  96 |  96
 102 | 102 | 102 | 102
 108 | 108 | 108 | 108
 114 | 114 | 114 | 114
 120 | 120 | 120 | 120
 126 | 126 | 126 | 126
 132 | 132 | 132 | 132
 138 | 138 | 138 | 138
 144 | 144 | 144 | 144
 150 | 150 | 150 | 150
 156 | 156 | 156 | 156
 162 | 162 | 162 | 162
 168 | 168 | 168 | 168
 174 | 174 | 174 | 174
 180 | 180 | 180 | 180
 186 | 186 | 186 | 186
 192 | 192 | 192 | 192
 198 | 198 | 198 | 198
 204 | 204 | 204 | 204
 210 | 210 | 210 | 210
 216 | 216 | 216 | 216
 222 | 222 | 222 | 222
 228 | 228 | 228 | 228
 234 | 234 | 234 | 234
 240 | 240 | 240 | 240
 246 | 246 | 246 | 246
 252 | 252 | 252 | 252
 258 | 258 | 258 | 258
 264 | 264 | 264 | 264
 270 | 270 | 270 | 270
 276 | 276 | 276 | 276
 282 | 282 | 282 | 282
 288 | 288 | 288 | 288
 294 | 294 | 294 | 294
 300 | 300 | 300 | 300
 306 | 306 | 306 | 306
 312 | 312 | 312 | 312
 318 | 318 | 318 | 318
 324 | 324 | 324 | 324
 330 | 330 | 330 | 330
 336 | 336 | 336 | 336
 342 | 342 | 342 | 342
 348 | 348 | 348 | 348
 354 | 354 | 354 | 354
 360 | 360 | 360 | 360
 366 | 366 | 366 | 366
 372 | 372 | 372 | 372
 378 | 378 | 378 | 378
 384 | 384 | 384 | 384
 390 | 390 | 390 | 390
 396 | 396 | 396 | 396
 402 | 402 | 402 | 402
 408 | 408 | 408 | 408
 414 | 414 | 414 | 414
 420 | 420 | 420 | 420
 426 | 426 | 426 | 426
 432 | 432 | 432 | 432
 438 | 438 | 438 | 438
 444 | 444 | 444 | 444
 450 | 450 | 450 | 450
 456 | 456 | 456 | 456
 462 | 462 | 462 | 462
 468 | 468 | 468 | 468
 474 | 474 | 474 | 474
 480 | 480 | 480 | 480
 486 | 486 | 486 | 486
 492 | 492 | 492 | 492
 498 | 498 | 498 | 498
 504 | 504 | 504 | 504
 510 | 510 | 510 | 510
 516 | 516 | 516 | 516
 522 | 522 | 522 | 522
 528 | 528 | 528 | 528
 534 | 534 | 534 | 534
 540 | 540 | 540 | 540
 546 | 546 | 546 | 546
 552 | 552 | 552 | 552
 558 | 558 | 558 | 558
 564 | 564 | 564 | 564
 570 | 570 | 570 | 570
 576 | 576 | 576 | 576
 582 | 582 | 582 | 582
 588 | 588 | 588 | 588
 594 | 594 | 594 | 594
(100 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-13
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 DEFAULT;
INSERT INTO prt1 SELECT i, i, to_char(i, 'FM0000') FROM generate_series(0, 599, 2) i;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt2_p3 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i, i, to_char(i, 'FM0000') FROM generate_series(0, 599, 3) i;
ANALYZE prt2;
CREATE TABLE prt1_e (a int, b int, c varchar) PARTITION BY RANGE(((a + b)/2));
CREATE TABLE prt1_e_p1 PARTITION OF prt1_e FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_e_p2 PARTITION OF prt1_e FOR VALUES FROM (250) TO (500);
CREATE TABLE prt1_e_p3 PARTITION OF prt1_e DEFAULT;
INSERT INTO prt1_e SELECT i, i, to_char(i, 'FM0000') FROM generate_series(0, 599, 2) i;
ANALYZE prt1_e;
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) LEFT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
                          QUERY PLAN                          
--------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b, ((t3.a + t3.b))
   ->  Hash Right Join
         Hash Cond: (((t3.a + t3.b) / 2) = t1.a)
         ->  Append
               ->  Seq Scan on prt1_e_p1 t3
               ->  Seq Scan on prt1_e_p2 t3_1
               ->  Seq Scan on prt1_e_p3 t3_2
         ->  Hash
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Append
                           ->  Seq Scan on prt2_p1 t2
                           ->  Seq Scan on prt2_p2 t2_1
                           ->  Seq Scan on prt2_p3 t2_2
                     ->  Hash
                           ->  Append
                                 ->  Seq Scan on prt1_p1 t1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on prt1_p2 t1_1
                                       Filter: ((a % 25) = 0)
                                 ->  Seq Scan on prt1_p3 t1_2
                                       Filter: ((a % 25) = 0)
(23 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a + t3.b, t3.c FROM (prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b) LEFT JOIN prt1_e t3 ON (t1.a = (t3.a + t3.b)/2) WHERE t1.a % 25 = 0 ORDER BY t1.a, t2.b, t3.a + t3.b;
  a  |  c   |  b  |  c   | ?column? |  c   
-----+------+-----+------+----------+------
   0 | 0000 |   0 | 0000 |        0 | 0000
  50 | 0050 |     |      |      100 | 0050
 100 | 0100 |     |      |      200 | 0100
 150 | 0150 | 150 | 0150 |      300 | 0150
 200 | 0200 |     |      |      400 | 0200
 250 | 0250 |     |      |      500 | 0250
 300 | 0300 | 300 | 0300 |      600 | 0300
 350 | 0350 |     |      |      700 | 0350
 400 | 0400 |     |      |      800 | 0400
 450 | 0450 | 450 | 0450 |      900 | 0450
 500 | 0500 |     |      |     1000 | 0500
 550 | 0550 |     |      |     1100 | 0550
(12 rows)

DROP TABLE prt1;
DROP TABLE prt2;
DROP TABLE prt1_e;
--issue-14
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (-250) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (200);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (300) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt1_p4 PARTITION OF prt1 FOR VALUES FROM (600) TO (MAXVALUE);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 799) i WHERE i % 2 = 0 AND i NOT BETWEEN 200 AND 300;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt2_p4 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 799) i WHERE i % 3 = 0;
ANALYZE prt2;
--ACTIVE
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t1.a = t2.b)
                     ->  Seq Scan on prt1_p0 t1
                     ->  Hash
                           ->  Seq Scan on prt2_p0 t2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t1_1
                     ->  Hash
                           ->  Seq Scan on prt2_p1 t2_1
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t1_2
                     ->  Hash
                           ->  Seq Scan on prt2_p2 t2_2
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_3.a = t2_3.b)
                     ->  Seq Scan on prt1_p3 t1_3
                     ->  Hash
                           ->  Seq Scan on prt2_p3 t2_3
                                 Filter: (a = 0)
               ->  Hash Right Join
                     Hash Cond: (t1_4.a = t2_4.b)
                     ->  Seq Scan on prt1_p4 t1_4
                     ->  Hash
                           ->  Seq Scan on prt2_p4 t2_4
                                 Filter: (a = 0)
(34 rows)

SELECT t1.a, t1.c, t2.b, t2.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON t1.a = t2.b WHERE t2.a = 0 ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   
------+-------+------+-------
 -150 | -0150 | -150 | -0150
    0 | 0000  |    0 | 0000
  150 | 0150  |  150 | 0150
  450 | 0450  |  450 | 0450
  600 | 0600  |  600 | 0600
  750 | 0750  |  750 | 0750
      |       | -225 | -0225
      |       |  -75 | -0075
      |       |   75 | 0075
      |       |  225 | 0225
      |       |  300 | 0300
      |       |  375 | 0375
      |       |  525 | 0525
      |       |  675 | 0675
(14 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-15
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (-250) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (200);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (300) TO (500);
CREATE TABLE prt1_p3 PARTITION OF prt1 FOR VALUES FROM (500) TO (600);
CREATE TABLE prt1_p4 PARTITION OF prt1 FOR VALUES FROM (600) TO (MAXVALUE);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 799) i WHERE i % 2 = 0 AND (i < 200 OR i >= 300);
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 FOR VALUES FROM (500) TO (550);
CREATE TABLE prt2_p4 PARTITION OF prt2 FOR VALUES FROM (600) TO (MAXVALUE);
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 799) i WHERE i % 3 = 0 AND (i < 550 OR i >=600);
--ACTIVE
EXPLAIN (COSTS OFF)
SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
                       QUERY PLAN                       
--------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t2.b = t1.a)
                     ->  Seq Scan on prt2_p0 t2
                     ->  Hash
                           ->  Seq Scan on prt1_p0 t1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_1.b = t1_1.a)
                     ->  Seq Scan on prt2_p1 t2_1
                     ->  Hash
                           ->  Seq Scan on prt1_p1 t1_1
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_2.b = t1_2.a)
                     ->  Seq Scan on prt2_p2 t2_2
                     ->  Hash
                           ->  Seq Scan on prt1_p2 t1_2
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_3.b = t1_3.a)
                     ->  Seq Scan on prt2_p3 t2_3
                     ->  Hash
                           ->  Seq Scan on prt1_p3 t1_3
                                 Filter: (b = 0)
               ->  Hash Right Join
                     Hash Cond: (t2_4.b = t1_4.a)
                     ->  Seq Scan on prt2_p4 t2_4
                     ->  Hash
                           ->  Seq Scan on prt1_p4 t1_4
                                 Filter: (b = 0)
(34 rows)

SELECT t1, t2 FROM prt1 t1 LEFT JOIN prt2 t2 ON t1.a = t2.b WHERE t1.b = 0 ORDER BY t1.a, t2.b;
       t1       |       t2       
----------------+----------------
 (-250,0,-0250) | 
 (-200,0,-0200) | 
 (-150,0,-0150) | (0,-150,-0150)
 (-100,0,-0100) | 
 (-50,0,-0050)  | 
 (0,0,0000)     | (0,0,0000)
 (50,0,0050)    | 
 (100,0,0100)   | 
 (150,0,0150)   | (0,150,0150)
 (300,0,0300)   | (0,300,0300)
 (350,0,0350)   | 
 (400,0,0400)   | 
 (450,0,0450)   | (0,450,0450)
 (500,0,0500)   | 
 (550,0,0550)   | 
 (600,0,0600)   | (0,600,0600)
 (650,0,0650)   | 
 (700,0,0700)   | 
 (750,0,0750)   | (0,750,0750)
(19 rows)

DROP TABLE prt1;
DROP TABLE prt2;
--issue-16
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002','0003');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt1_p3 PARTITION OF plt1 FOR VALUES IN (NULL,'0008','0009');
CREATE TABLE plt1_p4 PARTITION OF plt1 FOR VALUES IN ('0000','0010');
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 17, 'FM0000') FROM generate_series(0, 500) i WHERE i % 17 NOT IN (7, 11, 12, 13, 14, 15,16);
INSERT INTO plt1 SELECT i, i % 47, case when i % 17 = 7 then NULL else to_char(i % 17, 'FM0000') end FROM generate_series(0, 500) i WHERE i % 17 IN (7,8,9);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0002','0003');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0004','0005','0006');
CREATE TABLE plt2_p3 PARTITION OF plt2 FOR VALUES IN ('0007','0008','0009');
CREATE TABLE plt2_p4 PARTITION OF plt2 FOR VALUES IN ('0000',NULL,'0012');
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 17, 'FM0000') FROM generate_series(0, 500) i WHERE i % 17 NOT IN (1, 10, 11, 13, 14, 15, 16);
INSERT INTO plt2 SELECT i, i % 47, case when i % 17 = 11 then NULL else to_char(i % 17, 'FM0000') end FROM generate_series(0, 500) i WHERE i % 17 IN (0,11,12);
ANALYZE plt2;
CREATE TABLE plt1_e (a int, b int, c text) PARTITION BY LIST(ltrim(c, 'A'));
CREATE TABLE plt1_e_p1 PARTITION OF plt1_e FOR VALUES IN ('0002', '0003');
CREATE TABLE plt1_e_p2 PARTITION OF plt1_e FOR VALUES IN ('0004', '0005', '0006');
CREATE TABLE plt1_e_p3 PARTITION OF plt1_e FOR VALUES IN ('0008', '0009');
CREATE TABLE plt1_e_p4 PARTITION OF plt1_e FOR VALUES IN ('0000');
INSERT INTO plt1_e SELECT i, i % 47, to_char(i % 17, 'FM0000') FROM generate_series(0, 500) i WHERE i % 17 NOT IN (1, 7, 10, 11, 12, 13, 14, 15, 16);
ANALYZE plt1_e;
--ACTIVE
EXPLAIN (COSTS OFF)
SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM
plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.c, t3.c
   ->  HashAggregate
         Group Key: t1.c, t2.c, t3.c
         ->  Result
               ->  Append
                     ->  Hash Join
                           Hash Cond: ((t2.c)::text = (t1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2.c)::text = ltrim(t3.c, 'A'::text))
                                 ->  Seq Scan on plt2_p4 t2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p4 t3
                           ->  Hash
                                 ->  Seq Scan on plt1_p4 t1
                     ->  Hash Join
                           Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t2_1.c)::text = ltrim(t3_1.c, 'A'::text))
                                 ->  Seq Scan on plt2_p1 t2_1
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p1 t3_1
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t1_1
                     ->  Hash Join
                           Hash Cond: ((t1_2.c)::text = (t2_2.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_2.c)::text = ltrim(t3_2.c, 'A'::text))
                                 ->  Seq Scan on plt1_p2 t1_2
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p2 t3_2
                           ->  Hash
                                 ->  Seq Scan on plt2_p2 t2_2
                     ->  Hash Join
                           Hash Cond: ((t1_3.c)::text = (t2_3.c)::text)
                           ->  Hash Join
                                 Hash Cond: ((t1_3.c)::text = ltrim(t3_3.c, 'A'::text))
                                 ->  Seq Scan on plt1_p3 t1_3
                                 ->  Hash
                                       ->  Seq Scan on plt1_e_p3 t3_3
                           ->  Hash
                                 ->  Seq Scan on plt2_p3 t2_3
(42 rows)

SELECT avg(t1.a), avg(t2.b), avg(t3.a + t3.b), t1.c, t2.c, t3.c FROM
plt1 t1, plt2 t2, plt1_e t3 WHERE t1.c = t2.c AND ltrim(t3.c, 'A') = t1.c GROUP BY t1.c, t2.c, t3.c ORDER BY t1.c, t2.c, t3.c;
         avg          |         avg         |         avg          |  c   |  c   |  c   
----------------------+---------------------+----------------------+------+------+------
 246.5000000000000000 | 22.4666666666666667 | 268.9666666666666667 | 0000 | 0000 | 0000
 248.5000000000000000 | 21.3333333333333333 | 269.8333333333333333 | 0002 | 0002 | 0002
 249.5000000000000000 | 22.3333333333333333 | 271.8333333333333333 | 0003 | 0003 | 0003
 250.5000000000000000 | 23.3333333333333333 | 273.8333333333333333 | 0004 | 0004 | 0004
 251.5000000000000000 | 22.7666666666666667 | 274.2666666666666667 | 0005 | 0005 | 0005
 252.5000000000000000 | 22.2000000000000000 | 274.7000000000000000 | 0006 | 0006 | 0006
 246.0000000000000000 | 23.9655172413793103 | 269.9655172413793103 | 0008 | 0008 | 0008
 247.0000000000000000 | 23.3448275862068966 | 270.3448275862068966 | 0009 | 0009 | 0009
(8 rows)

drop table plt1;
drop table plt2;
drop table plt1_e;
--issue-17
CREATE TABLE prt1 (a int, b int, c varchar) PARTITION BY RANGE(a);
CREATE TABLE prt1_p0 PARTITION OF prt1 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt1_p1 PARTITION OF prt1 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt1_p2 PARTITION OF prt1 FOR VALUES FROM (250) TO (500);
INSERT INTO prt1 SELECT i, i % 25, to_char(i, 'FM0000') FROM generate_series(-250, 499) i WHERE i % 2 = 0;
ANALYZE prt1;
CREATE TABLE prt2 (a int, b int, c varchar) PARTITION BY RANGE(b);
CREATE TABLE prt2_p0 PARTITION OF prt2 FOR VALUES FROM (MINVALUE) TO (0);
CREATE TABLE prt2_p1 PARTITION OF prt2 FOR VALUES FROM (0) TO (250);
CREATE TABLE prt2_p2 PARTITION OF prt2 FOR VALUES FROM (250) TO (500);
CREATE TABLE prt2_p3 PARTITION OF prt2 DEFAULT;
INSERT INTO prt2 SELECT i % 25, i, to_char(i, 'FM0000') FROM generate_series(-250, 599) i WHERE i % 3 = 0;
ANALYZE prt2;
--ACTIVE
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a)  ORDER BY t1.a, t2.b;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Hash Right Join
                     Hash Cond: (t1.a = t2.b)
                     ->  Seq Scan on prt1_p0 t1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3.a = t2.b)
                                 ->  Seq Scan on prt1_p0 t3
                                 ->  Hash
                                       ->  Seq Scan on prt2_p0 t2
               ->  Hash Right Join
                     Hash Cond: (t1_1.a = t2_1.b)
                     ->  Seq Scan on prt1_p1 t1_1
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_1.a = t2_1.b)
                                 ->  Seq Scan on prt1_p1 t3_1
                                 ->  Hash
                                       ->  Seq Scan on prt2_p1 t2_1
               ->  Hash Right Join
                     Hash Cond: (t1_2.a = t2_2.b)
                     ->  Seq Scan on prt1_p2 t1_2
                     ->  Hash
                           ->  Hash Join
                                 Hash Cond: (t3_2.a = t2_2.b)
                                 ->  Seq Scan on prt1_p2 t3_2
                                 ->  Hash
                                       ->  Seq Scan on prt2_p2 t2_2
(31 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM prt1 t1 RIGHT JOIN prt2 t2 ON (t1.a = t2.b) INNER JOIN prt1 t3 ON (t2.b = t3.a)  ORDER BY t1.a, t2.b;
  a   |   c   |  b   |   c   |  a   |   c   
------+-------+------+-------+------+-------
 -246 | -0246 | -246 | -0246 | -246 | -0246
 -240 | -0240 | -240 | -0240 | -240 | -0240
 -234 | -0234 | -234 | -0234 | -234 | -0234
 -228 | -0228 | -228 | -0228 | -228 | -0228
 -222 | -0222 | -222 | -0222 | -222 | -0222
 -216 | -0216 | -216 | -0216 | -216 | -0216
 -210 | -0210 | -210 | -0210 | -210 | -0210
 -204 | -0204 | -204 | -0204 | -204 | -0204
 -198 | -0198 | -198 | -0198 | -198 | -0198
 -192 | -0192 | -192 | -0192 | -192 | -0192
 -186 | -0186 | -186 | -0186 | -186 | -0186
 -180 | -0180 | -180 | -0180 | -180 | -0180
 -174 | -0174 | -174 | -0174 | -174 | -0174
 -168 | -0168 | -168 | -0168 | -168 | -0168
 -162 | -0162 | -162 | -0162 | -162 | -0162
 -156 | -0156 | -156 | -0156 | -156 | -0156
 -150 | -0150 | -150 | -0150 | -150 | -0150
 -144 | -0144 | -144 | -0144 | -144 | -0144
 -138 | -0138 | -138 | -0138 | -138 | -0138
 -132 | -0132 | -132 | -0132 | -132 | -0132
 -126 | -0126 | -126 | -0126 | -126 | -0126
 -120 | -0120 | -120 | -0120 | -120 | -0120
 -114 | -0114 | -114 | -0114 | -114 | -0114
 -108 | -0108 | -108 | -0108 | -108 | -0108
 -102 | -0102 | -102 | -0102 | -102 | -0102
  -96 | -0096 |  -96 | -0096 |  -96 | -0096
  -90 | -0090 |  -90 | -0090 |  -90 | -0090
  -84 | -0084 |  -84 | -0084 |  -84 | -0084
  -78 | -0078 |  -78 | -0078 |  -78 | -0078
  -72 | -0072 |  -72 | -0072 |  -72 | -0072
  -66 | -0066 |  -66 | -0066 |  -66 | -0066
  -60 | -0060 |  -60 | -0060 |  -60 | -0060
  -54 | -0054 |  -54 | -0054 |  -54 | -0054
  -48 | -0048 |  -48 | -0048 |  -48 | -0048
  -42 | -0042 |  -42 | -0042 |  -42 | -0042
  -36 | -0036 |  -36 | -0036 |  -36 | -0036
  -30 | -0030 |  -30 | -0030 |  -30 | -0030
  -24 | -0024 |  -24 | -0024 |  -24 | -0024
  -18 | -0018 |  -18 | -0018 |  -18 | -0018
  -12 | -0012 |  -12 | -0012 |  -12 | -0012
   -6 | -0006 |   -6 | -0006 |   -6 | -0006
    0 | 0000  |    0 | 0000  |    0 | 0000
    6 | 0006  |    6 | 0006  |    6 | 0006
   12 | 0012  |   12 | 0012  |   12 | 0012
   18 | 0018  |   18 | 0018  |   18 | 0018
   24 | 0024  |   24 | 0024  |   24 | 0024
   30 | 0030  |   30 | 0030  |   30 | 0030
   36 | 0036  |   36 | 0036  |   36 | 0036
   42 | 0042  |   42 | 0042  |   42 | 0042
   48 | 0048  |   48 | 0048  |   48 | 0048
   54 | 0054  |   54 | 0054  |   54 | 0054
   60 | 0060  |   60 | 0060  |   60 | 0060
   66 | 0066  |   66 | 0066  |   66 | 0066
   72 | 0072  |   72 | 0072  |   72 | 0072
   78 | 0078  |   78 | 0078  |   78 | 0078
   84 | 0084  |   84 | 0084  |   84 | 0084
   90 | 0090  |   90 | 0090  |   90 | 0090
   96 | 0096  |   96 | 0096  |   96 | 0096
  102 | 0102  |  102 | 0102  |  102 | 0102
  108 | 0108  |  108 | 0108  |  108 | 0108
  114 | 0114  |  114 | 0114  |  114 | 0114
  120 | 0120  |  120 | 0120  |  120 | 0120
  126 | 0126  |  126 | 0126  |  126 | 0126
  132 | 0132  |  132 | 0132  |  132 | 0132
  138 | 0138  |  138 | 0138  |  138 | 0138
  144 | 0144  |  144 | 0144  |  144 | 0144
  150 | 0150  |  150 | 0150  |  150 | 0150
  156 | 0156  |  156 | 0156  |  156 | 0156
  162 | 0162  |  162 | 0162  |  162 | 0162
  168 | 0168  |  168 | 0168  |  168 | 0168
  174 | 0174  |  174 | 0174  |  174 | 0174
  180 | 0180  |  180 | 0180  |  180 | 0180
  186 | 0186  |  186 | 0186  |  186 | 0186
  192 | 0192  |  192 | 0192  |  192 | 0192
  198 | 0198  |  198 | 0198  |  198 | 0198
  204 | 0204  |  204 | 0204  |  204 | 0204
  210 | 0210  |  210 | 0210  |  210 | 0210
  216 | 0216  |  216 | 0216  |  216 | 0216
  222 | 0222  |  222 | 0222  |  222 | 0222
  228 | 0228  |  228 | 0228  |  228 | 0228
  234 | 0234  |  234 | 0234  |  234 | 0234
  240 | 0240  |  240 | 0240  |  240 | 0240
  246 | 0246  |  246 | 0246  |  246 | 0246
  252 | 0252  |  252 | 0252  |  252 | 0252
  258 | 0258  |  258 | 0258  |  258 | 0258
  264 | 0264  |  264 | 0264  |  264 | 0264
  270 | 0270  |  270 | 0270  |  270 | 0270
  276 | 0276  |  276 | 0276  |  276 | 0276
  282 | 0282  |  282 | 0282  |  282 | 0282
  288 | 0288  |  288 | 0288  |  288 | 0288
  294 | 0294  |  294 | 0294  |  294 | 0294
  300 | 0300  |  300 | 0300  |  300 | 0300
  306 | 0306  |  306 | 0306  |  306 | 0306
  312 | 0312  |  312 | 0312  |  312 | 0312
  318 | 0318  |  318 | 0318  |  318 | 0318
  324 | 0324  |  324 | 0324  |  324 | 0324
  330 | 0330  |  330 | 0330  |  330 | 0330
  336 | 0336  |  336 | 0336  |  336 | 0336
  342 | 0342  |  342 | 0342  |  342 | 0342
  348 | 0348  |  348 | 0348  |  348 | 0348
  354 | 0354  |  354 | 0354  |  354 | 0354
  360 | 0360  |  360 | 0360  |  360 | 0360
  366 | 0366  |  366 | 0366  |  366 | 0366
  372 | 0372  |  372 | 0372  |  372 | 0372
  378 | 0378  |  378 | 0378  |  378 | 0378
  384 | 0384  |  384 | 0384  |  384 | 0384
  390 | 0390  |  390 | 0390  |  390 | 0390
  396 | 0396  |  396 | 0396  |  396 | 0396
  402 | 0402  |  402 | 0402  |  402 | 0402
  408 | 0408  |  408 | 0408  |  408 | 0408
  414 | 0414  |  414 | 0414  |  414 | 0414
  420 | 0420  |  420 | 0420  |  420 | 0420
  426 | 0426  |  426 | 0426  |  426 | 0426
  432 | 0432  |  432 | 0432  |  432 | 0432
  438 | 0438  |  438 | 0438  |  438 | 0438
  444 | 0444  |  444 | 0444  |  444 | 0444
  450 | 0450  |  450 | 0450  |  450 | 0450
  456 | 0456  |  456 | 0456  |  456 | 0456
  462 | 0462  |  462 | 0462  |  462 | 0462
  468 | 0468  |  468 | 0468  |  468 | 0468
  474 | 0474  |  474 | 0474  |  474 | 0474
  480 | 0480  |  480 | 0480  |  480 | 0480
  486 | 0486  |  486 | 0486  |  486 | 0486
  492 | 0492  |  492 | 0492  |  492 | 0492
  498 | 0498  |  498 | 0498  |  498 | 0498
(125 rows)

drop table prt1;
drop table prt2;
--issue-18
CREATE TABLE plt1 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt1_p1 PARTITION OF plt1 FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt1_p2 PARTITION OF plt1 FOR VALUES IN ('0005','0006','0007','0008');
INSERT INTO plt1 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,9,10);
ANALYSE plt1;
CREATE TABLE plt2 (a int, b int, c varchar) PARTITION BY LIST(c);
CREATE TABLE plt2_p1 PARTITION OF plt2 FOR VALUES IN ('0001','0002','0003','0004');
CREATE TABLE plt2_p2 PARTITION OF plt2 FOR VALUES IN ('0005','0006','0007','0008');
CREATE TABLE plt2_p3 PARTITION OF plt2 DEFAULT;
INSERT INTO plt2 SELECT i, i % 47, to_char(i % 11, 'FM0000') FROM generate_series(0, 500) i WHERE i % 11 NOT IN (0,10);
ANALYSE plt2;
--ACTIVE
EXPLAIN (COSTS OFF)
SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort
   Sort Key: t1.a, t2.b
   ->  Result
         ->  Append
               ->  Nested Loop Left Join
                     Join Filter: ((t3.c)::text = (t4.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4.c)::text = (t5.c)::text)
                           ->  Seq Scan on plt2_p1 t4
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p1 t5
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Left Join
                                 Hash Cond: ((t2.c)::text = (t1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t2.c)::text = (t3.c)::text)
                                       ->  Seq Scan on plt2_p1 t2
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt1_p1 t3
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p1 t1
                                             Filter: (b = 0)
               ->  Nested Loop Left Join
                     Join Filter: ((t3_1.c)::text = (t4_1.c)::text)
                     ->  Hash Join
                           Hash Cond: ((t4_1.c)::text = (t5_1.c)::text)
                           ->  Seq Scan on plt2_p2 t4_1
                                 Filter: (b = 0)
                           ->  Hash
                                 ->  Seq Scan on plt1_p2 t5_1
                                       Filter: (b = 0)
                     ->  Materialize
                           ->  Hash Left Join
                                 Hash Cond: ((t2_1.c)::text = (t1_1.c)::text)
                                 ->  Hash Join
                                       Hash Cond: ((t2_1.c)::text = (t3_1.c)::text)
                                       ->  Seq Scan on plt2_p2 t2_1
                                             Filter: (b = 0)
                                       ->  Hash
                                             ->  Seq Scan on plt1_p2 t3_1
                                                   Filter: (b = 0)
                                 ->  Hash
                                       ->  Seq Scan on plt1_p2 t1_1
                                             Filter: (b = 0)
(48 rows)

SELECT t1.a, t1.c, t2.b, t2.c, t3.a, t1.c FROM plt1 t1 RIGHT JOIN plt2 t2 ON (t1.c = t2.c AND t1.b = 0) LEFT JOIN plt1 t3 ON (t2.c = t3.c AND t2.b = 0) FULL JOIN plt2 t4 ON (t3.c = t4.c AND t3.b = 0) INNER JOIN plt1 t5 ON (t4.c = t5.c AND t4.b = 0) WHERE t5.b  = 0 ORDER BY t1.a, t2.b;
  a  |  c   | b |  c   |  a  |  c   
-----+------+---+------+-----+------
  47 | 0003 | 0 | 0003 |  47 | 0003
  94 | 0006 | 0 | 0006 |  94 | 0006
 188 | 0001 | 0 | 0001 | 188 | 0001
 235 | 0004 | 0 | 0004 | 235 | 0004
 282 | 0007 | 0 | 0007 | 282 | 0007
 376 | 0002 | 0 | 0002 | 376 | 0002
 423 | 0005 | 0 | 0005 | 423 | 0005
 470 | 0008 | 0 | 0008 | 470 | 0008
(8 rows)

drop table plt1;
drop table plt2;
